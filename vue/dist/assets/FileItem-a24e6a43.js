var Yt=Object.defineProperty;var Zt=(e,t,n)=>t in e?Yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ze=(e,t,n)=>(Zt(e,typeof t!="symbol"?t+"":t,n),n);import{P as xe,c3 as Xt,a as te,d as pe,bq as Pt,u as Ne,c as b,bZ as Ot,_ as en,V as ue,a0 as ye,aj as H,bL as st,a3 as lt,bo as tn,h as ie,c4 as nn,b as an,ay as rn,c5 as sn,a2 as ot,bK as ln,c6 as on,c7 as cn,$ as j,b0 as un,z as ne,aA as dn,a1 as fn,ag as we,c8 as vn,aR as pn,c9 as hn,ca as mn,aM as xt,am as je,bn as Ge,cb as gn,cc as yn,c2 as Ae,cd as bn,ce as wn,R as ce,ai as L,U as An,cf as Ye,x as R,cg as Tt,ch as ct,ci as kn,cj as Sn,ck as Bt,cl as K,k as Ze,ah as Cn,cm as Mt,ar as X,cn as Xe,l as ve,aC as Te,aw as In,ap as Qe,co as En,cp as ut,an as Nt,bQ as dt,bP as _n,cq as Ie,cr as Pn,aD as On,bO as $t,cs as xn,ct as Tn,t as Ve,as as ft,al as he,cu as vt,c1 as Bn,L as le,J as Mn,bX as pt,cv as Nn,bW as $n,cw as zn,cx as Qn,cy as Fn,at as Dn,au as Ln,ax as zt,o as z,m as q,cz as Rn,cA as jn,cB as Vn,cC as Un,cD as Hn,a5 as Jn,y as J,cE as ke,C as ee,n as $,A as et,cF as ht,bG as Wn,cG as Kn,B as qn,N as Be,v as V,r as Z,W as Gn,cH as Yn,b_ as Zn,M as Xn,cI as ei,cJ as ti,p as oe,ae as ni,cK as ii,X as ai}from"./index-a94d1da1.js";import{h as ri,r as si,a as li,t as oi}from"./db-544b9d97.js";import{t as Fe,l as de,C as ci,g as ui}from"./shortcut-f010135b.js";var Qt=function(){return{arrow:{type:[Boolean,Object],default:void 0},trigger:{type:[Array,String]},overlay:xe.any,visible:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},align:{type:Object},getPopupContainer:Function,prefixCls:String,transitionName:String,placement:String,overlayClassName:String,overlayStyle:{type:Object,default:void 0},forceRender:{type:Boolean,default:void 0},mouseEnterDelay:Number,mouseLeaveDelay:Number,openClassName:String,minOverlayWidthMatchTrigger:{type:Boolean,default:void 0},destroyPopupOnHide:{type:Boolean,default:void 0},onVisibleChange:{type:Function},"onUpdate:visible":{type:Function}}},De=Xt(),di=function(){return te(te({},Qt()),{},{type:De.type,size:String,htmlType:De.htmlType,href:String,disabled:{type:Boolean,default:void 0},prefixCls:String,icon:xe.any,title:String,loading:De.loading,onClick:{type:Function}})},fi=["type","disabled","loading","htmlType","class","overlay","trigger","align","visible","onVisibleChange","placement","href","title","icon","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","onClick","onUpdate:visible"],vi=ue.Group;const Me=pe({compatConfig:{MODE:3},name:"ADropdownButton",inheritAttrs:!1,__ANT_BUTTON:!0,props:Pt(di(),{trigger:"hover",placement:"bottomRight",type:"default"}),slots:["icon","leftButton","rightButton","overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,r=n.emit,f=function(g){r("update:visible",g),r("visibleChange",g)},l=Ne("dropdown-button",t),d=l.prefixCls,p=l.direction,E=l.getPopupContainer;return function(){var y,g,v=te(te({},t),a),s=v.type,o=s===void 0?"default":s,c=v.disabled,w=v.loading,k=v.htmlType,m=v.class,u=m===void 0?"":m,C=v.overlay,A=C===void 0?(y=i.overlay)===null||y===void 0?void 0:y.call(i):C,_=v.trigger,I=v.align,T=v.visible;v.onVisibleChange;var S=v.placement,F=S===void 0?p.value==="rtl"?"bottomLeft":"bottomRight":S,B=v.href,Q=v.title,P=v.icon,M=P===void 0?((g=i.icon)===null||g===void 0?void 0:g.call(i))||b(Ot,null,null):P,D=v.mouseEnterDelay,h=v.mouseLeaveDelay,O=v.overlayClassName,N=v.overlayStyle,G=v.destroyPopupOnHide,U=v.onClick;v["onUpdate:visible"];var Y=en(v,fi),W={align:I,disabled:c,trigger:c?[]:_,placement:F,getPopupContainer:E.value,onVisibleChange:f,mouseEnterDelay:D,mouseLeaveDelay:h,visible:T,overlayClassName:O,overlayStyle:N,destroyPopupOnHide:G},re=b(ue,{type:o,disabled:c,loading:w,onClick:U,htmlType:k,href:B,title:Q},{default:i.default}),se=b(ue,{type:o,icon:M},null);return b(vi,te(te({},Y),{},{class:ye(d.value,u)}),{default:function(){return[i.leftButton?i.leftButton({button:re}):re,b(fe,W,{default:function(){return[i.rightButton?i.rightButton({button:se}):se]},overlay:function(){return A}})]}})}}});var Ft=pe({compatConfig:{MODE:3},name:"ADropdown",inheritAttrs:!1,props:Pt(Qt(),{mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft",trigger:"hover"}),slots:["overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,r=n.emit,f=Ne("dropdown",t),l=f.prefixCls,d=f.rootPrefixCls,p=f.direction,E=f.getPopupContainer,y=H(function(){var o=t.placement,c=o===void 0?"":o,w=t.transitionName;return w!==void 0?w:c.indexOf("top")>=0?"".concat(d.value,"-slide-down"):"".concat(d.value,"-slide-up")}),g=function(){var c,w,k,m=t.overlay||((c=i.overlay)===null||c===void 0?void 0:c.call(i)),u=Array.isArray(m)?m[0]:m;if(!u)return null;var C=u.props||{};st(!C.mode||C.mode==="vertical","Dropdown",'mode="'.concat(C.mode,`" is not supported for Dropdown's Menu.`));var A=C.selectable,_=A===void 0?!1:A,I=C.expandIcon,T=I===void 0?(w=u.children)===null||w===void 0||(k=w.expandIcon)===null||k===void 0?void 0:k.call(w):I,S=typeof T<"u"&&ot(T)?T:b("span",{class:"".concat(l.value,"-menu-submenu-arrow")},[b(ln,{class:"".concat(l.value,"-menu-submenu-arrow-icon")},null)]),F=ot(u)?lt(u,{mode:"vertical",selectable:_,expandIcon:function(){return S}}):u;return F},v=H(function(){var o=t.placement;if(!o)return p.value==="rtl"?"bottomRight":"bottomLeft";if(o.includes("Center")){var c=o.slice(0,o.indexOf("Center"));return st(!o.includes("Center"),"Dropdown","You are using '".concat(o,"' placement in Dropdown, which is deprecated. Try to use '").concat(c,"' instead.")),c}return o}),s=function(c){r("update:visible",c),r("visibleChange",c)};return function(){var o,c,w=t.arrow,k=t.trigger,m=t.disabled,u=t.overlayClassName,C=(o=i.default)===null||o===void 0?void 0:o.call(i)[0],A=lt(C,tn({class:ye(C==null||(c=C.props)===null||c===void 0?void 0:c.class,ie({},"".concat(l.value,"-rtl"),p.value==="rtl"),"".concat(l.value,"-trigger"))},m?{disabled:m}:{})),_=ye(u,ie({},"".concat(l.value,"-rtl"),p.value==="rtl")),I=m?[]:k,T;I&&I.indexOf("contextmenu")!==-1&&(T=!0);var S=nn({arrowPointAtCenter:an(w)==="object"&&w.pointAtCenter,autoAdjustOverflow:!0}),F=rn(te(te(te({},t),a),{},{builtinPlacements:S,overlayClassName:_,arrow:w,alignPoint:T,prefixCls:l.value,getPopupContainer:E.value,transitionName:y.value,trigger:I,onVisibleChange:s,placement:v.value}),["overlay","onUpdate:visible"]);return b(sn,F,{default:function(){return[A]},overlay:g})}}});Ft.Button=Me;const fe=Ft;var pi=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},hi=pe({compatConfig:{MODE:3},name:"ACheckableTag",props:pi(),setup:function(t,n){var i=n.slots,a=n.emit,r=Ne("tag",t),f=r.prefixCls,l=function(E){var y=t.checked;a("update:checked",!y),a("change",!y),a("click",E)},d=H(function(){var p;return ye(f.value,(p={},ie(p,"".concat(f.value,"-checkable"),!0),ie(p,"".concat(f.value,"-checkable-checked"),t.checked),p))});return function(){var p;return b("span",{class:d.value,onClick:l},[(p=i.default)===null||p===void 0?void 0:p.call(i)])}}});const Ue=hi;var mi=new RegExp("^(".concat(on.join("|"),")(-inverse)?$")),gi=new RegExp("^(".concat(cn.join("|"),")$")),yi=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:xe.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:xe.any}},ge=pe({compatConfig:{MODE:3},name:"ATag",props:yi(),slots:["closeIcon","icon"],setup:function(t,n){var i=n.slots,a=n.emit,r=n.attrs,f=Ne("tag",t),l=f.prefixCls,d=f.direction,p=j(!0);un(function(){t.visible!==void 0&&(p.value=t.visible)});var E=function(s){s.stopPropagation(),a("update:visible",!1),a("close",s),!s.defaultPrevented&&t.visible===void 0&&(p.value=!1)},y=H(function(){var v=t.color;return v?mi.test(v)||gi.test(v):!1}),g=H(function(){var v;return ye(l.value,(v={},ie(v,"".concat(l.value,"-").concat(t.color),y.value),ie(v,"".concat(l.value,"-has-color"),t.color&&!y.value),ie(v,"".concat(l.value,"-hidden"),!p.value),ie(v,"".concat(l.value,"-rtl"),d.value==="rtl"),v))});return function(){var v,s,o,c=t.icon,w=c===void 0?(v=i.icon)===null||v===void 0?void 0:v.call(i):c,k=t.color,m=t.closeIcon,u=m===void 0?(s=i.closeIcon)===null||s===void 0?void 0:s.call(i):m,C=t.closable,A=C===void 0?!1:C,_=function(){return A?u?b("span",{class:"".concat(l.value,"-close-icon"),onClick:E},[u]):b(fn,{class:"".concat(l.value,"-close-icon"),onClick:E},null):null},I={backgroundColor:k&&!y.value?k:void 0},T=w||null,S=(o=i.default)===null||o===void 0?void 0:o.call(i),F=T?b(ne,null,[T,b("span",null,[S])]):S,B="onClick"in r,Q=b("span",{class:g.value,style:I},[F,_()]);return B?b(dn,null,{default:function(){return[Q]}}):Q}}});ge.CheckableTag=Ue;ge.install=function(e){return e.component(ge.name,ge),e.component(Ue.name,Ue),e};const bi=ge;fe.Button=Me;fe.install=function(e){return e.component(fe.name,fe),e.component(Me.name,Me),e};var wi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const Ai=wi;function mt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){ki(e,a,n[a])})}return e}function ki(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tt=function(t,n){var i=mt({},t,n.attrs);return b(we,mt({},i,{icon:Ai}),null)};tt.displayName="StarFilled";tt.inheritAttrs=!1;const Si=tt;var Ci={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const Ii=Ci;function gt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Ei(e,a,n[a])})}return e}function Ei(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(t,n){var i=gt({},t,n.attrs);return b(we,gt({},i,{icon:Ii}),null)};nt.displayName="FileOutlined";nt.inheritAttrs=!1;const _i=nt;var Pi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const Oi=Pi;function yt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){xi(e,a,n[a])})}return e}function xi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var it=function(t,n){var i=yt({},t,n.attrs);return b(we,yt({},i,{icon:Oi}),null)};it.displayName="FolderOpenOutlined";it.inheritAttrs=!1;const Ti=it;function Bi(e,t,n){if(!vn(n))return!1;var i=typeof t;return(i=="number"?pn(n)&&hn(t,n.length):i=="string"&&t in n)?mn(n[t],e):!1}function Mi(e){return e&&e.length?e[0]:void 0}var Ni=Math.ceil,$i=Math.max;function zi(e,t,n,i){for(var a=-1,r=$i(Ni((t-e)/(n||1)),0),f=Array(r);r--;)f[i?r:++a]=e,e+=n;return f}function Qi(e){return function(t,n,i){return i&&typeof i!="number"&&Bi(t,n,i)&&(n=i=void 0),t=Fe(t),n===void 0?(n=t,t=0):n=Fe(n),i=i===void 0?t<n?1:-1:Fe(i),zi(t,n,i,e)}}var Fi=Qi();const Dt=Fi,be=(...e)=>{document.addEventListener(...e),xt(()=>document.removeEventListener(...e))},Di="data:image/png;base64,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",Se=new WeakMap;function Li(e,t){return{useHookShareState:i=>{const a=yn();je(a),Se.has(a)||(Se.set(a,Ge(e(a,i??(t==null?void 0:t())))),xt(()=>{Se.delete(a)}));const r=Se.get(a);return je(r),{state:r,toRefs(){return gn(r)}}}}}var Ri={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const ji=Ri;function bt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Vi(e,a,n[a])})}return e}function Vi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var at=function(t,n){var i=bt({},t,n.attrs);return b(we,bt({},i,{icon:ji}),null)};at.displayName="DatabaseOutlined";at.inheritAttrs=!1;const Ui=at;var Hi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const Ji=Hi;function wt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Wi(e,a,n[a])})}return e}function Wi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rt=function(t,n){var i=wt({},t,n.attrs);return b(we,wt({},i,{icon:Ji}),null)};rt.displayName="StarOutlined";rt.inheritAttrs=!1;const Ki=rt;const me=async e=>(await Ae.value.get("/files",{params:{folder_path:e}})).data,qi=async e=>(await Ae.value.post("/delete_files",{file_paths:e})).data,Lt=async(e,t,n)=>(await Ae.value.post("/move_files",{file_paths:e,dest:t,create_dest_folder:n})).data,Gi=async(e,t,n)=>(await Ae.value.post("/copy_files",{file_paths:e,dest:t,create_dest_folder:n})).data,Yi=async e=>{await Ae.value.post("/mkdirs",{dest_folder:e})};var Rt={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(e,t){(function(n,i){e.exports=i})(bn,function(){var n={};n.version="0.3.5";var i=n.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};n.configure=function(s){var o,c;for(o in s)c=s[o],c!==void 0&&s.hasOwnProperty(o)&&(i[o]=c);return this},n.status=null,n.set=function(s){var o=n.isStarted();s=a(s,i.minimum,1),n.status=s===1?null:s;var c=n.render(!o),w=c.querySelector(i.barSelector),k=i.speed,m=i.easing;return c.offsetWidth,l(function(u){i.positionUsing===""&&(i.positionUsing=n.getPositioningCSS()),d(w,f(s,k,m)),s===1?(d(c,{transition:"none",opacity:1}),c.offsetWidth,setTimeout(function(){d(c,{transition:"all "+k+"ms linear",opacity:0}),setTimeout(function(){n.remove(),u()},k)},k)):setTimeout(u,k)}),this},n.isStarted=function(){return typeof n.status=="number"},n.start=function(){n.status||n.set(0);var s=function(){setTimeout(function(){n.status&&(n.trickle(),s())},i.trickleSpeed)};return i.trickle&&s(),this},n.done=function(s){return!s&&!n.status?this:n.inc(.3+.5*Math.random()).set(1)},n.inc=function(s){var o=n.status;return o?o>1?void 0:(typeof s!="number"&&(o>=0&&o<.2?s=.1:o>=.2&&o<.5?s=.04:o>=.5&&o<.8?s=.02:o>=.8&&o<.99?s=.005:s=0),o=a(o+s,0,.994),n.set(o)):n.start()},n.trickle=function(){return n.inc()},function(){var s=0,o=0;n.promise=function(c){return!c||c.state()==="resolved"?this:(o===0&&n.start(),s++,o++,c.always(function(){o--,o===0?(s=0,n.done()):n.set((s-o)/s)}),this)}}(),n.getElement=function(){var s=n.getParent();if(s){var o=Array.prototype.slice.call(s.querySelectorAll(".nprogress")).filter(function(c){return c.parentElement===s});if(o.length>0)return o[0]}return null},n.getParent=function(){if(i.parent instanceof HTMLElement)return i.parent;if(typeof i.parent=="string")return document.querySelector(i.parent)},n.render=function(s){if(n.isRendered())return n.getElement();E(document.documentElement,"nprogress-busy");var o=document.createElement("div");o.id="nprogress",o.className="nprogress",o.innerHTML=i.template;var c=o.querySelector(i.barSelector),w=s?"-100":r(n.status||0),k=n.getParent(),m;return d(c,{transition:"all 0 linear",transform:"translate3d("+w+"%,0,0)"}),i.showSpinner||(m=o.querySelector(i.spinnerSelector),m&&v(m)),k!=document.body&&E(k,"nprogress-custom-parent"),k.appendChild(o),o},n.remove=function(){n.status=null,y(document.documentElement,"nprogress-busy"),y(n.getParent(),"nprogress-custom-parent");var s=n.getElement();s&&v(s)},n.isRendered=function(){return!!n.getElement()},n.getPositioningCSS=function(){var s=document.body.style,o="WebkitTransform"in s?"Webkit":"MozTransform"in s?"Moz":"msTransform"in s?"ms":"OTransform"in s?"O":"";return o+"Perspective"in s?"translate3d":o+"Transform"in s?"translate":"margin"};function a(s,o,c){return s<o?o:s>c?c:s}function r(s){return(-1+s)*100}function f(s,o,c){var w;return i.positionUsing==="translate3d"?w={transform:"translate3d("+r(s)+"%,0,0)"}:i.positionUsing==="translate"?w={transform:"translate("+r(s)+"%,0)"}:w={"margin-left":r(s)+"%"},w.transition="all "+o+"ms "+c,w}var l=function(){var s=[];function o(){var c=s.shift();c&&c(o)}return function(c){s.push(c),s.length==1&&o()}}(),d=function(){var s=["Webkit","O","Moz","ms"],o={};function c(u){return u.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(C,A){return A.toUpperCase()})}function w(u){var C=document.body.style;if(u in C)return u;for(var A=s.length,_=u.charAt(0).toUpperCase()+u.slice(1),I;A--;)if(I=s[A]+_,I in C)return I;return u}function k(u){return u=c(u),o[u]||(o[u]=w(u))}function m(u,C,A){C=k(C),u.style[C]=A}return function(u,C){var A=arguments,_,I;if(A.length==2)for(_ in C)I=C[_],I!==void 0&&C.hasOwnProperty(_)&&m(u,_,I);else m(u,A[1],A[2])}}();function p(s,o){var c=typeof s=="string"?s:g(s);return c.indexOf(" "+o+" ")>=0}function E(s,o){var c=g(s),w=c+o;p(c,o)||(s.className=w.substring(1))}function y(s,o){var c=g(s),w;p(s,o)&&(w=c.replace(" "+o+" "," "),s.className=w.substring(1,w.length-1))}function g(s){return(" "+(s&&s.className||"")+" ").replace(/\s+/gi," ")}function v(s){s&&s.parentNode&&s.parentNode.removeChild(s)}return n})})(Rt);var Zi=Rt.exports;const Xi=wn(Zi),ea=e=>{const t=j("");return new Promise(n=>{ce.confirm({title:L("inputFolderName"),content:()=>b(An,{value:t.value,"onUpdate:value":i=>t.value=i},null),async onOk(){if(!t.value)return;const i=Ye(e,t.value);await Yi(i),n()}})})},jt=()=>b("p",{style:{background:"var(--zp-secondary-background)",padding:"8px",borderLeft:"4px solid var(--primary-color)"}},[R("Tips: "),L("multiSelectTips")]);function ta(){const e=[];for(let a=0;a<72;a++){const f=`hsl(${a*7.2}, 90%, 35%)`;e.push(f)}return e}const At=ta(),Vt=Tt("useTagStore",()=>{const e=Ge(new Map),t=async r=>{if(r=r.filter(f=>!e.has(f)),!!r.length)try{r.forEach(l=>e.set(l,[]));const f=await ri(r);for(const l in f)e.set(l,f[l])}catch{r.forEach(f=>e.delete(f))}},n=new Map;return{tagMap:e,getColor:r=>{let f=n.get(r);if(!f){const l=ct.hash.sha256.hash(r),d=parseInt(ct.codec.hex.fromBits(l),16)%At.length;f=At[d],n.set(r,f)}return f},fetchImageTags:t,refreshTags:async r=>{r.forEach(f=>e.delete(f)),await t(r)}}}),na=Tt("useBatchDownloadStore",()=>{const e=j([]);return{selectdFiles:e,addFiles:n=>{e.value=kn([...e.value,...n])}}});class kt{constructor(t,n=Sn.CREATED_TIME_DESC){ze(this,"root");ze(this,"execQueue",[]);this.sortMethod=n,this.root={children:[],info:{name:t,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:t}},this.fetchChildren(this.root)}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const t=n=>n.children.map(i=>{if(i.info.type==="dir")return t(i);if(K(i.info.name))return i.info}).filter(i=>i).flat(1);return t(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(t){const{files:n}=await me(t.info.fullpath);return t.children=Bt(n,this.sortMethod).map(i=>({info:i,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...t.children.filter(i=>i.info.type==="dir").map(i=>({fn:()=>this.fetchChildren(i),...i}))),t}async next(){const t=Mi(this.execQueue);if(!t)return null;const n=await t.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},n}}function Le(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$n(e)}const Ee=new Map,x=Ze(),ia=na(),Ut=Vt(),St=Cn(),Ce=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:_e,useEventListen:He}=Mt(),{useHookShareState:ae}=Li((e,{images:t})=>{const n=j({tabIdx:-1,paneIdx:-1}),i=H(()=>de(a.value)),a=j([]),r=H(()=>{var k;return a.value.map(m=>m.curr).slice((k=x.conf)!=null&&k.is_win?1:0)}),f=H(()=>Ye(...r.value)),l=j(x.defaultSortingMethod),d=j(n.value.walkModePath?new kt(n.value.walkModePath,l.value):void 0);ve([()=>n.value.walkModePath,l],()=>{d.value=n.value.walkModePath?new kt(n.value.walkModePath,l.value):void 0});const p=Ge(new Set);ve(i,()=>p.clear());const E=H(()=>{var C;if(t.value)return t.value;if(d.value)return d.value.images.filter(A=>!p.has(A.fullpath));if(!i.value)return[];const k=((C=i.value)==null?void 0:C.files)??[],m=l.value;return Bt((A=>x.onlyFoldersAndImages?A.filter(_=>_.type==="dir"||K(_.name)):A)(k),m).filter(A=>!p.has(A.fullpath))}),y=j([]),g=j(-1),v=H(()=>d.value?!d.value.isCompleted:!1),s=j(!1),o=j(!1),c=()=>{var k,m,u;return(u=(m=(k=x.tabList)==null?void 0:k[n.value.tabIdx])==null?void 0:m.panes)==null?void 0:u[n.value.paneIdx]},w=Mt();return w.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${E.value.length}`),y.value=Dt(0,E.value.length)}),{previewing:o,spinning:s,canLoadNext:v,multiSelectedIdxs:y,previewIdx:g,basePath:r,currLocation:f,currPage:i,stack:a,sortMethod:l,sortedFiles:E,scroller:j(),stackViewEl:j(),props:n,getPane:c,walker:d,deletedFiles:p,...w}},()=>({images:j()}));function Va(){const{previewIdx:e,eventEmitter:t,canLoadNext:n,previewing:i,sortedFiles:a,scroller:r,props:f}=ae().toRefs(),{state:l}=ae();let d=null;const p=(v,s)=>{var o;i.value=v,d!=null&&!v&&s&&((o=r.value)==null||o.scrollToItem(d),d=null)},E=()=>{f.value.walkModePath&&!g("next")&&n&&(X.info(L("loadingNextFolder")),t.value.emit("loadNextDir",!0))};be("keydown",v=>{var s;if(i.value){let o=e.value;if(["ArrowDown","ArrowRight"].includes(v.key))for(o++;a.value[o]&&!K(a.value[o].name);)o++;else if(["ArrowUp","ArrowLeft"].includes(v.key))for(o--;a.value[o]&&!K(a.value[o].name);)o--;if(K((s=a.value[o])==null?void 0:s.name)??""){e.value=o;const c=r.value;c&&!(o>=c.$_startIndex&&o<=c.$_endIndex)&&(d=o)}E()}});const y=v=>{var o;let s=e.value;if(v==="next")for(s++;a.value[s]&&!K(a.value[s].name);)s++;else if(v==="prev")for(s--;a.value[s]&&!K(a.value[s].name);)s--;if(K((o=a.value[s])==null?void 0:o.name)??""){e.value=s;const c=r.value;c&&!(s>=c.$_startIndex&&s<=c.$_endIndex)&&(d=s)}E()},g=v=>{var o;let s=e.value;if(v==="next")for(s++;a.value[s]&&!K(a.value[s].name);)s++;else if(v==="prev")for(s--;a.value[s]&&!K(a.value[s].name);)s--;return K((o=a.value[s])==null?void 0:o.name)??""};return He("removeFiles",async()=>{var v;i.value&&!l.sortedFiles[e.value]&&(X.info(L("manualExitFullScreen"),5),await Xe(500),(v=document.querySelector(".ant-image-preview-operations-operation .anticon-close"))==null||v.click(),e.value=-1)}),{previewIdx:e,onPreviewVisibleChange:p,previewing:i,previewImgMove:y,canPreview:g}}function Ua(){const e=j(),{scroller:t,stackViewEl:n,stack:i,currPage:a,currLocation:r,useEventListen:f,eventEmitter:l,getPane:d,props:p,deletedFiles:E,walker:y,sortedFiles:g}=ae().toRefs();ve(()=>i.value.length,Te((h,O)=>{var N;h!==O&&((N=t.value)==null||N.scrollToItem(0))},300));const v=async h=>{var O;await k(h),p.value.walkModePath&&(await Xe(),await((O=y.value)==null?void 0:O.reset()),l.value.emit("loadNextDir"))};In(async()=>{var h;if(!i.value.length){const O=await me("/");i.value.push({files:O.files,curr:"/"})}e.value=new Xi,e.value.configure({parent:n.value}),p.value.path&&p.value.path!=="/"?await v(p.value.walkModePath??p.value.path):(h=x.conf)!=null&&h.home&&k(x.conf.home)}),ve(r,Te(h=>{const O=d.value();if(!O)return;O.path=h;const N=O.path.split("/").pop(),U=(()=>{var Y;if(!p.value.walkModePath){const W=Ie(h);for(const[re,se]of Object.entries(x.pathAliasMap))if(W.startsWith(se))return W.replace(se,re);return N}return"Walk: "+(((Y=x.quickMovePaths.find(W=>W.dir===O.walkModePath))==null?void 0:Y.zh)??N)})();O.name=Qe("div",{style:"display:flex;align-items:center"},[Qe(Ui),Qe("span",{class:"line-clamp-1",style:"max-width: 256px"},U)]),O.nameFallbackStr=U,x.recent=x.recent.filter(Y=>Y.key!==O.key),x.recent.unshift({path:h,key:O.key}),x.recent.length>20&&(x.recent=x.recent.slice(0,20))},300));const s=()=>Ve(r.value),o=async h=>{var O,N;if(h.type==="dir")try{(O=e.value)==null||O.start();const{files:G}=await me(h.fullpath);i.value.push({files:G,curr:h.name})}finally{(N=e.value)==null||N.done()}},c=h=>{for(;h<i.value.length-1;)i.value.pop()},w=(h,O)=>(je(x.conf,"global.conf load failed"),x.conf.is_win?h.toLowerCase()==O.toLowerCase():h==O),k=async h=>{var N,G;const O=i.value.slice();try{En(h)||(h=Ye(((N=x.conf)==null?void 0:N.sd_cwd)??"/",h));const U=ut(h),Y=i.value.map(W=>W.curr);for(Y.shift();Y[0]&&U[0]&&w(Y[0],U[0]);)Y.shift(),U.shift();for(let W=0;W<Y.length;W++)i.value.pop();if(!U.length)return m();for(const W of U){const re=(G=a.value)==null?void 0:G.files.find(se=>w(se.name,W));if(!re)throw console.error({frags:U,frag:W,stack:Nt(i.value)}),new Error(`${W} not found`);await o(re)}}catch(U){throw X.error(L("moveFailedCheckPath")+(U instanceof Error?U.message:"")),console.error(h,ut(h),a.value),i.value=O,U}},m=dt(async()=>{var h,O,N;try{if((h=e.value)==null||h.start(),y.value)await y.value.reset(),l.value.emit("loadNextDir");else{const{files:G}=await me(i.value.length===1?"/":r.value);de(i.value).files=G}E.value.clear(),(O=t.value)==null||O.scrollToItem(0),X.success(L("refreshCompleted"))}finally{(N=e.value)==null||N.done()}});_n("returnToIIB",dt(async()=>{var h,O;if(!p.value.walkModePath)try{(h=e.value)==null||h.start();const{files:N}=await me(i.value.length===1?"/":r.value);de(i.value).files.map(U=>U.date).join()!==N.map(U=>U.date).join()&&(de(i.value).files=N,X.success(L("autoUpdate")))}finally{(O=e.value)==null||O.done()}})),f.value("refresh",m);const u=h=>{p.value.walkModePath&&(d.value().walkModePath=h),v(h)},C=H(()=>x.quickMovePaths.map(h=>({...h,path:Ie(h.dir)}))),A=H(()=>{const h=Ie(r.value);return C.value.find(N=>N.path===h)}),_=async()=>{const h=A.value;if(h){if(!h.can_delete)return;await si(r.value),X.success(L("removeCompleted"))}else await li(r.value),X.success(L("addCompleted"));ft.emit("searchIndexExpired"),ft.emit("updateGlobalSetting")},I=j(!1),T=j(r.value),S=()=>{I.value=!0,T.value=r.value},F=async()=>{await k(T.value),I.value=!1};be("click",()=>{I.value=!1});const B=()=>{const h=parent.location,O=h.href.substring(0,h.href.length-h.search.length),N=new URLSearchParams(h.search);N.set("action","open"),y.value&&N.set("walk","1"),N.set("path",r.value);const G=`${O}?${N.toString()}`;Ve(G,L("copyLocationUrlSuccessMsg"))},Q=()=>l.value.emit("selectAll"),P=async()=>{await ea(r.value),await m()},M=()=>{const h=r.value;Ee.set(h,i.value);const O=x.tabList[p.value.tabIdx],N={type:"local",key:he(),path:h,name:L("local"),stackKey:h,walkModePath:h};O.panes.push(N),O.key=N.key},D=H(()=>!y.value&&g.value.some(h=>h.type==="dir"));return{locInputValue:T,isLocationEditing:I,onLocEditEnter:F,onEditBtnClick:S,addToSearchScanPathAndQuickMove:_,searchPathInfo:A,refresh:m,copyLocation:s,back:c,openNext:o,currPage:a,currLocation:r,to:k,stack:i,scroller:t,share:B,selectAll:Q,quickMoveTo:u,onCreateFloderBtnClick:P,onWalkBtnClick:M,showWalkButton:D}}function Ha(){const{scroller:e,sortedFiles:t,sortMethod:n,currLocation:i,stackViewEl:a,canLoadNext:r,previewIdx:f,props:l,walker:d}=ae().toRefs(),{state:p}=ae(),E=j(!1),y=j(x.defaultGridCellWidth),g=H(()=>y.value+16),v=44,{width:s}=Pn(a),o=H(()=>~~(s.value/g.value)),c=H(()=>{const A=g.value;return{first:A+(y.value<=160?0:v),second:A}}),w=j(!1),k=async()=>{var A;if(!(w.value||!l.value.walkModePath||!r.value))try{w.value=!0,await((A=d.value)==null?void 0:A.next())}finally{w.value=!1}},m=async(A=!1)=>{const _=e.value,I=()=>A?f.value:(_==null?void 0:_.$_endIndex)??0;for(;!t.value.length||I()>t.value.length-20&&r.value;)await Xe(30),await k()};p.useEventListen("loadNextDir",m);const u=()=>{const A=e.value;if(A){const _=t.value.slice(Math.max(A.$_startIndex-10,0),A.$_endIndex+10).filter(I=>I.is_under_scanned_path&&K(I.name)).map(I=>I.fullpath);Ut.fetchImageTags(_)}};ve(i,Te(u,150));const C=Te(()=>{m(),u()},300);return{gridItems:o,sortedFiles:t,sortMethodConv:On,moreActionsDropdownShow:E,gridSize:g,sortMethod:n,onScroll:C,loadNextDir:k,loadNextDirLoading:w,canLoadNext:r,itemSize:c,cellWidth:y,onViewedImagesChange:u}}function Ja(){const{currLocation:e,sortedFiles:t,currPage:n,multiSelectedIdxs:i,eventEmitter:a,walker:r}=ae().toRefs(),f=()=>{i.value=[]};return be("click",f),be("blur",f),ve(n,f),{onFileDragStart:(E,y)=>{const g=Nt(t.value[y]);St.fileDragging=!0,console.log("onFileDragStart set drag file ",E,y,g);const v=[g];let s=g.type==="dir";if(i.value.includes(y)){const c=i.value.map(w=>t.value[w]);v.push(...c),s=c.some(w=>w.type==="dir")}const o={includeDir:s,loc:e.value||"search-result",path:vt(v,"fullpath").map(c=>c.fullpath),nodes:vt(v,"fullpath"),__id:"FileTransferData"};E.dataTransfer.setData("text/plain",JSON.stringify(o))},onDrop:async E=>{if(r.value)return;const y=Bn(E);if(!y)return;const g=e.value;if(y.loc===g)return;const v=$t(),s=async()=>v.pushAction(async()=>{await Gi(y.path,g),a.value.emit("refresh"),ce.destroyAll()}),o=()=>v.pushAction(async()=>{await Lt(y.path,g),_e.emit("removeFiles",{paths:y.path,loc:y.loc}),a.value.emit("refresh"),ce.destroyAll()});ce.confirm({title:L("confirm")+"?",width:"60vw",content:()=>{let c,w,k;return b("div",null,[b("div",null,[`${L("moveSelectedFilesTo")} ${g}`,b("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[y.path.map(m=>b("li",null,[m.split(/[/\\]/).pop()]))])]),b(jt,null,null),b("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},class:"actions"},[b(ue,{onClick:ce.destroyAll},Le(c=L("cancel"))?c:{default:()=>[c]}),b(ue,{type:"primary",loading:!v.isIdle,onClick:s},Le(w=L("copy"))?w:{default:()=>[w]}),b(ue,{type:"primary",loading:!v.isIdle,onClick:o},Le(k=L("move"))?k:{default:()=>[k]})])])},maskClosable:!0,wrapClassName:"hidden-antd-btns-modal"})},multiSelectedIdxs:i,onFileDragEnd:()=>{St.fileDragging=!1}}}function Wa({openNext:e}){const t=j(!1),n=j(""),{sortedFiles:i,previewIdx:a,multiSelectedIdxs:r,stack:f,currLocation:l,spinning:d,previewing:p,stackViewEl:E,eventEmitter:y,props:g,deletedFiles:v}=ae().toRefs(),s=Ie;He("removeFiles",({paths:m,loc:u})=>{s(u)!==s(l.value)||!de(f.value)||(m.forEach(A=>v.value.add(A)),m.filter(K).forEach(A=>v.value.add(A.replace(/\.\w+$/,".txt"))))}),He("addFiles",({files:m,loc:u})=>{if(s(u)!==s(l.value))return;const C=de(f.value);C&&C.files.unshift(...m)});const o=$t(),c=async(m,u,C)=>{a.value=C,x.fullscreenPreviewInitialUrl=le(u);const A=r.value.indexOf(C);if(m.shiftKey){if(A!==-1)r.value.splice(A,1);else{r.value.push(C),r.value.sort((T,S)=>T-S);const _=r.value[0],I=r.value[r.value.length-1];r.value=Dt(_,I+1)}m.stopPropagation()}else m.ctrlKey||m.metaKey?(A!==-1?r.value.splice(A,1):r.value.push(C),m.stopPropagation()):await e(u)},w=async(m,u,C)=>{var F,B,Q;const A=le(u),_=l.value,I={IIB_container_id:parent.IIB_container_id},T=()=>{let P=[];return r.value.includes(C)?P=r.value.map(M=>i.value[M]):P.push(u),P},S=async P=>{if(!d.value)try{d.value=!0,await zn(u.fullpath),Ce.postMessage({...I,event:"click_hidden_button",btnEleId:"iib_hidden_img_update_trigger"});const M=setTimeout(()=>Qn.warn({message:L("long_loading"),duration:20}),5e3);await Fn(),clearTimeout(M),Ce.postMessage({...I,event:"click_hidden_button",btnEleId:`iib_hidden_tab_${P}`})}catch(M){console.error(M),X.error("发送图像失败，请携带console的错误消息找开发者")}finally{d.value=!1}};if(`${m.key}`.startsWith("toggle-tag-")){const P=+`${m.key}`.split("toggle-tag-")[1],{is_remove:M}=await oi({tag_id:P,img_path:u.fullpath}),D=(B=(F=x.conf)==null?void 0:F.all_custom_tags.find(h=>h.id===P))==null?void 0:B.name;Ut.refreshTags([u.fullpath]),X.success(L(M?"removedTagFromImage":"addedTagToImage",{tag:D}));return}switch(m.key){case"previewInNewWindow":return window.open(A);case"download":return window.open(le(u,!0));case"copyPreviewUrl":return Ve(parent.document.location.origin+A);case"send2txt2img":return S("txt2img");case"send2img2img":return S("img2img");case"send2inpaint":return S("inpaint");case"send2extras":return S("extras");case"send2savedDir":{const P=x.quickMovePaths.find(h=>h.key==="outdir_save");if(!P)return X.error(L("unknownSavedDir"));const M=Nn(P.dir,(Q=x.conf)==null?void 0:Q.sd_cwd),D=T();await Lt(D.map(h=>h.fullpath),M,!0),_e.emit("removeFiles",{paths:D.map(h=>h.fullpath),loc:l.value}),_e.emit("addFiles",{files:D,loc:M});break}case"send2controlnet-img2img":case"send2controlnet-txt2img":{const P=m.key.split("-")[1];Ce.postMessage({...I,event:"send_to_control_net",type:P,url:le(u)});break}case"send2outpaint":{n.value=await o.pushAction(()=>pt(u.fullpath)).res;const[P,M]=(n.value||"").split(`
`);Ce.postMessage({...I,event:"send_to_outpaint",url:le(u),prompt:P,negPrompt:M.slice(17)});break}case"openWithWalkMode":{Ee.set(_,f.value);const P=x.tabList[g.value.tabIdx],M={type:"local",key:he(),path:u.fullpath,name:L("local"),stackKey:_,walkModePath:u.fullpath};P.panes.push(M),P.key=M.key;break}case"openInNewTab":{Ee.set(_,f.value);const P=x.tabList[g.value.tabIdx],M={type:"local",key:he(),path:u.fullpath,name:L("local"),stackKey:_};P.panes.push(M),P.key=M.key;break}case"openOnTheRight":{Ee.set(_,f.value);let P=x.tabList[g.value.tabIdx+1];P||(P={panes:[],key:"",id:he()},x.tabList[g.value.tabIdx+1]=P);const M={type:"local",key:he(),path:u.fullpath,name:L("local"),stackKey:_};P.panes.push(M),P.key=M.key;break}case"send2BatchDownload":{ia.addFiles(T());break}case"viewGenInfo":{t.value=!0,n.value=await o.pushAction(()=>pt(u.fullpath)).res;break}case"openWithLocalFileBrowser":{await Mn(u.fullpath);break}case"deleteFiles":{const P=T(),M=async()=>{const D=P.map(h=>h.fullpath);await qi(D),X.success(L("deleteSuccess")),_e.emit("removeFiles",{paths:D,loc:l.value})};if(P.length===1&&x.ignoredConfirmActions.deleteOneOnly)return M();await new Promise(D=>{ce.confirm({title:L("confirmDelete"),maskClosable:!0,width:"60vw",content:()=>b("div",null,[b("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[P.map(h=>b("li",null,[h.fullpath.split(/[/\\]/).pop()]))]),b(jt,null,null),b(ci,{checked:x.ignoredConfirmActions.deleteOneOnly,"onUpdate:checked":h=>x.ignoredConfirmActions.deleteOneOnly=h},{default:()=>[L("deleteOneOnlySkipConfirm"),R(" ("),L("resetOnGlobalSettingsPage"),R(")")]})]),async onOk(){await M(),D()}})});break}}return{}},{isOutside:k}=xn(E);return be("keydown",m=>{var C,A,_;const u=ui(m);if(p.value){const I=(C=Object.entries(x.shortcut).find(T=>T[1]===u&&T[1]))==null?void 0:C[0];if(I){m.stopPropagation(),m.preventDefault();const T=a.value,S=i.value[T];switch(I){case"delete":return le(S)===x.fullscreenPreviewInitialUrl?X.warn(L("fullscreenRestriction")):w({key:"deleteFiles"},S,T);default:{const F=(A=/^toggle_tag_(.*)$/.exec(I))==null?void 0:A[1],B=(_=x.conf)==null?void 0:_.all_custom_tags.find(Q=>Q.name===F);return B?w({key:`toggle-tag-${B.id}`},S,T):void 0}}}}else!k.value&&["Ctrl + KeyA","Cmd + KeyA"].includes(u)&&(m.preventDefault(),m.stopPropagation(),y.value.emit("selectAll"))}),{onFileItemClick:c,onContextMenuClick:w,showGenInfo:t,imageGenInfo:n,q:o}}const Ka=()=>{const{stackViewEl:e}=ae().toRefs(),t=j(-1);return Tn(e,n=>{var a;let i=n.target;for(;i.parentElement;)if(i=i.parentElement,i.tagName.toLowerCase()==="li"&&i.classList.contains("file-item-trigger")){const r=(a=i.dataset)==null?void 0:a.idx;r&&Number.isSafeInteger(+r)&&(t.value=+r);return}}),{showMenuIdx:t}};function aa(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var a=e.indexOf("Edge/");return a>0?parseInt(e.substring(a+5,e.indexOf(".",a)),10):-1}let Pe;function Je(){Je.init||(Je.init=!0,Pe=aa()!==-1)}var $e={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Je(),zt(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",Pe&&this.$el.appendChild(e),e.data="about:blank",Pe||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Pe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const ra=Rn();Dn("data-v-b329ee4c");const sa={class:"resize-observer",tabindex:"-1"};Ln();const la=ra((e,t,n,i,a,r)=>(z(),q("div",sa)));$e.render=la;$e.__scopeId="data-v-b329ee4c";$e.__file="src/components/ResizeObserver.vue";function Oe(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Oe=function(t){return typeof t}:Oe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(e)}function oa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ca(e,t,n){return t&&Ct(e.prototype,t),n&&Ct(e,n),e}function It(e){return ua(e)||da(e)||fa(e)||va()}function ua(e){if(Array.isArray(e))return We(e)}function da(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function fa(e,t){if(e){if(typeof e=="string")return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return We(e,t)}}function We(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function va(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pa(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function ha(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,r,f=function(d){for(var p=arguments.length,E=new Array(p>1?p-1:0),y=1;y<p;y++)E[y-1]=arguments[y];if(r=E,!(i&&d===a)){var g=n.leading;typeof g=="function"&&(g=g(d,a)),(!i||d!==a)&&g&&e.apply(void 0,[d].concat(It(r))),a=d,clearTimeout(i),i=setTimeout(function(){e.apply(void 0,[d].concat(It(r))),i=0},t)}};return f._clear=function(){clearTimeout(i),i=null},f}function Ht(e,t){if(e===t)return!0;if(Oe(e)==="object"){for(var n in e)if(!Ht(e[n],t[n]))return!1;return!0}return!1}var ma=function(){function e(t,n,i){oa(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(n,i)}return ca(e,[{key:"createObserver",value:function(n,i){var a=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=pa(n),this.callback=function(l,d){a.options.callback(l,d),l&&a.options.once&&(a.frozen=!0,a.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},f=r.leading;this.callback=ha(this.callback,this.options.throttle,{leading:function(d){return f==="both"||f==="visible"&&d||f==="hidden"&&!d}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(l){var d=l[0];if(l.length>1){var p=l.find(function(y){return y.isIntersecting});p&&(d=p)}if(a.callback){var E=d.isIntersecting&&d.intersectionRatio>=a.threshold;if(E===a.oldResult)return;a.oldResult=E,a.callback(E,d)}},this.options.intersection),zt(function(){a.observer&&a.observer.observe(a.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function Jt(e,t,n){var i=t.value;if(i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var a=new ma(e,i,n);e._vue_visibilityState=a}}function ga(e,t,n){var i=t.value,a=t.oldValue;if(!Ht(i,a)){var r=e._vue_visibilityState;if(!i){Wt(e);return}r?r.createObserver(i,n):Jt(e,{value:i},n)}}function Wt(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var ya={beforeMount:Jt,updated:ga,unmounted:Wt},ba={itemsLimit:1e3},wa=/(auto|scroll)/;function Kt(e,t){return e.parentNode===null?t:Kt(e.parentNode,t.concat([e]))}var Re=function(t,n){return getComputedStyle(t,null).getPropertyValue(n)},Aa=function(t){return Re(t,"overflow")+Re(t,"overflow-y")+Re(t,"overflow-x")},ka=function(t){return wa.test(Aa(t))};function Et(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var t=Kt(e.parentNode,[]),n=0;n<t.length;n+=1)if(ka(t[n]))return t[n];return document.scrollingElement||document.documentElement}}function Ke(e){"@babel/helpers - typeof";return Ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(e)}var Sa={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Ca(){return this.items.length&&Ke(this.items[0])!=="object"}var qe=!1;if(typeof window<"u"){qe=!1;try{var Ia=Object.defineProperty({},"passive",{get:function(){qe=!0}});window.addEventListener("test",null,Ia)}catch{}}let Ea=0;var qt={name:"RecycleScroller",components:{ResizeObserver:$e},directives:{ObserveVisibility:ya},props:{...Sa,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},t=this.items,n=this.sizeField,i=this.minItemSize;let a=1e4,r=0,f;for(let l=0,d=t.length;l<d;l++)f=t[l][n]||i,f<a&&(a=f),r+=f,e[l]={accumulator:r,size:f};return this.$_computedMinItemSize=a,e}return[]},simpleArray:Ca,itemIndexByKey(){const{keyField:e,items:t}=this,n={};for(let i=0,a=t.length;i<a;i++)n[t[i][e]]=i;return n}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,t,n,i,a){const r=jn({id:Ea++,index:t,used:!0,key:i,type:a}),f=Vn({item:n,position:0,nr:r});return e.push(f),f},unuseView(e,t=!1){const n=this.$_unusedViews,i=e.nr.type;let a=n.get(i);a||(a=[],n.set(i,a)),a.push(e),t||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:n}=this.updateVisibleItems(!1,!0);n||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(e,t){this.ready&&(e||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,t=!1){const n=this.itemSize,i=this.gridItems||1,a=this.itemSecondarySize||n,r=this.$_computedMinItemSize,f=this.typeField,l=this.simpleArray?null:this.keyField,d=this.items,p=d.length,E=this.sizes,y=this.$_views,g=this.$_unusedViews,v=this.pool,s=this.itemIndexByKey;let o,c,w,k,m;if(!p)o=c=k=m=w=0;else if(this.$_prerender)o=k=0,c=m=Math.min(this.prerender,d.length),w=null;else{const S=this.getScroll();if(t){let Q=S.start-this.$_lastUpdateScrollPosition;if(Q<0&&(Q=-Q),n===null&&Q<r||Q<n)return{continuous:!0}}this.$_lastUpdateScrollPosition=S.start;const F=this.buffer;S.start-=F,S.end+=F;let B=0;if(this.$refs.before&&(B=this.$refs.before.scrollHeight,S.start-=B),this.$refs.after){const Q=this.$refs.after.scrollHeight;S.end+=Q}if(n===null){let Q,P=0,M=p-1,D=~~(p/2),h;do h=D,Q=E[D].accumulator,Q<S.start?P=D:D<p-1&&E[D+1].accumulator>S.start&&(M=D),D=~~((P+M)/2);while(D!==h);for(D<0&&(D=0),o=D,w=E[p-1].accumulator,c=D;c<p&&E[c].accumulator<S.end;c++);for(c===-1?c=d.length-1:(c++,c>p&&(c=p)),k=o;k<p&&B+E[k].accumulator<S.start;k++);for(m=k;m<p&&B+E[m].accumulator<S.end;m++);}else{o=~~(S.start/n*i);const Q=o%i;o-=Q,c=Math.ceil(S.end/n*i),k=Math.max(0,Math.floor((S.start-B)/n*i)),m=Math.floor((S.end-B)/n*i),o<0&&(o=0),c>p&&(c=p),k<0&&(k=0),m>p&&(m=p),w=Math.ceil(p/i)*n}}c-o>ba.itemsLimit&&this.itemsLimitError(),this.totalSize=w;let u;const C=o<=this.$_endIndex&&c>=this.$_startIndex;if(C)for(let S=0,F=v.length;S<F;S++)u=v[S],u.nr.used&&(e&&(u.nr.index=s[u.item[l]]),(u.nr.index==null||u.nr.index<o||u.nr.index>=c)&&this.unuseView(u));const A=C?null:new Map;let _,I,T;for(let S=o;S<c;S++){_=d[S];const F=l?_[l]:_;if(F==null)throw new Error(`Key is ${F} on item (keyField is '${l}')`);if(u=y.get(F),!n&&!E[S].size){u&&this.unuseView(u);continue}I=_[f];let B=g.get(I),Q=!1;if(!u)C?B&&B.length?u=B.pop():u=this.addView(v,S,_,F,I):(T=A.get(I)||0,(!B||T>=B.length)&&(u=this.addView(v,S,_,F,I),this.unuseView(u,!0),B=g.get(I)),u=B[T],A.set(I,T+1)),y.delete(u.nr.key),u.nr.used=!0,u.nr.index=S,u.nr.key=F,u.nr.type=I,y.set(F,u),Q=!0;else if(!u.nr.used&&(u.nr.used=!0,u.nr.index=S,Q=!0,B)){const P=B.indexOf(u);P!==-1&&B.splice(P,1)}u.item=_,Q&&(S===d.length-1&&this.$emit("scroll-end"),S===0&&this.$emit("scroll-start")),n===null?(u.position=E[S-1].accumulator,u.offset=0):(u.position=Math.floor(S/i)*n,u.offset=S%i*a)}return this.$_startIndex=o,this.$_endIndex=c,this.emitUpdate&&this.$emit("update",o,c,k,m),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:C}},getListenerTarget(){let e=Et(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:t}=this,n=t==="vertical";let i;if(this.pageMode){const a=e.getBoundingClientRect(),r=n?a.height:a.width;let f=-(n?a.top:a.left),l=n?window.innerHeight:window.innerWidth;f<0&&(l+=f,f=0),f+l>r&&(l=r-f),i={start:f,end:f+l}}else n?i={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:i={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return i},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,qe?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let t;const n=this.gridItems||1;this.itemSize===null?t=e>0?this.sizes[e-1].accumulator:0:t=Math.floor(e/n)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(e){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let n,i,a;if(this.pageMode){const r=Et(this.$el),f=r.tagName==="HTML"?0:r[t.scroll],l=r.getBoundingClientRect(),p=this.$el.getBoundingClientRect()[t.start]-l[t.start];n=r,i=t.scroll,a=e+f+p}else n=this.$el,i=t.scroll,a=e;n[i]=a},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,t)=>e.nr.index-t.nr.index)}}};const _a={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Pa={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Oa(e,t,n,i,a,r){const f=Un("ResizeObserver"),l=Hn("observe-visibility");return Jn((z(),J("div",{class:Be(["vue-recycle-scroller",{ready:a.ready,"page-mode":n.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...d)=>r.handleScroll&&r.handleScroll(...d))},[e.$slots.before?(z(),J("div",_a,[ke(e.$slots,"before")],512)):ee("v-if",!0),(z(),q(ht(n.listTag),{ref:"wrapper",style:qn({[e.direction==="vertical"?"minHeight":"minWidth"]:a.totalSize+"px"}),class:Be(["vue-recycle-scroller__item-wrapper",n.listClass])},{default:$(()=>[(z(!0),J(ne,null,et(a.pool,d=>(z(),q(ht(n.itemTag),Wn({key:d.nr.id,style:a.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${d.position}px) translate${e.direction==="vertical"?"X":"Y"}(${d.offset}px)`,width:n.gridItems?`${e.direction==="vertical"&&n.itemSecondarySize||n.itemSize}px`:void 0,height:n.gridItems?`${e.direction==="horizontal"&&n.itemSecondarySize||n.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[n.itemClass,{hover:!n.skipHover&&a.hoverKey===d.nr.key}]]},Kn(n.skipHover?{}:{mouseenter:()=>{a.hoverKey=d.nr.key},mouseleave:()=>{a.hoverKey=null}})),{default:$(()=>[ke(e.$slots,"default",{item:d.item,index:d.nr.index,active:d.nr.used})]),_:2},1040,["style","class"]))),128)),ke(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(z(),J("div",Pa,[ke(e.$slots,"after")],512)):ee("v-if",!0),b(f,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[l,r.handleVisibilityChange]])}qt.render=Oa;qt.__file="src/components/RecycleScroller.vue";const _t=pe({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},disableDelete:{type:Boolean}},emits:["contextMenuClick"],setup(e,{emit:t}){const n=e,i=Ze(),a=H(()=>{var r;return(((r=i.conf)==null?void 0:r.all_custom_tags)??[]).reduce((f,l)=>[...f,{...l,selected:!!n.selectedTag.find(d=>d.id===l.id)}],[])});return(r,f)=>{const l=Gn,d=Yn,p=Zn,E=Xn;return z(),q(E,{onClick:f[0]||(f[0]=y=>t("contextMenuClick",y,r.file,r.idx))},{default:$(()=>{var y;return[b(l,{key:"deleteFiles",disabled:r.disableDelete},{default:$(()=>[R(V(r.$t("deleteSelected")),1)]),_:1},8,["disabled"]),r.file.type==="dir"?(z(),J(ne,{key:0},[b(l,{key:"openInNewTab"},{default:$(()=>[R(V(r.$t("openInNewTab")),1)]),_:1}),b(l,{key:"openOnTheRight"},{default:$(()=>[R(V(r.$t("openOnTheRight")),1)]),_:1}),b(l,{key:"openWithWalkMode"},{default:$(()=>[R(V(r.$t("openWithWalkMode")),1)]),_:1})],64)):ee("",!0),r.file.type==="file"?(z(),J(ne,{key:1},[Z(K)(r.file.name)?(z(),J(ne,{key:0},[b(l,{key:"viewGenInfo"},{default:$(()=>[R(V(r.$t("viewGenerationInfo")),1)]),_:1}),b(d),((y=Z(i).conf)==null?void 0:y.launch_mode)!=="server"?(z(),J(ne,{key:0},[b(l,{key:"send2txt2img"},{default:$(()=>[R(V(r.$t("sendToTxt2img")),1)]),_:1}),b(l,{key:"send2img2img"},{default:$(()=>[R(V(r.$t("sendToImg2img")),1)]),_:1}),b(l,{key:"send2inpaint"},{default:$(()=>[R(V(r.$t("sendToInpaint")),1)]),_:1}),b(l,{key:"send2extras"},{default:$(()=>[R(V(r.$t("sendToExtraFeatures")),1)]),_:1}),b(p,{key:"sendToThirdPartyExtension",title:r.$t("sendToThirdPartyExtension")},{default:$(()=>[b(l,{key:"send2controlnet-txt2img"},{default:$(()=>[R("ControlNet - "+V(r.$t("t2i")),1)]),_:1}),b(l,{key:"send2controlnet-img2img"},{default:$(()=>[R("ControlNet - "+V(r.$t("i2i")),1)]),_:1}),b(l,{key:"send2outpaint"},{default:$(()=>[R("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):ee("",!0),b(l,{key:"send2BatchDownload"},{default:$(()=>[R(V(r.$t("sendToBatchDownload")),1)]),_:1}),b(l,{key:"send2savedDir"},{default:$(()=>[R(V(r.$t("send2savedDir")),1)]),_:1}),b(d),b(p,{key:"toggle-tag",title:r.$t("toggleTag")},{default:$(()=>[(z(!0),J(ne,null,et(a.value,g=>(z(),q(l,{key:`toggle-tag-${g.id}`},{default:$(()=>[R(V(g.name)+" ",1),g.selected?(z(),q(Z(Si),{key:0})):(z(),q(Z(Ki),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"]),b(l,{key:"openWithLocalFileBrowser"},{default:$(()=>[R(V(r.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):ee("",!0),b(l,{key:"previewInNewWindow"},{default:$(()=>[R(V(r.$t("previewInNewWindow")),1)]),_:1}),b(l,{key:"download"},{default:$(()=>[R(V(r.$t("download")),1)]),_:1}),b(l,{key:"copyPreviewUrl"},{default:$(()=>[R(V(r.$t("copySourceFilePreviewLink")),1)]),_:1})],64)):ee("",!0)]}),_:1})}}}),xa=["data-idx"],Ta={class:"more"},Ba={key:0,class:"tags-container"},Ma={key:3,class:"preview-icon-wrap"},Na={key:4,class:"profile"},$a={class:"name line-clamp-1"},za={class:"basic-info"},Qa=pe({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click"],setup(e,{emit:t}){const n=e;ei(l=>({a0c171a0:l.$props.cellWidth+"px"}));const i=Ze(),a=Vt(),r=H(()=>a.tagMap.get(n.file.fullpath)??[]),f=H(()=>{const l=i.gridThumbnailResolution;return i.enableThumbnail?ti(n.file,[l,l].join("x")):le(n.file)});return(l,d)=>{const p=fe,E=ii,y=bi;return z(),q(p,{trigger:["contextmenu"],visible:Z(i).longPressOpenContextMenu?typeof l.idx=="number"&&l.showMenuIdx===l.idx:void 0,"onUpdate:visible":d[6]||(d[6]=g=>typeof l.idx=="number"&&t("update:showMenuIdx",g?l.idx:-1))},{overlay:$(()=>[l.enableRightClickMenu?(z(),q(_t,{key:0,file:l.file,idx:l.idx,"selected-tag":r.value,onContextMenuClick:d[5]||(d[5]=(g,v,s)=>t("contextMenuClick",g,v,s))},null,8,["file","idx","selected-tag"])):ee("",!0)]),default:$(()=>[(z(),J("li",{class:Be(["file file-item-trigger grid",{clickable:l.file.type==="dir",selected:l.selected}]),"data-idx":l.idx,key:l.file.name,draggable:"true",onDragstart:d[2]||(d[2]=g=>t("dragstart",g,l.idx)),onDragend:d[3]||(d[3]=g=>t("dragend",g,l.idx)),onClickCapture:d[4]||(d[4]=g=>t("fileItemClick",g,l.file,l.idx))},[oe("div",null,[l.enableCloseIcon?(z(),J("div",{key:0,class:"close-icon",onClick:d[0]||(d[0]=g=>t("close-icon-click"))},[b(Z(ni))])):ee("",!0),l.enableRightClickMenu?(z(),q(p,{key:1},{overlay:$(()=>[b(_t,{file:l.file,idx:l.idx,"selected-tag":r.value,onContextMenuClick:d[1]||(d[1]=(g,v,s)=>t("contextMenuClick",g,v,s))},null,8,["file","idx","selected-tag"])]),default:$(()=>[oe("div",Ta,[b(Z(Ot))])]),_:1})):ee("",!0),Z(K)(l.file.name)?(z(),J("div",{style:{position:"relative"},key:l.file.fullpath,class:Be(`idx-${l.idx}`)},[b(E,{src:f.value,fallback:Z(Di),preview:{src:l.fullScreenPreviewImageUrl,onVisibleChange:(g,v)=>t("previewVisibleChange",g,v)}},null,8,["src","fallback","preview"]),r.value&&l.cellWidth>128?(z(),J("div",Ba,[(z(!0),J(ne,null,et(r.value,g=>(z(),q(y,{key:g.id,color:Z(a).getColor(g.name)},{default:$(()=>[R(V(g.name),1)]),_:2},1032,["color"]))),128))])):ee("",!0)],2)):(z(),J("div",Ma,[l.file.type==="file"?(z(),q(Z(_i),{key:0,class:"icon center"})):(z(),q(Z(Ti),{key:1,class:"icon center"}))])),l.cellWidth>128?(z(),J("div",Na,[oe("div",$a,V(l.file.name),1),oe("div",za,[oe("div",null,V(l.file.size),1),oe("div",null,V(l.file.date),1)])])):ee("",!0)])],42,xa))]),_:1},8,["visible"])}}});const qa=ai(Qa,[["__scopeId","data-v-12928e97"]]);export{fe as D,qa as F,_t as _,Ua as a,Ha as b,Ja as c,Wa as d,Va as e,Ka as f,qt as g,Vt as h,He as i,be as j,na as k,Ee as s,ae as u};
