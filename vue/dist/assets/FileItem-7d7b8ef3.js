var Yt=Object.defineProperty;var Zt=(e,t,n)=>t in e?Yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ze=(e,t,n)=>(Zt(e,typeof t!="symbol"?t+"":t,n),n);import{P as xe,c3 as Xt,a as te,d as pe,bq as Pt,u as Ne,c as y,bZ as Ot,_ as en,V as ue,a0 as ye,aj as U,bL as st,a3 as lt,bo as tn,h as ie,c4 as nn,b as an,ay as rn,c5 as sn,a2 as ot,bK as ln,c6 as on,c7 as cn,$ as R,b0 as un,z as ne,aA as dn,a1 as fn,ag as we,c8 as vn,aR as pn,c9 as hn,ca as mn,aM as xt,am as je,bn as Ge,cb as gn,cc as yn,c2 as Ae,cd as bn,ce as wn,R as ce,ai as D,U as An,cf as Ye,x as L,cg as Tt,ch as ct,ci as kn,cj as Sn,ck as Bt,cl as K,k as Ze,ah as Cn,cm as Mt,ar as X,cn as Xe,l as ve,aC as Te,aw as In,ap as Qe,co as En,cp as ut,an as Nt,bQ as dt,bP as _n,cq as Ie,cr as Pn,aD as On,bO as $t,cs as xn,ct as Tn,t as Ve,as as ft,al as he,cu as vt,c1 as Bn,L as le,J as Mn,bX as pt,cv as Nn,bW as $n,cw as zn,cx as Qn,cy as Fn,at as Dn,au as Ln,ax as zt,o as Q,m as q,cz as Rn,cA as jn,cB as Vn,cC as Un,cD as Hn,a5 as Jn,y as J,cE as ke,C as ee,n as z,A as et,cF as ht,bG as Wn,cG as Kn,B as qn,N as Be,v as j,r as Z,W as Gn,cH as Yn,b_ as Zn,M as Xn,cI as ei,cJ as ti,p as oe,ae as ni,cK as ii,X as ai}from"./index-35e9ee40.js";import{h as ri,r as si,a as li,t as oi}from"./db-c6358829.js";import{t as Fe,l as de,C as ci,g as ui}from"./shortcut-9c26d495.js";var Qt=function(){return{arrow:{type:[Boolean,Object],default:void 0},trigger:{type:[Array,String]},overlay:xe.any,visible:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},align:{type:Object},getPopupContainer:Function,prefixCls:String,transitionName:String,placement:String,overlayClassName:String,overlayStyle:{type:Object,default:void 0},forceRender:{type:Boolean,default:void 0},mouseEnterDelay:Number,mouseLeaveDelay:Number,openClassName:String,minOverlayWidthMatchTrigger:{type:Boolean,default:void 0},destroyPopupOnHide:{type:Boolean,default:void 0},onVisibleChange:{type:Function},"onUpdate:visible":{type:Function}}},De=Xt(),di=function(){return te(te({},Qt()),{},{type:De.type,size:String,htmlType:De.htmlType,href:String,disabled:{type:Boolean,default:void 0},prefixCls:String,icon:xe.any,title:String,loading:De.loading,onClick:{type:Function}})},fi=["type","disabled","loading","htmlType","class","overlay","trigger","align","visible","onVisibleChange","placement","href","title","icon","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","onClick","onUpdate:visible"],vi=ue.Group;const Me=pe({compatConfig:{MODE:3},name:"ADropdownButton",inheritAttrs:!1,__ANT_BUTTON:!0,props:Pt(di(),{trigger:"hover",placement:"bottomRight",type:"default"}),slots:["icon","leftButton","rightButton","overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,r=n.emit,f=function(m){r("update:visible",m),r("visibleChange",m)},l=Ne("dropdown-button",t),d=l.prefixCls,p=l.direction,E=l.getPopupContainer;return function(){var g,m,v=te(te({},t),a),s=v.type,o=s===void 0?"default":s,c=v.disabled,b=v.loading,S=v.htmlType,h=v.class,u=h===void 0?"":h,C=v.overlay,A=C===void 0?(g=i.overlay)===null||g===void 0?void 0:g.call(i):C,P=v.trigger,_=v.align,T=v.visible;v.onVisibleChange;var I=v.placement,F=I===void 0?p.value==="rtl"?"bottomLeft":"bottomRight":I,M=v.href,k=v.title,O=v.icon,H=O===void 0?((m=i.icon)===null||m===void 0?void 0:m.call(i))||y(Ot,null,null):O,N=v.mouseEnterDelay,w=v.mouseLeaveDelay,x=v.overlayClassName,$=v.overlayStyle,G=v.destroyPopupOnHide,V=v.onClick;v["onUpdate:visible"];var Y=en(v,fi),W={align:_,disabled:c,trigger:c?[]:P,placement:F,getPopupContainer:E.value,onVisibleChange:f,mouseEnterDelay:N,mouseLeaveDelay:w,visible:T,overlayClassName:x,overlayStyle:$,destroyPopupOnHide:G},re=y(ue,{type:o,disabled:c,loading:b,onClick:V,htmlType:S,href:M,title:k},{default:i.default}),se=y(ue,{type:o,icon:H},null);return y(vi,te(te({},Y),{},{class:ye(d.value,u)}),{default:function(){return[i.leftButton?i.leftButton({button:re}):re,y(fe,W,{default:function(){return[i.rightButton?i.rightButton({button:se}):se]},overlay:function(){return A}})]}})}}});var Ft=pe({compatConfig:{MODE:3},name:"ADropdown",inheritAttrs:!1,props:Pt(Qt(),{mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft",trigger:"hover"}),slots:["overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,r=n.emit,f=Ne("dropdown",t),l=f.prefixCls,d=f.rootPrefixCls,p=f.direction,E=f.getPopupContainer,g=U(function(){var o=t.placement,c=o===void 0?"":o,b=t.transitionName;return b!==void 0?b:c.indexOf("top")>=0?"".concat(d.value,"-slide-down"):"".concat(d.value,"-slide-up")}),m=function(){var c,b,S,h=t.overlay||((c=i.overlay)===null||c===void 0?void 0:c.call(i)),u=Array.isArray(h)?h[0]:h;if(!u)return null;var C=u.props||{};st(!C.mode||C.mode==="vertical","Dropdown",'mode="'.concat(C.mode,`" is not supported for Dropdown's Menu.`));var A=C.selectable,P=A===void 0?!1:A,_=C.expandIcon,T=_===void 0?(b=u.children)===null||b===void 0||(S=b.expandIcon)===null||S===void 0?void 0:S.call(b):_,I=typeof T<"u"&&ot(T)?T:y("span",{class:"".concat(l.value,"-menu-submenu-arrow")},[y(ln,{class:"".concat(l.value,"-menu-submenu-arrow-icon")},null)]),F=ot(u)?lt(u,{mode:"vertical",selectable:P,expandIcon:function(){return I}}):u;return F},v=U(function(){var o=t.placement;if(!o)return p.value==="rtl"?"bottomRight":"bottomLeft";if(o.includes("Center")){var c=o.slice(0,o.indexOf("Center"));return st(!o.includes("Center"),"Dropdown","You are using '".concat(o,"' placement in Dropdown, which is deprecated. Try to use '").concat(c,"' instead.")),c}return o}),s=function(c){r("update:visible",c),r("visibleChange",c)};return function(){var o,c,b=t.arrow,S=t.trigger,h=t.disabled,u=t.overlayClassName,C=(o=i.default)===null||o===void 0?void 0:o.call(i)[0],A=lt(C,tn({class:ye(C==null||(c=C.props)===null||c===void 0?void 0:c.class,ie({},"".concat(l.value,"-rtl"),p.value==="rtl"),"".concat(l.value,"-trigger"))},h?{disabled:h}:{})),P=ye(u,ie({},"".concat(l.value,"-rtl"),p.value==="rtl")),_=h?[]:S,T;_&&_.indexOf("contextmenu")!==-1&&(T=!0);var I=nn({arrowPointAtCenter:an(b)==="object"&&b.pointAtCenter,autoAdjustOverflow:!0}),F=rn(te(te(te({},t),a),{},{builtinPlacements:I,overlayClassName:P,arrow:b,alignPoint:T,prefixCls:l.value,getPopupContainer:E.value,transitionName:g.value,trigger:_,onVisibleChange:s,placement:v.value}),["overlay","onUpdate:visible"]);return y(sn,F,{default:function(){return[A]},overlay:m})}}});Ft.Button=Me;const fe=Ft;var pi=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},hi=pe({compatConfig:{MODE:3},name:"ACheckableTag",props:pi(),setup:function(t,n){var i=n.slots,a=n.emit,r=Ne("tag",t),f=r.prefixCls,l=function(E){var g=t.checked;a("update:checked",!g),a("change",!g),a("click",E)},d=U(function(){var p;return ye(f.value,(p={},ie(p,"".concat(f.value,"-checkable"),!0),ie(p,"".concat(f.value,"-checkable-checked"),t.checked),p))});return function(){var p;return y("span",{class:d.value,onClick:l},[(p=i.default)===null||p===void 0?void 0:p.call(i)])}}});const Ue=hi;var mi=new RegExp("^(".concat(on.join("|"),")(-inverse)?$")),gi=new RegExp("^(".concat(cn.join("|"),")$")),yi=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:xe.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:xe.any}},ge=pe({compatConfig:{MODE:3},name:"ATag",props:yi(),slots:["closeIcon","icon"],setup:function(t,n){var i=n.slots,a=n.emit,r=n.attrs,f=Ne("tag",t),l=f.prefixCls,d=f.direction,p=R(!0);un(function(){t.visible!==void 0&&(p.value=t.visible)});var E=function(s){s.stopPropagation(),a("update:visible",!1),a("close",s),!s.defaultPrevented&&t.visible===void 0&&(p.value=!1)},g=U(function(){var v=t.color;return v?mi.test(v)||gi.test(v):!1}),m=U(function(){var v;return ye(l.value,(v={},ie(v,"".concat(l.value,"-").concat(t.color),g.value),ie(v,"".concat(l.value,"-has-color"),t.color&&!g.value),ie(v,"".concat(l.value,"-hidden"),!p.value),ie(v,"".concat(l.value,"-rtl"),d.value==="rtl"),v))});return function(){var v,s,o,c=t.icon,b=c===void 0?(v=i.icon)===null||v===void 0?void 0:v.call(i):c,S=t.color,h=t.closeIcon,u=h===void 0?(s=i.closeIcon)===null||s===void 0?void 0:s.call(i):h,C=t.closable,A=C===void 0?!1:C,P=function(){return A?u?y("span",{class:"".concat(l.value,"-close-icon"),onClick:E},[u]):y(fn,{class:"".concat(l.value,"-close-icon"),onClick:E},null):null},_={backgroundColor:S&&!g.value?S:void 0},T=b||null,I=(o=i.default)===null||o===void 0?void 0:o.call(i),F=T?y(ne,null,[T,y("span",null,[I])]):I,M="onClick"in r,k=y("span",{class:m.value,style:_},[F,P()]);return M?y(dn,null,{default:function(){return[k]}}):k}}});ge.CheckableTag=Ue;ge.install=function(e){return e.component(ge.name,ge),e.component(Ue.name,Ue),e};const bi=ge;fe.Button=Me;fe.install=function(e){return e.component(fe.name,fe),e.component(Me.name,Me),e};var wi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const Ai=wi;function mt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){ki(e,a,n[a])})}return e}function ki(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tt=function(t,n){var i=mt({},t,n.attrs);return y(we,mt({},i,{icon:Ai}),null)};tt.displayName="StarFilled";tt.inheritAttrs=!1;const Si=tt;var Ci={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const Ii=Ci;function gt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Ei(e,a,n[a])})}return e}function Ei(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(t,n){var i=gt({},t,n.attrs);return y(we,gt({},i,{icon:Ii}),null)};nt.displayName="FileOutlined";nt.inheritAttrs=!1;const _i=nt;var Pi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const Oi=Pi;function yt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){xi(e,a,n[a])})}return e}function xi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var it=function(t,n){var i=yt({},t,n.attrs);return y(we,yt({},i,{icon:Oi}),null)};it.displayName="FolderOpenOutlined";it.inheritAttrs=!1;const Ti=it;function Bi(e,t,n){if(!vn(n))return!1;var i=typeof t;return(i=="number"?pn(n)&&hn(t,n.length):i=="string"&&t in n)?mn(n[t],e):!1}function Mi(e){return e&&e.length?e[0]:void 0}var Ni=Math.ceil,$i=Math.max;function zi(e,t,n,i){for(var a=-1,r=$i(Ni((t-e)/(n||1)),0),f=Array(r);r--;)f[i?r:++a]=e,e+=n;return f}function Qi(e){return function(t,n,i){return i&&typeof i!="number"&&Bi(t,n,i)&&(n=i=void 0),t=Fe(t),n===void 0?(n=t,t=0):n=Fe(n),i=i===void 0?t<n?1:-1:Fe(i),zi(t,n,i,e)}}var Fi=Qi();const Dt=Fi,be=(...e)=>{document.addEventListener(...e),xt(()=>document.removeEventListener(...e))},Di="data:image/png;base64,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",Se=new WeakMap;function Li(e,t){return{useHookShareState:i=>{const a=yn();je(a),Se.has(a)||(Se.set(a,Ge(e(a,i??(t==null?void 0:t())))),xt(()=>{Se.delete(a)}));const r=Se.get(a);return je(r),{state:r,toRefs(){return gn(r)}}}}}var Ri={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const ji=Ri;function bt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Vi(e,a,n[a])})}return e}function Vi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var at=function(t,n){var i=bt({},t,n.attrs);return y(we,bt({},i,{icon:ji}),null)};at.displayName="DatabaseOutlined";at.inheritAttrs=!1;const Ui=at;var Hi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const Ji=Hi;function wt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Wi(e,a,n[a])})}return e}function Wi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rt=function(t,n){var i=wt({},t,n.attrs);return y(we,wt({},i,{icon:Ji}),null)};rt.displayName="StarOutlined";rt.inheritAttrs=!1;const Ki=rt;const me=async e=>(await Ae.value.get("/files",{params:{folder_path:e}})).data,qi=async e=>(await Ae.value.post("/delete_files",{file_paths:e})).data,Lt=async(e,t,n)=>(await Ae.value.post("/move_files",{file_paths:e,dest:t,create_dest_folder:n})).data,Gi=async(e,t,n)=>(await Ae.value.post("/copy_files",{file_paths:e,dest:t,create_dest_folder:n})).data,Yi=async e=>{await Ae.value.post("/mkdirs",{dest_folder:e})};var Rt={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(e,t){(function(n,i){e.exports=i})(bn,function(){var n={};n.version="0.3.5";var i=n.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};n.configure=function(s){var o,c;for(o in s)c=s[o],c!==void 0&&s.hasOwnProperty(o)&&(i[o]=c);return this},n.status=null,n.set=function(s){var o=n.isStarted();s=a(s,i.minimum,1),n.status=s===1?null:s;var c=n.render(!o),b=c.querySelector(i.barSelector),S=i.speed,h=i.easing;return c.offsetWidth,l(function(u){i.positionUsing===""&&(i.positionUsing=n.getPositioningCSS()),d(b,f(s,S,h)),s===1?(d(c,{transition:"none",opacity:1}),c.offsetWidth,setTimeout(function(){d(c,{transition:"all "+S+"ms linear",opacity:0}),setTimeout(function(){n.remove(),u()},S)},S)):setTimeout(u,S)}),this},n.isStarted=function(){return typeof n.status=="number"},n.start=function(){n.status||n.set(0);var s=function(){setTimeout(function(){n.status&&(n.trickle(),s())},i.trickleSpeed)};return i.trickle&&s(),this},n.done=function(s){return!s&&!n.status?this:n.inc(.3+.5*Math.random()).set(1)},n.inc=function(s){var o=n.status;return o?o>1?void 0:(typeof s!="number"&&(o>=0&&o<.2?s=.1:o>=.2&&o<.5?s=.04:o>=.5&&o<.8?s=.02:o>=.8&&o<.99?s=.005:s=0),o=a(o+s,0,.994),n.set(o)):n.start()},n.trickle=function(){return n.inc()},function(){var s=0,o=0;n.promise=function(c){return!c||c.state()==="resolved"?this:(o===0&&n.start(),s++,o++,c.always(function(){o--,o===0?(s=0,n.done()):n.set((s-o)/s)}),this)}}(),n.getElement=function(){var s=n.getParent();if(s){var o=Array.prototype.slice.call(s.querySelectorAll(".nprogress")).filter(function(c){return c.parentElement===s});if(o.length>0)return o[0]}return null},n.getParent=function(){if(i.parent instanceof HTMLElement)return i.parent;if(typeof i.parent=="string")return document.querySelector(i.parent)},n.render=function(s){if(n.isRendered())return n.getElement();E(document.documentElement,"nprogress-busy");var o=document.createElement("div");o.id="nprogress",o.className="nprogress",o.innerHTML=i.template;var c=o.querySelector(i.barSelector),b=s?"-100":r(n.status||0),S=n.getParent(),h;return d(c,{transition:"all 0 linear",transform:"translate3d("+b+"%,0,0)"}),i.showSpinner||(h=o.querySelector(i.spinnerSelector),h&&v(h)),S!=document.body&&E(S,"nprogress-custom-parent"),S.appendChild(o),o},n.remove=function(){n.status=null,g(document.documentElement,"nprogress-busy"),g(n.getParent(),"nprogress-custom-parent");var s=n.getElement();s&&v(s)},n.isRendered=function(){return!!n.getElement()},n.getPositioningCSS=function(){var s=document.body.style,o="WebkitTransform"in s?"Webkit":"MozTransform"in s?"Moz":"msTransform"in s?"ms":"OTransform"in s?"O":"";return o+"Perspective"in s?"translate3d":o+"Transform"in s?"translate":"margin"};function a(s,o,c){return s<o?o:s>c?c:s}function r(s){return(-1+s)*100}function f(s,o,c){var b;return i.positionUsing==="translate3d"?b={transform:"translate3d("+r(s)+"%,0,0)"}:i.positionUsing==="translate"?b={transform:"translate("+r(s)+"%,0)"}:b={"margin-left":r(s)+"%"},b.transition="all "+o+"ms "+c,b}var l=function(){var s=[];function o(){var c=s.shift();c&&c(o)}return function(c){s.push(c),s.length==1&&o()}}(),d=function(){var s=["Webkit","O","Moz","ms"],o={};function c(u){return u.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(C,A){return A.toUpperCase()})}function b(u){var C=document.body.style;if(u in C)return u;for(var A=s.length,P=u.charAt(0).toUpperCase()+u.slice(1),_;A--;)if(_=s[A]+P,_ in C)return _;return u}function S(u){return u=c(u),o[u]||(o[u]=b(u))}function h(u,C,A){C=S(C),u.style[C]=A}return function(u,C){var A=arguments,P,_;if(A.length==2)for(P in C)_=C[P],_!==void 0&&C.hasOwnProperty(P)&&h(u,P,_);else h(u,A[1],A[2])}}();function p(s,o){var c=typeof s=="string"?s:m(s);return c.indexOf(" "+o+" ")>=0}function E(s,o){var c=m(s),b=c+o;p(c,o)||(s.className=b.substring(1))}function g(s,o){var c=m(s),b;p(s,o)&&(b=c.replace(" "+o+" "," "),s.className=b.substring(1,b.length-1))}function m(s){return(" "+(s&&s.className||"")+" ").replace(/\s+/gi," ")}function v(s){s&&s.parentNode&&s.parentNode.removeChild(s)}return n})})(Rt);var Zi=Rt.exports;const Xi=wn(Zi),ea=e=>{const t=R("");return new Promise(n=>{ce.confirm({title:D("inputFolderName"),content:()=>y(An,{value:t.value,"onUpdate:value":i=>t.value=i},null),async onOk(){if(!t.value)return;const i=Ye(e,t.value);await Yi(i),n()}})})},jt=()=>y("p",{style:{background:"var(--zp-secondary-background)",padding:"8px",borderLeft:"4px solid var(--primary-color)"}},[L("Tips: "),D("multiSelectTips")]);function ta(){const e=[];for(let a=0;a<72;a++){const f=`hsl(${a*7.2}, 90%, 35%)`;e.push(f)}return e}const At=ta(),Vt=Tt("useTagStore",()=>{const e=Ge(new Map),t=async r=>{if(r=r.filter(f=>!e.has(f)),!!r.length)try{r.forEach(l=>e.set(l,[]));const f=await ri(r);for(const l in f)e.set(l,f[l])}catch{r.forEach(f=>e.delete(f))}},n=new Map;return{tagMap:e,getColor:r=>{let f=n.get(r);if(!f){const l=ct.hash.sha256.hash(r),d=parseInt(ct.codec.hex.fromBits(l),16)%At.length;f=At[d],n.set(r,f)}return f},fetchImageTags:t,refreshTags:async r=>{r.forEach(f=>e.delete(f)),await t(r)}}}),na=Tt("useBatchDownloadStore",()=>{const e=R([]);return{selectdFiles:e,addFiles:n=>{e.value=kn([...e.value,...n])}}});class kt{constructor(t,n=Sn.CREATED_TIME_DESC){ze(this,"root");ze(this,"execQueue",[]);this.sortMethod=n,this.root={children:[],info:{name:t,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:t}},this.fetchChildren(this.root)}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const t=n=>n.children.map(i=>{if(i.info.type==="dir")return t(i);if(K(i.info.name))return i.info}).filter(i=>i).flat(1);return t(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(t){const{files:n}=await me(t.info.fullpath);return t.children=Bt(n,this.sortMethod).map(i=>({info:i,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...t.children.filter(i=>i.info.type==="dir").map(i=>({fn:()=>this.fetchChildren(i),...i}))),t}async next(){const t=Mi(this.execQueue);if(!t)return null;const n=await t.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},n}}function Le(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$n(e)}const Ee=new Map,B=Ze(),ia=na(),Ut=Vt(),St=Cn(),Ce=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:_e,useEventListen:He}=Mt(),{useHookShareState:ae}=Li((e,{images:t})=>{const n=R({tabIdx:-1,paneIdx:-1}),i=U(()=>de(a.value)),a=R([]),r=U(()=>{var S;return a.value.map(h=>h.curr).slice((S=B.conf)!=null&&S.is_win?1:0)}),f=U(()=>Ye(...r.value)),l=R(B.defaultSortingMethod),d=R(n.value.walkModePath?new kt(n.value.walkModePath,l.value):void 0);ve([()=>n.value.walkModePath,l],()=>{d.value=n.value.walkModePath?new kt(n.value.walkModePath,l.value):void 0});const p=Ge(new Set);ve(i,()=>p.clear());const E=U(()=>{var C;if(t.value)return t.value;if(d.value)return d.value.images.filter(A=>!p.has(A.fullpath));if(!i.value)return[];const S=((C=i.value)==null?void 0:C.files)??[],h=l.value;return Bt((A=>B.onlyFoldersAndImages?A.filter(P=>P.type==="dir"||K(P.name)):A)(S),h).filter(A=>!p.has(A.fullpath))}),g=R([]),m=R(-1),v=U(()=>d.value?!d.value.isCompleted:!1),s=R(!1),o=R(!1),c=()=>{var S,h,u;return(u=(h=(S=B.tabList)==null?void 0:S[n.value.tabIdx])==null?void 0:h.panes)==null?void 0:u[n.value.paneIdx]},b=Mt();return b.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${E.value.length}`),g.value=Dt(0,E.value.length)}),{previewing:o,spinning:s,canLoadNext:v,multiSelectedIdxs:g,previewIdx:m,basePath:r,currLocation:f,currPage:i,stack:a,sortMethod:l,sortedFiles:E,scroller:R(),stackViewEl:R(),props:n,getPane:c,walker:d,deletedFiles:p,...b}},()=>({images:R()}));function Va(){const{previewIdx:e,eventEmitter:t,canLoadNext:n,previewing:i,sortedFiles:a,scroller:r,props:f}=ae().toRefs(),{state:l}=ae();let d=null;const p=(v,s)=>{var o;i.value=v,d!=null&&!v&&s&&((o=r.value)==null||o.scrollToItem(d),d=null)},E=()=>{f.value.walkModePath&&!m("next")&&n&&(X.info(D("loadingNextFolder")),t.value.emit("loadNextDir",!0))};be("keydown",v=>{var s;if(i.value){let o=e.value;if(["ArrowDown","ArrowRight"].includes(v.key))for(o++;a.value[o]&&!K(a.value[o].name);)o++;else if(["ArrowUp","ArrowLeft"].includes(v.key))for(o--;a.value[o]&&!K(a.value[o].name);)o--;if(K((s=a.value[o])==null?void 0:s.name)??""){e.value=o;const c=r.value;c&&!(o>=c.$_startIndex&&o<=c.$_endIndex)&&(d=o)}E()}});const g=v=>{var o;let s=e.value;if(v==="next")for(s++;a.value[s]&&!K(a.value[s].name);)s++;else if(v==="prev")for(s--;a.value[s]&&!K(a.value[s].name);)s--;if(K((o=a.value[s])==null?void 0:o.name)??""){e.value=s;const c=r.value;c&&!(s>=c.$_startIndex&&s<=c.$_endIndex)&&(d=s)}E()},m=v=>{var o;let s=e.value;if(v==="next")for(s++;a.value[s]&&!K(a.value[s].name);)s++;else if(v==="prev")for(s--;a.value[s]&&!K(a.value[s].name);)s--;return K((o=a.value[s])==null?void 0:o.name)??""};return He("removeFiles",async()=>{var v;i.value&&!l.sortedFiles[e.value]&&(X.info(D("manualExitFullScreen"),5),await Xe(500),(v=document.querySelector(".ant-image-preview-operations-operation .anticon-close"))==null||v.click(),e.value=-1)}),{previewIdx:e,onPreviewVisibleChange:p,previewing:i,previewImgMove:g,canPreview:m}}function Ua(){const e=R(),{scroller:t,stackViewEl:n,stack:i,currPage:a,currLocation:r,useEventListen:f,eventEmitter:l,getPane:d,props:p,deletedFiles:E,walker:g,sortedFiles:m}=ae().toRefs();ve(()=>i.value.length,Te((w,x)=>{var $;w!==x&&(($=t.value)==null||$.scrollToItem(0))},300));const v=async w=>{var x;await S(w),p.value.walkModePath&&(await Xe(),await((x=g.value)==null?void 0:x.reset()),l.value.emit("loadNextDir"))};In(async()=>{var w;if(!i.value.length){const x=await me("/");i.value.push({files:x.files,curr:"/"})}e.value=new Xi,e.value.configure({parent:n.value}),p.value.path&&p.value.path!=="/"?await v(p.value.walkModePath??p.value.path):(w=B.conf)!=null&&w.home&&S(B.conf.home)}),ve(r,Te(w=>{const x=d.value();if(!x)return;x.path=w;const $=x.path.split("/").pop(),V=(()=>{var Y;if(!p.value.walkModePath){const W=Ie(w);for(const[re,se]of Object.entries(B.pathAliasMap))if(W.startsWith(se))return W.replace(se,re);return $}return"Walk: "+(((Y=B.quickMovePaths.find(W=>W.dir===x.walkModePath))==null?void 0:Y.zh)??$)})();x.name=Qe("div",{style:"display:flex;align-items:center"},[Qe(Ui),Qe("span",{class:"line-clamp-1",style:"max-width: 256px"},V)]),x.nameFallbackStr=V,B.recent=B.recent.filter(Y=>Y.key!==x.key),B.recent.unshift({path:w,key:x.key}),B.recent.length>20&&(B.recent=B.recent.slice(0,20))},300));const s=()=>Ve(r.value),o=async w=>{var x,$;if(w.type==="dir")try{(x=e.value)==null||x.start();const{files:G}=await me(w.fullpath);i.value.push({files:G,curr:w.name})}finally{($=e.value)==null||$.done()}},c=w=>{for(;w<i.value.length-1;)i.value.pop()},b=(w,x)=>(je(B.conf,"global.conf load failed"),B.conf.is_win?w.toLowerCase()==x.toLowerCase():w==x),S=async w=>{var $,G;const x=i.value.slice();try{En(w)||(w=Ye((($=B.conf)==null?void 0:$.sd_cwd)??"/",w));const V=ut(w),Y=i.value.map(W=>W.curr);for(Y.shift();Y[0]&&V[0]&&b(Y[0],V[0]);)Y.shift(),V.shift();for(let W=0;W<Y.length;W++)i.value.pop();if(!V.length)return h();for(const W of V){const re=(G=a.value)==null?void 0:G.files.find(se=>b(se.name,W));if(!re)throw console.error({frags:V,frag:W,stack:Nt(i.value)}),new Error(`${W} not found`);await o(re)}}catch(V){throw X.error(D("moveFailedCheckPath")+(V instanceof Error?V.message:"")),console.error(w,ut(w),a.value),i.value=x,V}},h=dt(async()=>{var w,x,$;try{if((w=e.value)==null||w.start(),g.value)await g.value.reset(),l.value.emit("loadNextDir");else{const{files:G}=await me(i.value.length===1?"/":r.value);de(i.value).files=G}E.value.clear(),(x=t.value)==null||x.scrollToItem(0),X.success(D("refreshCompleted"))}finally{($=e.value)==null||$.done()}});_n("returnToIIB",dt(async()=>{var w,x;if(!p.value.walkModePath)try{(w=e.value)==null||w.start();const{files:$}=await me(i.value.length===1?"/":r.value);de(i.value).files.map(V=>V.date).join()!==$.map(V=>V.date).join()&&(de(i.value).files=$,X.success(D("autoUpdate")))}finally{(x=e.value)==null||x.done()}})),f.value("refresh",h);const u=w=>{p.value.walkModePath&&(d.value().walkModePath=w),v(w)},C=U(()=>B.quickMovePaths.map(w=>({...w,path:Ie(w.dir)}))),A=U(()=>{const w=Ie(r.value);return C.value.find($=>$.path===w)}),P=async()=>{const w=A.value;if(w){if(!w.can_delete)return;await si(r.value),X.success(D("removeCompleted"))}else await li(r.value),X.success(D("addCompleted"));ft.emit("searchIndexExpired"),ft.emit("updateGlobalSetting")},_=R(!1),T=R(r.value),I=()=>{_.value=!0,T.value=r.value},F=async()=>{await S(T.value),_.value=!1};be("click",()=>{_.value=!1});const M=()=>{const w=parent.location,x=w.href.substring(0,w.href.length-w.search.length),$=new URLSearchParams(w.search);$.set("action","open"),g.value&&$.set("walk","1"),$.set("path",r.value);const G=`${x}?${$.toString()}`;Ve(G,D("copyLocationUrlSuccessMsg"))},k=()=>l.value.emit("selectAll"),O=async()=>{await ea(r.value),await h()},H=()=>{const w=r.value;Ee.set(w,i.value);const x=B.tabList[p.value.tabIdx],$={type:"local",key:he(),path:w,name:D("local"),stackKey:w,walkModePath:w};x.panes.push($),x.key=$.key},N=U(()=>!g.value&&m.value.some(w=>w.type==="dir"));return{locInputValue:T,isLocationEditing:_,onLocEditEnter:F,onEditBtnClick:I,addToSearchScanPathAndQuickMove:P,searchPathInfo:A,refresh:h,copyLocation:s,back:c,openNext:o,currPage:a,currLocation:r,to:S,stack:i,scroller:t,share:M,selectAll:k,quickMoveTo:u,onCreateFloderBtnClick:O,onWalkBtnClick:H,showWalkButton:N}}function Ha(){const{scroller:e,sortedFiles:t,sortMethod:n,currLocation:i,stackViewEl:a,canLoadNext:r,previewIdx:f,props:l,walker:d}=ae().toRefs(),{state:p}=ae(),E=R(!1),g=R(B.defaultGridCellWidth),m=U(()=>g.value+16),v=44,{width:s}=Pn(a),o=U(()=>~~(s.value/m.value)),c=U(()=>{const A=m.value;return{first:A+(g.value<=160?0:v),second:A}}),b=R(!1),S=async()=>{var A;if(!(b.value||!l.value.walkModePath||!r.value))try{b.value=!0,await((A=d.value)==null?void 0:A.next())}finally{b.value=!1}},h=async(A=!1)=>{const P=e.value,_=()=>A?f.value:(P==null?void 0:P.$_endIndex)??0;for(;!t.value.length||_()>t.value.length-20&&r.value;)await Xe(30),await S()};p.useEventListen("loadNextDir",h);const u=()=>{const A=e.value;if(A){const P=t.value.slice(Math.max(A.$_startIndex-10,0),A.$_endIndex+10).filter(_=>_.is_under_scanned_path&&K(_.name)).map(_=>_.fullpath);Ut.fetchImageTags(P)}};ve(i,Te(u,150));const C=Te(()=>{h(),u()},300);return{gridItems:o,sortedFiles:t,sortMethodConv:On,moreActionsDropdownShow:E,gridSize:m,sortMethod:n,onScroll:C,loadNextDir:S,loadNextDirLoading:b,canLoadNext:r,itemSize:c,cellWidth:g,onViewedImagesChange:u}}function Ja(){const{currLocation:e,sortedFiles:t,currPage:n,multiSelectedIdxs:i,eventEmitter:a,walker:r}=ae().toRefs(),f=()=>{i.value=[]};return be("click",f),be("blur",f),ve(n,f),{onFileDragStart:(E,g)=>{const m=Nt(t.value[g]);St.fileDragging=!0,console.log("onFileDragStart set drag file ",E,g,m);const v=[m];let s=m.type==="dir";if(i.value.includes(g)){const c=i.value.map(b=>t.value[b]);v.push(...c),s=c.some(b=>b.type==="dir")}const o={includeDir:s,loc:e.value||"search-result",path:vt(v,"fullpath").map(c=>c.fullpath),nodes:vt(v,"fullpath"),__id:"FileTransferData"};E.dataTransfer.setData("text/plain",JSON.stringify(o))},onDrop:async E=>{if(r.value)return;const g=Bn(E);if(!g)return;const m=e.value;if(g.loc===m)return;const v=$t(),s=async()=>v.pushAction(async()=>{await Gi(g.path,m),a.value.emit("refresh"),ce.destroyAll()}),o=()=>v.pushAction(async()=>{await Lt(g.path,m),_e.emit("removeFiles",{paths:g.path,loc:g.loc}),a.value.emit("refresh"),ce.destroyAll()});ce.confirm({title:D("confirm")+"?",width:"60vw",content:()=>{let c,b,S;return y("div",null,[y("div",null,[`${D("moveSelectedFilesTo")} ${m}`,y("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[g.path.map(h=>y("li",null,[h.split(/[/\\]/).pop()]))])]),y(jt,null,null),y("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},class:"actions"},[y(ue,{onClick:ce.destroyAll},Le(c=D("cancel"))?c:{default:()=>[c]}),y(ue,{type:"primary",loading:!v.isIdle,onClick:s},Le(b=D("copy"))?b:{default:()=>[b]}),y(ue,{type:"primary",loading:!v.isIdle,onClick:o},Le(S=D("move"))?S:{default:()=>[S]})])])},maskClosable:!0,wrapClassName:"hidden-antd-btns-modal"})},multiSelectedIdxs:i,onFileDragEnd:()=>{St.fileDragging=!1}}}function Wa({openNext:e}){const t=R(!1),n=R(""),{sortedFiles:i,previewIdx:a,multiSelectedIdxs:r,stack:f,currLocation:l,spinning:d,previewing:p,stackViewEl:E,eventEmitter:g,props:m,deletedFiles:v}=ae().toRefs(),s=Ie;He("removeFiles",({paths:h,loc:u})=>{s(u)!==s(l.value)||!de(f.value)||(h.forEach(A=>v.value.add(A)),h.filter(K).forEach(A=>v.value.add(A.replace(/\.\w+$/,".txt"))))}),He("addFiles",({files:h,loc:u})=>{if(s(u)!==s(l.value))return;const C=de(f.value);C&&C.files.unshift(...h)});const o=$t(),c=async(h,u,C)=>{a.value=C,B.fullscreenPreviewInitialUrl=le(u);const A=r.value.indexOf(C);if(h.shiftKey){if(A!==-1)r.value.splice(A,1);else{r.value.push(C),r.value.sort((T,I)=>T-I);const P=r.value[0],_=r.value[r.value.length-1];r.value=Dt(P,_+1)}h.stopPropagation()}else h.ctrlKey||h.metaKey?(A!==-1?r.value.splice(A,1):r.value.push(C),h.stopPropagation()):await e(u)},b=async(h,u,C)=>{var I,F,M;const A=le(u),P=l.value,_=()=>{let k=[];return r.value.includes(C)?k=r.value.map(O=>i.value[O]):k.push(u),k},T=async k=>{if(!d.value)try{d.value=!0,await zn(u.fullpath),Ce.postMessage(JSON.stringify({event:"click_hidden_button",btnEleId:"iib_hidden_img_update_trigger"}));const O=setTimeout(()=>Qn.warn({message:D("long_loading"),duration:20}),5e3);await Fn(),clearTimeout(O),Ce.postMessage(JSON.stringify({event:"click_hidden_button",btnEleId:`iib_hidden_tab_${k}`}))}catch(O){console.error(O),X.error("发送图像失败，请携带console的错误消息找开发者")}finally{d.value=!1}};if(`${h.key}`.startsWith("toggle-tag-")){const k=+`${h.key}`.split("toggle-tag-")[1],{is_remove:O}=await oi({tag_id:k,img_path:u.fullpath}),H=(F=(I=B.conf)==null?void 0:I.all_custom_tags.find(N=>N.id===k))==null?void 0:F.name;Ut.refreshTags([u.fullpath]),X.success(D(O?"removedTagFromImage":"addedTagToImage",{tag:H}));return}switch(h.key){case"previewInNewWindow":return window.open(A);case"download":return window.open(le(u,!0));case"copyPreviewUrl":return Ve(parent.document.location.origin+A);case"send2txt2img":return T("txt2img");case"send2img2img":return T("img2img");case"send2inpaint":return T("inpaint");case"send2extras":return T("extras");case"send2savedDir":{const k=B.quickMovePaths.find(N=>N.key==="outdir_save");if(!k)return X.error(D("unknownSavedDir"));const O=Nn(k.dir,(M=B.conf)==null?void 0:M.sd_cwd),H=_();await Lt(H.map(N=>N.fullpath),O,!0),_e.emit("removeFiles",{paths:H.map(N=>N.fullpath),loc:l.value}),_e.emit("addFiles",{files:H,loc:O});break}case"send2controlnet-img2img":case"send2controlnet-txt2img":{const k=h.key.split("-")[1];Ce.postMessage(JSON.stringify({event:"send_to_control_net",type:k,url:le(u)}));break}case"send2outpaint":{n.value=await o.pushAction(()=>pt(u.fullpath)).res;const[k,O]=(n.value||"").split(`
`);Ce.postMessage(JSON.stringify({event:"send_to_outpaint",url:le(u),prompt:k,negPrompt:O.slice(17)}));break}case"openWithWalkMode":{Ee.set(P,f.value);const k=B.tabList[m.value.tabIdx],O={type:"local",key:he(),path:u.fullpath,name:D("local"),stackKey:P,walkModePath:u.fullpath};k.panes.push(O),k.key=O.key;break}case"openInNewTab":{Ee.set(P,f.value);const k=B.tabList[m.value.tabIdx],O={type:"local",key:he(),path:u.fullpath,name:D("local"),stackKey:P};k.panes.push(O),k.key=O.key;break}case"openOnTheRight":{Ee.set(P,f.value);let k=B.tabList[m.value.tabIdx+1];k||(k={panes:[],key:"",id:he()},B.tabList[m.value.tabIdx+1]=k);const O={type:"local",key:he(),path:u.fullpath,name:D("local"),stackKey:P};k.panes.push(O),k.key=O.key;break}case"send2BatchDownload":{ia.addFiles(_());break}case"viewGenInfo":{t.value=!0,n.value=await o.pushAction(()=>pt(u.fullpath)).res;break}case"openWithLocalFileBrowser":{await Mn(u.fullpath);break}case"deleteFiles":{const k=_(),O=async()=>{const H=k.map(N=>N.fullpath);await qi(H),X.success(D("deleteSuccess")),_e.emit("removeFiles",{paths:H,loc:l.value})};if(k.length===1&&B.ignoredConfirmActions.deleteOneOnly)return O();await new Promise(H=>{ce.confirm({title:D("confirmDelete"),maskClosable:!0,width:"60vw",content:()=>y("div",null,[y("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[k.map(N=>y("li",null,[N.fullpath.split(/[/\\]/).pop()]))]),y(jt,null,null),y(ci,{checked:B.ignoredConfirmActions.deleteOneOnly,"onUpdate:checked":N=>B.ignoredConfirmActions.deleteOneOnly=N},{default:()=>[D("deleteOneOnlySkipConfirm"),L(" ("),D("resetOnGlobalSettingsPage"),L(")")]})]),async onOk(){await O(),H()}})});break}}return{}},{isOutside:S}=xn(E);return be("keydown",h=>{var C,A,P;const u=ui(h);if(p.value){const _=(C=Object.entries(B.shortcut).find(T=>T[1]===u&&T[1]))==null?void 0:C[0];if(_){h.stopPropagation(),h.preventDefault();const T=a.value,I=i.value[T];switch(_){case"delete":return le(I)===B.fullscreenPreviewInitialUrl?X.warn(D("fullscreenRestriction")):b({key:"deleteFiles"},I,T);default:{const F=(A=/^toggle_tag_(.*)$/.exec(_))==null?void 0:A[1],M=(P=B.conf)==null?void 0:P.all_custom_tags.find(k=>k.name===F);return M?b({key:`toggle-tag-${M.id}`},I,T):void 0}}}}else!S.value&&["Ctrl + KeyA","Cmd + KeyA"].includes(u)&&(h.preventDefault(),h.stopPropagation(),g.value.emit("selectAll"))}),{onFileItemClick:c,onContextMenuClick:b,showGenInfo:t,imageGenInfo:n,q:o}}const Ka=()=>{const{stackViewEl:e}=ae().toRefs(),t=R(-1);return Tn(e,n=>{var a;let i=n.target;for(;i.parentElement;)if(i=i.parentElement,i.tagName.toLowerCase()==="li"&&i.classList.contains("file-item-trigger")){const r=(a=i.dataset)==null?void 0:a.idx;r&&Number.isSafeInteger(+r)&&(t.value=+r);return}}),{showMenuIdx:t}};function aa(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var a=e.indexOf("Edge/");return a>0?parseInt(e.substring(a+5,e.indexOf(".",a)),10):-1}let Pe;function Je(){Je.init||(Je.init=!0,Pe=aa()!==-1)}var $e={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Je(),zt(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",Pe&&this.$el.appendChild(e),e.data="about:blank",Pe||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Pe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const ra=Rn();Dn("data-v-b329ee4c");const sa={class:"resize-observer",tabindex:"-1"};Ln();const la=ra((e,t,n,i,a,r)=>(Q(),q("div",sa)));$e.render=la;$e.__scopeId="data-v-b329ee4c";$e.__file="src/components/ResizeObserver.vue";function Oe(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Oe=function(t){return typeof t}:Oe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(e)}function oa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ca(e,t,n){return t&&Ct(e.prototype,t),n&&Ct(e,n),e}function It(e){return ua(e)||da(e)||fa(e)||va()}function ua(e){if(Array.isArray(e))return We(e)}function da(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function fa(e,t){if(e){if(typeof e=="string")return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return We(e,t)}}function We(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function va(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pa(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function ha(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,r,f=function(d){for(var p=arguments.length,E=new Array(p>1?p-1:0),g=1;g<p;g++)E[g-1]=arguments[g];if(r=E,!(i&&d===a)){var m=n.leading;typeof m=="function"&&(m=m(d,a)),(!i||d!==a)&&m&&e.apply(void 0,[d].concat(It(r))),a=d,clearTimeout(i),i=setTimeout(function(){e.apply(void 0,[d].concat(It(r))),i=0},t)}};return f._clear=function(){clearTimeout(i),i=null},f}function Ht(e,t){if(e===t)return!0;if(Oe(e)==="object"){for(var n in e)if(!Ht(e[n],t[n]))return!1;return!0}return!1}var ma=function(){function e(t,n,i){oa(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(n,i)}return ca(e,[{key:"createObserver",value:function(n,i){var a=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=pa(n),this.callback=function(l,d){a.options.callback(l,d),l&&a.options.once&&(a.frozen=!0,a.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},f=r.leading;this.callback=ha(this.callback,this.options.throttle,{leading:function(d){return f==="both"||f==="visible"&&d||f==="hidden"&&!d}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(l){var d=l[0];if(l.length>1){var p=l.find(function(g){return g.isIntersecting});p&&(d=p)}if(a.callback){var E=d.isIntersecting&&d.intersectionRatio>=a.threshold;if(E===a.oldResult)return;a.oldResult=E,a.callback(E,d)}},this.options.intersection),zt(function(){a.observer&&a.observer.observe(a.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function Jt(e,t,n){var i=t.value;if(i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var a=new ma(e,i,n);e._vue_visibilityState=a}}function ga(e,t,n){var i=t.value,a=t.oldValue;if(!Ht(i,a)){var r=e._vue_visibilityState;if(!i){Wt(e);return}r?r.createObserver(i,n):Jt(e,{value:i},n)}}function Wt(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var ya={beforeMount:Jt,updated:ga,unmounted:Wt},ba={itemsLimit:1e3},wa=/(auto|scroll)/;function Kt(e,t){return e.parentNode===null?t:Kt(e.parentNode,t.concat([e]))}var Re=function(t,n){return getComputedStyle(t,null).getPropertyValue(n)},Aa=function(t){return Re(t,"overflow")+Re(t,"overflow-y")+Re(t,"overflow-x")},ka=function(t){return wa.test(Aa(t))};function Et(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var t=Kt(e.parentNode,[]),n=0;n<t.length;n+=1)if(ka(t[n]))return t[n];return document.scrollingElement||document.documentElement}}function Ke(e){"@babel/helpers - typeof";return Ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(e)}var Sa={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Ca(){return this.items.length&&Ke(this.items[0])!=="object"}var qe=!1;if(typeof window<"u"){qe=!1;try{var Ia=Object.defineProperty({},"passive",{get:function(){qe=!0}});window.addEventListener("test",null,Ia)}catch{}}let Ea=0;var qt={name:"RecycleScroller",components:{ResizeObserver:$e},directives:{ObserveVisibility:ya},props:{...Sa,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},t=this.items,n=this.sizeField,i=this.minItemSize;let a=1e4,r=0,f;for(let l=0,d=t.length;l<d;l++)f=t[l][n]||i,f<a&&(a=f),r+=f,e[l]={accumulator:r,size:f};return this.$_computedMinItemSize=a,e}return[]},simpleArray:Ca,itemIndexByKey(){const{keyField:e,items:t}=this,n={};for(let i=0,a=t.length;i<a;i++)n[t[i][e]]=i;return n}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,t,n,i,a){const r=jn({id:Ea++,index:t,used:!0,key:i,type:a}),f=Vn({item:n,position:0,nr:r});return e.push(f),f},unuseView(e,t=!1){const n=this.$_unusedViews,i=e.nr.type;let a=n.get(i);a||(a=[],n.set(i,a)),a.push(e),t||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:n}=this.updateVisibleItems(!1,!0);n||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(e,t){this.ready&&(e||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,t=!1){const n=this.itemSize,i=this.gridItems||1,a=this.itemSecondarySize||n,r=this.$_computedMinItemSize,f=this.typeField,l=this.simpleArray?null:this.keyField,d=this.items,p=d.length,E=this.sizes,g=this.$_views,m=this.$_unusedViews,v=this.pool,s=this.itemIndexByKey;let o,c,b,S,h;if(!p)o=c=S=h=b=0;else if(this.$_prerender)o=S=0,c=h=Math.min(this.prerender,d.length),b=null;else{const I=this.getScroll();if(t){let k=I.start-this.$_lastUpdateScrollPosition;if(k<0&&(k=-k),n===null&&k<r||k<n)return{continuous:!0}}this.$_lastUpdateScrollPosition=I.start;const F=this.buffer;I.start-=F,I.end+=F;let M=0;if(this.$refs.before&&(M=this.$refs.before.scrollHeight,I.start-=M),this.$refs.after){const k=this.$refs.after.scrollHeight;I.end+=k}if(n===null){let k,O=0,H=p-1,N=~~(p/2),w;do w=N,k=E[N].accumulator,k<I.start?O=N:N<p-1&&E[N+1].accumulator>I.start&&(H=N),N=~~((O+H)/2);while(N!==w);for(N<0&&(N=0),o=N,b=E[p-1].accumulator,c=N;c<p&&E[c].accumulator<I.end;c++);for(c===-1?c=d.length-1:(c++,c>p&&(c=p)),S=o;S<p&&M+E[S].accumulator<I.start;S++);for(h=S;h<p&&M+E[h].accumulator<I.end;h++);}else{o=~~(I.start/n*i);const k=o%i;o-=k,c=Math.ceil(I.end/n*i),S=Math.max(0,Math.floor((I.start-M)/n*i)),h=Math.floor((I.end-M)/n*i),o<0&&(o=0),c>p&&(c=p),S<0&&(S=0),h>p&&(h=p),b=Math.ceil(p/i)*n}}c-o>ba.itemsLimit&&this.itemsLimitError(),this.totalSize=b;let u;const C=o<=this.$_endIndex&&c>=this.$_startIndex;if(C)for(let I=0,F=v.length;I<F;I++)u=v[I],u.nr.used&&(e&&(u.nr.index=s[u.item[l]]),(u.nr.index==null||u.nr.index<o||u.nr.index>=c)&&this.unuseView(u));const A=C?null:new Map;let P,_,T;for(let I=o;I<c;I++){P=d[I];const F=l?P[l]:P;if(F==null)throw new Error(`Key is ${F} on item (keyField is '${l}')`);if(u=g.get(F),!n&&!E[I].size){u&&this.unuseView(u);continue}_=P[f];let M=m.get(_),k=!1;if(!u)C?M&&M.length?u=M.pop():u=this.addView(v,I,P,F,_):(T=A.get(_)||0,(!M||T>=M.length)&&(u=this.addView(v,I,P,F,_),this.unuseView(u,!0),M=m.get(_)),u=M[T],A.set(_,T+1)),g.delete(u.nr.key),u.nr.used=!0,u.nr.index=I,u.nr.key=F,u.nr.type=_,g.set(F,u),k=!0;else if(!u.nr.used&&(u.nr.used=!0,u.nr.index=I,k=!0,M)){const O=M.indexOf(u);O!==-1&&M.splice(O,1)}u.item=P,k&&(I===d.length-1&&this.$emit("scroll-end"),I===0&&this.$emit("scroll-start")),n===null?(u.position=E[I-1].accumulator,u.offset=0):(u.position=Math.floor(I/i)*n,u.offset=I%i*a)}return this.$_startIndex=o,this.$_endIndex=c,this.emitUpdate&&this.$emit("update",o,c,S,h),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:C}},getListenerTarget(){let e=Et(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:t}=this,n=t==="vertical";let i;if(this.pageMode){const a=e.getBoundingClientRect(),r=n?a.height:a.width;let f=-(n?a.top:a.left),l=n?window.innerHeight:window.innerWidth;f<0&&(l+=f,f=0),f+l>r&&(l=r-f),i={start:f,end:f+l}}else n?i={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:i={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return i},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,qe?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let t;const n=this.gridItems||1;this.itemSize===null?t=e>0?this.sizes[e-1].accumulator:0:t=Math.floor(e/n)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(e){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let n,i,a;if(this.pageMode){const r=Et(this.$el),f=r.tagName==="HTML"?0:r[t.scroll],l=r.getBoundingClientRect(),p=this.$el.getBoundingClientRect()[t.start]-l[t.start];n=r,i=t.scroll,a=e+f+p}else n=this.$el,i=t.scroll,a=e;n[i]=a},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,t)=>e.nr.index-t.nr.index)}}};const _a={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Pa={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Oa(e,t,n,i,a,r){const f=Un("ResizeObserver"),l=Hn("observe-visibility");return Jn((Q(),J("div",{class:Be(["vue-recycle-scroller",{ready:a.ready,"page-mode":n.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...d)=>r.handleScroll&&r.handleScroll(...d))},[e.$slots.before?(Q(),J("div",_a,[ke(e.$slots,"before")],512)):ee("v-if",!0),(Q(),q(ht(n.listTag),{ref:"wrapper",style:qn({[e.direction==="vertical"?"minHeight":"minWidth"]:a.totalSize+"px"}),class:Be(["vue-recycle-scroller__item-wrapper",n.listClass])},{default:z(()=>[(Q(!0),J(ne,null,et(a.pool,d=>(Q(),q(ht(n.itemTag),Wn({key:d.nr.id,style:a.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${d.position}px) translate${e.direction==="vertical"?"X":"Y"}(${d.offset}px)`,width:n.gridItems?`${e.direction==="vertical"&&n.itemSecondarySize||n.itemSize}px`:void 0,height:n.gridItems?`${e.direction==="horizontal"&&n.itemSecondarySize||n.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[n.itemClass,{hover:!n.skipHover&&a.hoverKey===d.nr.key}]]},Kn(n.skipHover?{}:{mouseenter:()=>{a.hoverKey=d.nr.key},mouseleave:()=>{a.hoverKey=null}})),{default:z(()=>[ke(e.$slots,"default",{item:d.item,index:d.nr.index,active:d.nr.used})]),_:2},1040,["style","class"]))),128)),ke(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(Q(),J("div",Pa,[ke(e.$slots,"after")],512)):ee("v-if",!0),y(f,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[l,r.handleVisibilityChange]])}qt.render=Oa;qt.__file="src/components/RecycleScroller.vue";const _t=pe({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},disableDelete:{type:Boolean}},emits:["contextMenuClick"],setup(e,{emit:t}){const n=e,i=Ze(),a=U(()=>{var r;return(((r=i.conf)==null?void 0:r.all_custom_tags)??[]).reduce((f,l)=>[...f,{...l,selected:!!n.selectedTag.find(d=>d.id===l.id)}],[])});return(r,f)=>{const l=Gn,d=Yn,p=Zn,E=Xn;return Q(),q(E,{onClick:f[0]||(f[0]=g=>t("contextMenuClick",g,r.file,r.idx))},{default:z(()=>{var g;return[y(l,{key:"deleteFiles",disabled:r.disableDelete},{default:z(()=>[L(j(r.$t("deleteSelected")),1)]),_:1},8,["disabled"]),r.file.type==="dir"?(Q(),J(ne,{key:0},[y(l,{key:"openInNewTab"},{default:z(()=>[L(j(r.$t("openInNewTab")),1)]),_:1}),y(l,{key:"openOnTheRight"},{default:z(()=>[L(j(r.$t("openOnTheRight")),1)]),_:1}),y(l,{key:"openWithWalkMode"},{default:z(()=>[L(j(r.$t("openWithWalkMode")),1)]),_:1})],64)):ee("",!0),r.file.type==="file"?(Q(),J(ne,{key:1},[Z(K)(r.file.name)?(Q(),J(ne,{key:0},[y(l,{key:"viewGenInfo"},{default:z(()=>[L(j(r.$t("viewGenerationInfo")),1)]),_:1}),y(d),((g=Z(i).conf)==null?void 0:g.launch_mode)!=="server"?(Q(),J(ne,{key:0},[y(l,{key:"send2txt2img"},{default:z(()=>[L(j(r.$t("sendToTxt2img")),1)]),_:1}),y(l,{key:"send2img2img"},{default:z(()=>[L(j(r.$t("sendToImg2img")),1)]),_:1}),y(l,{key:"send2inpaint"},{default:z(()=>[L(j(r.$t("sendToInpaint")),1)]),_:1}),y(l,{key:"send2extras"},{default:z(()=>[L(j(r.$t("sendToExtraFeatures")),1)]),_:1}),y(p,{key:"sendToThirdPartyExtension",title:r.$t("sendToThirdPartyExtension")},{default:z(()=>[y(l,{key:"send2controlnet-txt2img"},{default:z(()=>[L("ControlNet - "+j(r.$t("t2i")),1)]),_:1}),y(l,{key:"send2controlnet-img2img"},{default:z(()=>[L("ControlNet - "+j(r.$t("i2i")),1)]),_:1}),y(l,{key:"send2outpaint"},{default:z(()=>[L("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):ee("",!0),y(l,{key:"send2BatchDownload"},{default:z(()=>[L(j(r.$t("sendToBatchDownload")),1)]),_:1}),y(l,{key:"send2savedDir"},{default:z(()=>[L(j(r.$t("send2savedDir")),1)]),_:1}),y(d),y(p,{key:"toggle-tag",title:r.$t("toggleTag")},{default:z(()=>[(Q(!0),J(ne,null,et(a.value,m=>(Q(),q(l,{key:`toggle-tag-${m.id}`},{default:z(()=>[L(j(m.name)+" ",1),m.selected?(Q(),q(Z(Si),{key:0})):(Q(),q(Z(Ki),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"]),y(l,{key:"openWithLocalFileBrowser"},{default:z(()=>[L(j(r.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):ee("",!0),y(l,{key:"previewInNewWindow"},{default:z(()=>[L(j(r.$t("previewInNewWindow")),1)]),_:1}),y(l,{key:"download"},{default:z(()=>[L(j(r.$t("download")),1)]),_:1}),y(l,{key:"copyPreviewUrl"},{default:z(()=>[L(j(r.$t("copySourceFilePreviewLink")),1)]),_:1})],64)):ee("",!0)]}),_:1})}}}),xa=["data-idx"],Ta={class:"more"},Ba={key:0,class:"tags-container"},Ma={key:3,class:"preview-icon-wrap"},Na={key:4,class:"profile"},$a={class:"name line-clamp-1"},za={class:"basic-info"},Qa=pe({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click"],setup(e,{emit:t}){const n=e;ei(l=>({aaf8adf2:l.$props.cellWidth+"px"}));const i=Ze(),a=Vt(),r=U(()=>a.tagMap.get(n.file.fullpath)??[]),f=U(()=>{const l=i.gridThumbnailResolution;return i.enableThumbnail?ti(n.file,[l,l].join("x")):le(n.file)});return(l,d)=>{const p=fe,E=ii,g=bi;return Q(),q(p,{trigger:["contextmenu"],visible:Z(i).longPressOpenContextMenu?typeof l.idx=="number"&&l.showMenuIdx===l.idx:void 0,"onUpdate:visible":d[6]||(d[6]=m=>typeof l.idx=="number"&&t("update:showMenuIdx",m?l.idx:-1))},{overlay:z(()=>[l.enableRightClickMenu?(Q(),q(_t,{key:0,file:l.file,idx:l.idx,"selected-tag":r.value,onContextMenuClick:d[5]||(d[5]=(m,v,s)=>t("contextMenuClick",m,v,s))},null,8,["file","idx","selected-tag"])):ee("",!0)]),default:z(()=>[(Q(),J("li",{class:Be(["file file-item-trigger grid",{clickable:l.file.type==="dir",selected:l.selected}]),"data-idx":l.idx,key:l.file.name,draggable:"true",onDragstart:d[2]||(d[2]=m=>t("dragstart",m,l.idx)),onDragend:d[3]||(d[3]=m=>t("dragend",m,l.idx)),onClickCapture:d[4]||(d[4]=m=>t("fileItemClick",m,l.file,l.idx))},[oe("div",null,[l.enableCloseIcon?(Q(),J("div",{key:0,class:"close-icon",onClick:d[0]||(d[0]=m=>t("close-icon-click"))},[y(Z(ni))])):ee("",!0),l.enableRightClickMenu?(Q(),q(p,{key:1},{overlay:z(()=>[y(_t,{file:l.file,idx:l.idx,"selected-tag":r.value,onContextMenuClick:d[1]||(d[1]=(m,v,s)=>t("contextMenuClick",m,v,s))},null,8,["file","idx","selected-tag"])]),default:z(()=>[oe("div",Ta,[y(Z(Ot))])]),_:1})):ee("",!0),Z(K)(l.file.name)?(Q(),J("div",{style:{position:"relative"},key:l.file.fullpath,class:Be(`idx-${l.idx}`)},[y(E,{src:f.value,fallback:Z(Di),preview:{src:l.fullScreenPreviewImageUrl,onVisibleChange:(m,v)=>t("previewVisibleChange",m,v)}},null,8,["src","fallback","preview"]),r.value&&l.cellWidth>128?(Q(),J("div",Ba,[(Q(!0),J(ne,null,et(r.value,m=>(Q(),q(g,{key:m.id,color:Z(a).getColor(m.name)},{default:z(()=>[L(j(m.name),1)]),_:2},1032,["color"]))),128))])):ee("",!0)],2)):(Q(),J("div",Ma,[l.file.type==="file"?(Q(),q(Z(_i),{key:0,class:"icon center"})):(Q(),q(Z(Ti),{key:1,class:"icon center"}))])),l.cellWidth>128?(Q(),J("div",Na,[oe("div",$a,j(l.file.name),1),oe("div",za,[oe("div",null,j(l.file.size),1),oe("div",null,j(l.file.date),1)])])):ee("",!0)])],42,xa))]),_:1},8,["visible"])}}});const qa=ai(Qa,[["__scopeId","data-v-eb7b4ec8"]]);export{fe as D,qa as F,_t as _,Ua as a,Ha as b,Ja as c,Wa as d,Va as e,Ka as f,qt as g,Vt as h,He as i,be as j,na as k,Ee as s,ae as u};
