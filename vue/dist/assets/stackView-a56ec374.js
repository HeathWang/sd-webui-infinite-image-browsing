import{d as te,u as Ie,g as Y,_ as Le,c as a,a as ke,P as ce,D as be,f as Oe,w as st,b as it,e as ut,h as De,M as _e,i as dt,j as ct,F as Ce,o as f,k as M,l as u,m as G,t as p,n as ye,p as T,q as Ue,r as pt,s as Ee,v as ze,x as ft,y as mt,z as j,A as s,B as e,C as c,E as Q,G as vt,H as gt,I as je,J as kt,K as bt,L as _t,S as Ct,N as yt,O as ht,Q as Te,R as It,T as wt,U as St,V as At,W as $t,X as Pt}from"./index-6c2db580.js";import{S as Z,s as Mt,M as Rt,L as Ft,R as xt,f as Bt}from"./MultiSelectKeep-c0b6db92.js";import{F as V,N as Nt,_ as Dt,a as Et}from"./numInput-6988723f.js";import"./index-14a9dcde.js";import{D as Ge}from"./index-3270d12b.js";/* empty css              *//* empty css              */import{u as zt,a as jt,b as Tt,c as Vt,d as Lt,e as Ot,f as Ut,g as Gt,s as Kt,h as Wt,F as qt}from"./FileItem-11045013.js";import"./functionalCallableComp-07e627f1.js";var Qt=["class","style"],Ht=function(){return{prefixCls:String,href:String,separator:ce.any,overlay:ce.any,onClick:Function}};const ee=te({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Ht(),slots:["separator","overlay"],setup:function(o,g){var k=g.slots,_=g.attrs,$=Ie("breadcrumb",o),C=$.prefixCls,R=function(P,m){var i=Y(k,o,"overlay");return i?a(Ge,{overlay:i,placement:"bottom"},{default:function(){return[a("span",{class:"".concat(m,"-overlay-link")},[P,a(be,null,null)])]}}):P};return function(){var F,P=(F=Y(k,o,"separator"))!==null&&F!==void 0?F:"/",m=Y(k,o),i=_.class,y=_.style,v=Le(_,Qt),h;return o.href!==void 0?h=a("a",ke({class:"".concat(C.value,"-link"),onClick:o.onClick},v),[m]):h=a("span",ke({class:"".concat(C.value,"-link"),onClick:o.onClick},v),[m]),h=R(h,C.value),m?a("span",{class:i,style:y},[h,P&&a("span",{class:"".concat(C.value,"-separator")},[P])]):null}}});var Jt=function(){return{prefixCls:String,routes:{type:Array},params:ce.any,separator:ce.any,itemRender:{type:Function}}};function Xt(r,o){if(!r.breadcrumbName)return null;var g=Object.keys(o).join("|"),k=r.breadcrumbName.replace(new RegExp(":(".concat(g,")"),"g"),function(_,$){return o[$]||_});return k}function Ve(r){var o=r.route,g=r.params,k=r.routes,_=r.paths,$=k.indexOf(o)===k.length-1,C=Xt(o,g);return $?a("span",null,[C]):a("a",{href:"#/".concat(_.join("/"))},[C])}const H=te({compatConfig:{MODE:3},name:"ABreadcrumb",props:Jt(),slots:["separator","itemRender"],setup:function(o,g){var k=g.slots,_=Ie("breadcrumb",o),$=_.prefixCls,C=_.direction,R=function(i,y){return i=(i||"").replace(/^\//,""),Object.keys(y).forEach(function(v){i=i.replace(":".concat(v),y[v])}),i},F=function(i,y,v){var h=dt(i),I=R(y||"",v);return I&&h.push(I),h},P=function(i){var y=i.routes,v=y===void 0?[]:y,h=i.params,I=h===void 0?{}:h,L=i.separator,x=i.itemRender,B=x===void 0?Ve:x,O=[];return v.map(function(w){var N=R(w.path,I);N&&O.push(N);var J=[].concat(O),X=null;return w.children&&w.children.length&&(X=a(_e,null,{default:function(){return[w.children.map(function(K){return a(_e.Item,{key:K.path||K.breadcrumbName},{default:function(){return[B({route:K,params:I,routes:v,paths:F(J,K.path,I)})]}})})]}})),a(ee,{overlay:X,separator:L,key:N||w.breadcrumbName},{default:function(){return[B({route:w,params:I,routes:v,paths:J})]}})})};return function(){var m,i,y,v=o.routes,h=o.params,I=h===void 0?{}:h,L=Oe(Y(k,o)),x=(m=Y(k,o,"separator"))!==null&&m!==void 0?m:"/",B=o.itemRender||k.itemRender||Ve;v&&v.length>0?y=P({routes:v,params:I,separator:x,itemRender:B}):L.length&&(y=L.map(function(w,N){return st(it(w.type)==="object"&&(w.type.__ANT_BREADCRUMB_ITEM||w.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),ut(w,{separator:x,key:N})}));var O=(i={},De(i,$.value,!0),De(i,"".concat($.value,"-rtl"),C.value==="rtl"),i);return a("div",{class:O},[y])}}});var Yt=["separator","class"],Zt=function(){return{prefixCls:String}};const he=te({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Zt(),setup:function(o,g){var k=g.slots,_=g.attrs,$=Ie("breadcrumb",o),C=$.prefixCls;return function(){var R;_.separator;var F=_.class,P=Le(_,Yt),m=Oe((R=k.default)===null||R===void 0?void 0:R.call(k));return a("span",ke({class:["".concat(C.value,"-separator"),F]},P),[m.length>0?m:"/"])}}});H.Item=ee;H.Separator=he;H.install=function(r){return r.component(H.name,H),r.component(ee.name,ee),r.component(he.name,he),r};V.useInjectFormItemContext=ct;V.ItemRest=Ce;V.install=function(r){return r.component(V.name,V),r.component(V.Item.name,V.Item),r.component(Ce.name,Ce),r};Z.setDefaultIndicator=Mt;Z.install=function(r){return r.component(Z.name,Z),r};const en={class:"base-info"},tn=te({__name:"BaseFileListInfo",props:{fileNum:{},selectedFileNum:{}},setup(r){return(o,g)=>(f(),M("div",en,[u("span",null,[G(p(o.$t("items",[o.fileNum]))+" ",1),o.selectedFileNum?(f(),M(ye,{key:0},[G(", "+p(o.$t("selectedItems",[o.selectedFileNum])),1)],64)):T("",!0)])]))}});const nn=Ue(tn,[["__scopeId","data-v-7f9c0b15"]]),an={class:"hint"},on={class:"location-bar"},ln=["onClick"],rn={key:3,class:"location-act"},sn={class:"actions"},un=["onClick"],dn={style:{width:"512px",background:"var(--zp-primary-background)",padding:"16px","border-radius":"4px","box-shadow":"0 0 4px var(--zp-secondary-background)",border:"1px solid var(--zp-secondary-background)"}},cn={style:{padding:"4px"}},pn={style:{padding:"4px"}},fn={key:0,class:"view"},mn={style:{padding:"16px 0 512px"}},vn={key:0,class:"preview-switch"},gn=te({__name:"stackView",props:{tabIdx:{},paneIdx:{},path:{},walkModePath:{},stackKey:{}},setup(r){const o=r,g=pt(),{scroller:k,stackViewEl:_,props:$,multiSelectedIdxs:C,spinning:R}=zt().toRefs(),{currPage:F,refresh:P,copyLocation:m,back:i,openNext:y,stack:v,quickMoveTo:h,addToSearchScanPathAndQuickMove:I,searchPathInfo:L,locInputValue:x,isLocationEditing:B,onLocEditEnter:O,onEditBtnClick:w,share:N,selectAll:J,onCreateFloderBtnClick:X,onWalkBtnClick:ne,showWalkButton:K,searchInCurrentDir:pe}=jt(),{gridItems:Ke,sortMethodConv:We,moreActionsDropdownShow:fe,sortedFiles:d,sortMethod:me,itemSize:we,loadNextDir:qe,loadNextDirLoading:Qe,canLoadNext:He,onScroll:Je,cellWidth:ae}=Tt(),{onDrop:Xe,onFileDragStart:Ye,onFileDragEnd:Ze}=Vt(),{onFileItemClick:et,onContextMenuClick:Se,showGenInfo:oe,imageGenInfo:Ae,q:$e}=Lt({openNext:y}),{previewIdx:le,onPreviewVisibleChange:tt,previewing:Pe,previewImgMove:Me,canPreview:Re}=Ot(),{showMenuIdx:ve}=Ut(),{onClearAllSelected:nt,onReverseSelect:at,onSelectAll:ot}=Gt();Ee(()=>o,()=>{$.value=o;const l=Kt.get(o.stackKey??"");l&&(v.value=l.slice())},{immediate:!0}),Ee(d,async(l,t)=>{l.length>0&&l.length!==t.length&&Fe()});const re=ze(g.defaultChangeIndchecked),ge=ze(g.defaultSeedChangeChecked);function Fe(){let l=[];const t=[".png",".jpg",".jpeg"];for(let S in d.value)d.value[S].type=="file"&&t.includes(d.value[S].fullpath.slice(-4).toLowerCase())&&l.push(d.value[S].fullpath);$e.pushAction(()=>ft(l)).res.then(S=>{for(let D in d.value)d.value[D].gen_info_raw=S[d.value[D].fullpath],d.value[D].gen_info_obj=mt(S[d.value[D].fullpath])})}function xe(l,t,S,D){let A={diff:{},empty:!0,ownFile:"",otherFile:""};if(t+S<0||t+S>=d.value.length||d.value[t]==null||!("gen_info_obj"in d.value[t])||!("gen_info_obj"in d.value[t+S]))return A;let U=l,E=d.value[t+S].gen_info_obj;if(E==null)return A;let se=["hashes","resources"];A.diff={},A.ownFile=D.name,A.otherFile=d.value[t+S].name,A.empty=!1,ge.value||se.push("seed");for(let b in U)if(!se.includes(b)){if(!(b in E)){A.diff[b]="+";continue}if(U[b]!=E[b])if(b.includes("rompt")&&U[b]!=""&&E[b]!=""){let W=U[b].split(","),ie=E[b].split(","),q=0;for(let ue in W)W[ue]!=ie[ue]&&q++;A.diff[b]=q}else A.diff[b]=[U[b],E[b]]}return A}return(l,t)=>{const S=It,D=wt,A=St,U=At,E=ee,se=H,b=$t,W=Pt,ie=_e,q=Ge,ue=Nt,de=Dt,Be=Et,lt=V,rt=Z;return f(),j(rt,{spinning:e(R),size:"large"},{default:s(()=>[a(Rt,{show:e(g).keepMultiSelect||!!e(C).length,onClearAllSelected:e(nt),onSelectAll:e(ot),onReverseSelect:e(at)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),a(S,{style:{display:"none"}}),u("div",{ref_key:"stackViewEl",ref:_,onDragover:t[29]||(t[29]=c(()=>{},["prevent"])),onDrop:t[30]||(t[30]=c(n=>e(Xe)(n),["prevent"])),class:"container"},[a(A,{visible:e(oe),"onUpdate:visible":t[1]||(t[1]=n=>Q(oe)?oe.value=n:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=n=>oe.value=!1)},{cancelText:s(()=>[]),default:s(()=>[a(D,{active:"",loading:!e($e).isIdle},{default:s(()=>[u("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto","z-index":"9999"},onDblclick:t[0]||(t[0]=n=>e(vt)(e(Ae)))},[u("div",an,p(l.$t("doubleClickToCopy")),1),G(" "+p(e(Ae)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),u("div",on,[u("div",{class:"breadcrumb",style:gt({flex:e(B)?1:""})},[e(B)?(f(),j(U,{key:0,style:{flex:"1"},value:e(x),"onUpdate:value":t[3]||(t[3]=n=>Q(x)?x.value=n:null),onClick:t[4]||(t[4]=c(()=>{},["stop"])),onKeydown:t[5]||(t[5]=c(()=>{},["stop"])),onPressEnter:e(O),"allow-clear":""},null,8,["value","onPressEnter"])):(f(),j(se,{key:1,style:{flex:"1"}},{default:s(()=>[(f(!0),M(ye,null,je(e(v),(n,z)=>(f(),j(E,{key:z},{default:s(()=>[u("a",{onClick:c(Ne=>e(i)(z),["prevent"])},p(n.curr==="/"?l.$t("root"):n.curr.replace(/:\/$/,l.$t("drive"))),9,ln)]),_:2},1024))),128))]),_:1})),e(B)?(f(),j(b,{key:2,size:"small",onClick:e(O),type:"primary"},{default:s(()=>[G(p(l.$t("go")),1)]),_:1},8,["onClick"])):(f(),M("div",rn,[u("a",{onClick:t[6]||(t[6]=c((...n)=>e(m)&&e(m)(...n),["prevent"])),class:"copy"},p(l.$t("copy")),1),u("a",{onClick:t[7]||(t[7]=c((...n)=>e(w)&&e(w)(...n),["prevent","stop"]))},p(l.$t("edit")),1)]))],4),u("div",sn,[u("a",{class:"opt",onClick:t[8]||(t[8]=c((...n)=>e(P)&&e(P)(...n),["prevent"]))},p(l.$t("refresh")),1),a(q,null,{overlay:s(()=>[a(ie,null,{default:s(()=>[a(W,{key:"tag-search"},{default:s(()=>[u("a",{onClick:t[10]||(t[10]=c(n=>e(pe)("tag-search"),["prevent"]))},p(l.$t("imgSearch")),1)]),_:1}),a(W,{key:"tag-search"},{default:s(()=>[u("a",{onClick:t[11]||(t[11]=c(n=>e(pe)("fuzzy-search"),["prevent"]))},p(l.$t("fuzzy-search")),1)]),_:1})]),_:1})]),default:s(()=>[u("a",{class:"opt",onClick:t[9]||(t[9]=c(()=>{},["prevent"]))},[G(p(l.$t("search"))+" ",1),a(e(be))])]),_:1}),e(K)?(f(),M("a",{key:0,class:"opt",onClick:t[12]||(t[12]=c((...n)=>e(ne)&&e(ne)(...n),["prevent"]))}," Walk ")):T("",!0),u("a",{class:"opt",onClick:t[13]||(t[13]=c((...n)=>e(J)&&e(J)(...n),["prevent","stop"]))},p(l.$t("selectAll")),1),e(kt)?T("",!0):(f(),M("a",{key:1,class:"opt",onClick:t[14]||(t[14]=c((...n)=>e(N)&&e(N)(...n),["prevent"]))},p(l.$t("share")),1)),a(q,null,{overlay:s(()=>[a(ie,null,{default:s(()=>[(f(!0),M(ye,null,je(e(g).quickMovePaths,n=>(f(),j(W,{key:n.dir},{default:s(()=>[u("a",{onClick:c(z=>e(h)(n.dir),["prevent"])},p(n.zh),9,un)]),_:2},1024))),128))]),_:1})]),default:s(()=>[u("a",{class:"opt",onClick:t[15]||(t[15]=c(()=>{},["prevent"]))},[G(p(l.$t("quickMove"))+" ",1),a(e(be))])]),_:1}),a(q,{trigger:["click"],visible:e(fe),"onUpdate:visible":t[25]||(t[25]=n=>Q(fe)?fe.value=n:null),placement:"bottomLeft",getPopupContainer:n=>n.parentNode},{overlay:s(()=>[u("div",dn,[a(lt,bt(_t({labelCol:{span:10},wrapperCol:{span:14}})),{default:s(()=>[a(de,{label:l.$t("gridCellWidth")},{default:s(()=>[a(ue,{modelValue:e(ae),"onUpdate:modelValue":t[17]||(t[17]=n=>Q(ae)?ae.value=n:null),max:1024,min:64,step:64},null,8,["modelValue"])]),_:1},8,["label"]),a(de,{label:l.$t("sortingMethod")},{default:s(()=>[a(e(Ct),{value:e(me),"onUpdate:value":t[18]||(t[18]=n=>Q(me)?me.value=n:null),onClick:t[19]||(t[19]=c(()=>{},["stop"])),conv:e(We),options:e(yt)},null,8,["value","conv","options"])]),_:1},8,["label"]),a(de,{label:l.$t("showChangeIndicators")},{default:s(()=>[a(Be,{checked:re.value,"onUpdate:checked":t[20]||(t[20]=n=>re.value=n),onClick:Fe},null,8,["checked"])]),_:1},8,["label"]),a(de,{label:l.$t("seedAsChange")},{default:s(()=>[a(Be,{checked:ge.value,"onUpdate:checked":t[21]||(t[21]=n=>ge.value=n),disabled:!re.value},null,8,["checked","disabled"])]),_:1},8,["label"]),u("div",cn,[e(L)?e(L).can_delete?(f(),M("a",{key:1,onClick:t[23]||(t[23]=c((...n)=>e(I)&&e(I)(...n),["prevent"]))},p(l.$t("removeFromSearchScanPathAndQuickMove")),1)):T("",!0):(f(),M("a",{key:0,onClick:t[22]||(t[22]=c((...n)=>e(I)&&e(I)(...n),["prevent"]))},p(l.$t("addToSearchScanPathAndQuickMove")),1))]),u("div",pn,[u("a",{onClick:t[24]||(t[24]=c((...n)=>e(X)&&e(X)(...n),["prevent"]))},p(l.$t("createFolder")),1)])]),_:1},16)])]),default:s(()=>[u("a",{class:"opt",onClick:t[16]||(t[16]=c(()=>{},["prevent"]))},p(l.$t("more")),1)]),_:1},8,["visible","getPopupContainer"])])]),e(F)?(f(),M("div",fn,[a(e(Wt),{class:"file-list",items:e(d),ref_key:"scroller",ref:k,onScroll:e(Je),"item-size":e(we).first,"key-field":"fullpath","item-secondary-size":e(we).second,gridItems:e(Ke)},{default:s(({item:n,index:z})=>[a(qt,{idx:parseInt(z),file:n,"full-screen-preview-image-url":e(d)[e(le)]?e(ht)(e(d)[e(le)]):"","show-menu-idx":e(ve),"onUpdate:showMenuIdx":t[26]||(t[26]=Ne=>Q(ve)?ve.value=Ne:null),selected:e(C).includes(z),"cell-width":e(ae),onFileItemClick:e(et),onDragstart:e(Ye),onDragend:e(Ze),onPreviewVisibleChange:e(tt),onContextMenuClick:e(Se),"is-selected-mutil-files":e(C).length>1,"gen-diff-to-next":xe(n.gen_info_obj,z,1,n),"gen-diff-to-previous":xe(n.gen_info_obj,z,-1,n),"enable-change-indicator":re.value},null,8,["idx","file","full-screen-preview-image-url","show-menu-idx","selected","cell-width","onFileItemClick","onDragstart","onDragend","onPreviewVisibleChange","onContextMenuClick","is-selected-mutil-files","gen-diff-to-next","gen-diff-to-previous","enable-change-indicator"])]),after:s(()=>[u("div",mn,[o.walkModePath?(f(),j(b,{key:0,onClick:e(qe),loading:e(Qe),block:"",type:"primary",disabled:!e(He),ghost:""},{default:s(()=>[G(p(l.$t("loadNextPage")),1)]),_:1},8,["onClick","loading","disabled"])):T("",!0)])]),_:1},8,["items","onScroll","item-size","item-secondary-size","gridItems"]),e(Pe)?(f(),M("div",vn,[a(e(Ft),{onClick:t[27]||(t[27]=n=>e(Me)("prev")),class:Te({disable:!e(Re)("prev")})},null,8,["class"]),a(e(xt),{onClick:t[28]||(t[28]=n=>e(Me)("next")),class:Te({disable:!e(Re)("next")})},null,8,["class"])])):T("",!0)])):T("",!0)],544),e(Pe)?(f(),j(Bt,{key:0,file:e(d)[e(le)],idx:e(le),onContextMenuClick:e(Se)},null,8,["file","idx","onContextMenuClick"])):T("",!0),a(nn,{"file-num":e(d).length,"selected-file-num":e(C).length},null,8,["file-num","selected-file-num"])]),_:1},8,["spinning"])}}});const An=Ue(gn,[["__scopeId","data-v-6b1da6ce"]]);export{An as default};
