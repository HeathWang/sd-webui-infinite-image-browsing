var cn=Object.defineProperty;var un=(e,n,t)=>n in e?cn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Qe=(e,n,t)=>(un(e,typeof n!="symbol"?n+"":n,t),t);import{P as Me,c6 as dn,a as ie,d as ge,bq as Bt,u as Ne,c as A,c0 as Ft,_ as fn,V as ve,a0 as ke,ao as U,bL as ct,a3 as ut,bo as vn,h as re,c7 as pn,b as hn,ay as mn,c8 as gn,a2 as dt,bK as yn,c9 as bn,ca as wn,$ as V,b0 as An,z as ee,aA as kn,a1 as Sn,ag as se,cb as Cn,aR as In,cc as En,cd as _n,aM as Nt,ar as $e,bn as Ze,ce as On,cf as Pn,cg as xn,ch as Tn,ci as zt,cj as ft,ck as Mn,cl as $n,cm as Qt,cn as Dt,k as Xe,an as Bn,co as Lt,al as te,ai as j,cp as et,l as me,aC as Be,aw as Fn,aj as De,cq as Nn,cr as jt,cs as vt,as as Rt,bQ as pt,bP as zn,ct as _e,cu as Qn,aD as Dn,cv as X,bO as Ht,cw as Ln,cx as jn,t as Ve,am as ht,aq as de,cy as mt,c4 as Rn,R as be,L as ce,x as D,J as Hn,b_ as gt,cz as Vn,cA as Un,bZ as Wn,cB as Jn,cC as Kn,at as qn,au as Gn,ax as Vt,o as O,m as H,cD as Yn,cE as Zn,cF as Xn,cG as ei,cH as ti,a5 as ni,y as R,cI as Ce,C as Z,n as B,A as ue,cJ as yt,bG as ii,cK as ai,B as ri,N as fe,v as L,r as J,W as Ut,cL as li,c1 as si,M as Wt,cM as oi,cN as ci,p as ae,ae as ui,cO as di,cP as fi,X as vi}from"./index-7014c21f.js";import{t as Le,a as we,l as pe,b as pi,M as Jt,C as hi,m as Kt,g as mi,c as gi,d as yi,e as bi}from"./functionalCallableComp-c44a8b16.js";import{h as wi,r as Ai,a as ki,t as Si,i as Ci}from"./db-a31c442b.js";var qt=function(){return{arrow:{type:[Boolean,Object],default:void 0},trigger:{type:[Array,String]},overlay:Me.any,visible:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},align:{type:Object},getPopupContainer:Function,prefixCls:String,transitionName:String,placement:String,overlayClassName:String,overlayStyle:{type:Object,default:void 0},forceRender:{type:Boolean,default:void 0},mouseEnterDelay:Number,mouseLeaveDelay:Number,openClassName:String,minOverlayWidthMatchTrigger:{type:Boolean,default:void 0},destroyPopupOnHide:{type:Boolean,default:void 0},onVisibleChange:{type:Function},"onUpdate:visible":{type:Function}}},je=dn(),Ii=function(){return ie(ie({},qt()),{},{type:je.type,size:String,htmlType:je.htmlType,href:String,disabled:{type:Boolean,default:void 0},prefixCls:String,icon:Me.any,title:String,loading:je.loading,onClick:{type:Function}})},Ei=["type","disabled","loading","htmlType","class","overlay","trigger","align","visible","onVisibleChange","placement","href","title","icon","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","onClick","onUpdate:visible"],_i=ve.Group;const Fe=ge({compatConfig:{MODE:3},name:"ADropdownButton",inheritAttrs:!1,__ANT_BUTTON:!0,props:Bt(Ii(),{trigger:"hover",placement:"bottomRight",type:"default"}),slots:["icon","leftButton","rightButton","overlay"],setup:function(n,t){var i=t.slots,a=t.attrs,r=t.emit,v=function(k){r("update:visible",k),r("visibleChange",k)},c=Ne("dropdown-button",n),h=c.prefixCls,y=c.direction,d=c.getPopupContainer;return function(){var m,k,p=ie(ie({},n),a),l=p.type,s=l===void 0?"default":l,o=p.disabled,f=p.loading,w=p.htmlType,b=p.class,u=b===void 0?"":b,C=p.overlay,_=C===void 0?(m=i.overlay)===null||m===void 0?void 0:m.call(i):C,I=p.trigger,E=p.align,P=p.visible;p.onVisibleChange;var S=p.placement,$=S===void 0?y.value==="rtl"?"bottomLeft":"bottomRight":S,z=p.href,Q=p.title,G=p.icon,M=G===void 0?((k=i.icon)===null||k===void 0?void 0:k.call(i))||A(Ft,null,null):G,x=p.mouseEnterDelay,W=p.mouseLeaveDelay,g=p.overlayClassName,T=p.overlayStyle,F=p.destroyPopupOnHide,Y=p.onClick;p["onUpdate:visible"];var K=fn(p,Ei),ne={align:E,disabled:o,trigger:o?[]:I,placement:$,getPopupContainer:d.value,onVisibleChange:v,mouseEnterDelay:x,mouseLeaveDelay:W,visible:P,overlayClassName:g,overlayStyle:T,destroyPopupOnHide:F},q=A(ve,{type:s,disabled:o,loading:f,onClick:Y,htmlType:w,href:z,title:Q},{default:i.default}),oe=A(ve,{type:s,icon:M},null);return A(_i,ie(ie({},K),{},{class:ke(h.value,u)}),{default:function(){return[i.leftButton?i.leftButton({button:q}):q,A(he,ne,{default:function(){return[i.rightButton?i.rightButton({button:oe}):oe]},overlay:function(){return _}})]}})}}});var Gt=ge({compatConfig:{MODE:3},name:"ADropdown",inheritAttrs:!1,props:Bt(qt(),{mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft",trigger:"hover"}),slots:["overlay"],setup:function(n,t){var i=t.slots,a=t.attrs,r=t.emit,v=Ne("dropdown",n),c=v.prefixCls,h=v.rootPrefixCls,y=v.direction,d=v.getPopupContainer,m=U(function(){var s=n.placement,o=s===void 0?"":s,f=n.transitionName;return f!==void 0?f:o.indexOf("top")>=0?"".concat(h.value,"-slide-down"):"".concat(h.value,"-slide-up")}),k=function(){var o,f,w,b=n.overlay||((o=i.overlay)===null||o===void 0?void 0:o.call(i)),u=Array.isArray(b)?b[0]:b;if(!u)return null;var C=u.props||{};ct(!C.mode||C.mode==="vertical","Dropdown",'mode="'.concat(C.mode,`" is not supported for Dropdown's Menu.`));var _=C.selectable,I=_===void 0?!1:_,E=C.expandIcon,P=E===void 0?(f=u.children)===null||f===void 0||(w=f.expandIcon)===null||w===void 0?void 0:w.call(f):E,S=typeof P<"u"&&dt(P)?P:A("span",{class:"".concat(c.value,"-menu-submenu-arrow")},[A(yn,{class:"".concat(c.value,"-menu-submenu-arrow-icon")},null)]),$=dt(u)?ut(u,{mode:"vertical",selectable:I,expandIcon:function(){return S}}):u;return $},p=U(function(){var s=n.placement;if(!s)return y.value==="rtl"?"bottomRight":"bottomLeft";if(s.includes("Center")){var o=s.slice(0,s.indexOf("Center"));return ct(!s.includes("Center"),"Dropdown","You are using '".concat(s,"' placement in Dropdown, which is deprecated. Try to use '").concat(o,"' instead.")),o}return s}),l=function(o){r("update:visible",o),r("visibleChange",o)};return function(){var s,o,f=n.arrow,w=n.trigger,b=n.disabled,u=n.overlayClassName,C=(s=i.default)===null||s===void 0?void 0:s.call(i)[0],_=ut(C,vn({class:ke(C==null||(o=C.props)===null||o===void 0?void 0:o.class,re({},"".concat(c.value,"-rtl"),y.value==="rtl"),"".concat(c.value,"-trigger"))},b?{disabled:b}:{})),I=ke(u,re({},"".concat(c.value,"-rtl"),y.value==="rtl")),E=b?[]:w,P;E&&E.indexOf("contextmenu")!==-1&&(P=!0);var S=pn({arrowPointAtCenter:hn(f)==="object"&&f.pointAtCenter,autoAdjustOverflow:!0}),$=mn(ie(ie(ie({},n),a),{},{builtinPlacements:S,overlayClassName:I,arrow:f,alignPoint:P,prefixCls:c.value,getPopupContainer:d.value,transitionName:m.value,trigger:E,onVisibleChange:l,placement:p.value}),["overlay","onUpdate:visible"]);return A(gn,$,{default:function(){return[_]},overlay:k})}}});Gt.Button=Fe;const he=Gt;var Oi=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},Pi=ge({compatConfig:{MODE:3},name:"ACheckableTag",props:Oi(),setup:function(n,t){var i=t.slots,a=t.emit,r=Ne("tag",n),v=r.prefixCls,c=function(d){var m=n.checked;a("update:checked",!m),a("change",!m),a("click",d)},h=U(function(){var y;return ke(v.value,(y={},re(y,"".concat(v.value,"-checkable"),!0),re(y,"".concat(v.value,"-checkable-checked"),n.checked),y))});return function(){var y;return A("span",{class:h.value,onClick:c},[(y=i.default)===null||y===void 0?void 0:y.call(i)])}}});const Ue=Pi;var xi=new RegExp("^(".concat(bn.join("|"),")(-inverse)?$")),Ti=new RegExp("^(".concat(wn.join("|"),")$")),Mi=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:Me.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:Me.any}},Ae=ge({compatConfig:{MODE:3},name:"ATag",props:Mi(),slots:["closeIcon","icon"],setup:function(n,t){var i=t.slots,a=t.emit,r=t.attrs,v=Ne("tag",n),c=v.prefixCls,h=v.direction,y=V(!0);An(function(){n.visible!==void 0&&(y.value=n.visible)});var d=function(l){l.stopPropagation(),a("update:visible",!1),a("close",l),!l.defaultPrevented&&n.visible===void 0&&(y.value=!1)},m=U(function(){var p=n.color;return p?xi.test(p)||Ti.test(p):!1}),k=U(function(){var p;return ke(c.value,(p={},re(p,"".concat(c.value,"-").concat(n.color),m.value),re(p,"".concat(c.value,"-has-color"),n.color&&!m.value),re(p,"".concat(c.value,"-hidden"),!y.value),re(p,"".concat(c.value,"-rtl"),h.value==="rtl"),p))});return function(){var p,l,s,o=n.icon,f=o===void 0?(p=i.icon)===null||p===void 0?void 0:p.call(i):o,w=n.color,b=n.closeIcon,u=b===void 0?(l=i.closeIcon)===null||l===void 0?void 0:l.call(i):b,C=n.closable,_=C===void 0?!1:C,I=function(){return _?u?A("span",{class:"".concat(c.value,"-close-icon"),onClick:d},[u]):A(Sn,{class:"".concat(c.value,"-close-icon"),onClick:d},null):null},E={backgroundColor:w&&!m.value?w:void 0},P=f||null,S=(s=i.default)===null||s===void 0?void 0:s.call(i),$=P?A(ee,null,[P,A("span",null,[S])]):S,z="onClick"in r,Q=A("span",{class:k.value,style:E},[$,I()]);return z?A(kn,null,{default:function(){return[Q]}}):Q}}});Ae.CheckableTag=Ue;Ae.install=function(e){return e.component(Ae.name,Ae),e.component(Ue.name,Ue),e};const $i=Ae;he.Button=Fe;he.install=function(e){return e.component(he.name,he),e.component(Fe.name,Fe),e};var Bi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const Fi=Bi;function bt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){Ni(e,a,t[a])})}return e}function Ni(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var tt=function(n,t){var i=bt({},n,t.attrs);return A(se,bt({},i,{icon:Fi}),null)};tt.displayName="StarFilled";tt.inheritAttrs=!1;const Yt=tt;var zi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const Qi=zi;function wt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){Di(e,a,t[a])})}return e}function Di(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var nt=function(n,t){var i=wt({},n,t.attrs);return A(se,wt({},i,{icon:Qi}),null)};nt.displayName="FileOutlined";nt.inheritAttrs=!1;const Li=nt;var ji={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const Ri=ji;function At(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){Hi(e,a,t[a])})}return e}function Hi(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var it=function(n,t){var i=At({},n,t.attrs);return A(se,At({},i,{icon:Ri}),null)};it.displayName="FolderOpenOutlined";it.inheritAttrs=!1;const Vi=it;function Ui(e,n,t){if(!Cn(t))return!1;var i=typeof n;return(i=="number"?In(t)&&En(n,t.length):i=="string"&&n in t)?_n(t[n],e):!1}function Wi(e){return e&&e.length?e[0]:void 0}var Ji=Math.ceil,Ki=Math.max;function qi(e,n,t,i){for(var a=-1,r=Ki(Ji((n-e)/(t||1)),0),v=Array(r);r--;)v[i?r:++a]=e,e+=t;return v}function Gi(e){return function(n,t,i){return i&&typeof i!="number"&&Ui(n,t,i)&&(t=i=void 0),n=Le(n),t===void 0?(t=n,n=0):t=Le(t),i=i===void 0?n<t?1:-1:Le(i),qi(n,t,i,e)}}var Yi=Gi();const Zt=Yi,Se=(...e)=>{document.addEventListener(...e),Nt(()=>document.removeEventListener(...e))},Zi="data:image/png;base64,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",Ie=new WeakMap;function Xi(e,n){return{useHookShareState:i=>{const a=Pn();$e(a),Ie.has(a)||(Ie.set(a,Ze(e(a,i??(n==null?void 0:n())))),Nt(()=>{Ie.delete(a)}));const r=Ie.get(a);return $e(r),{state:r,toRefs(){return On(r)}}}}}var ea={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const ta=ea;function kt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){na(e,a,t[a])})}return e}function na(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var at=function(n,t){var i=kt({},n,t.attrs);return A(se,kt({},i,{icon:ta}),null)};at.displayName="DatabaseOutlined";at.inheritAttrs=!1;const ia=at;var aa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9z"}}]},name:"heart",theme:"filled"};const ra=aa;function St(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){la(e,a,t[a])})}return e}function la(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var rt=function(n,t){var i=St({},n,t.attrs);return A(se,St({},i,{icon:ra}),null)};rt.displayName="HeartFilled";rt.inheritAttrs=!1;const sa=rt;var oa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"}}]},name:"heart",theme:"outlined"};const ca=oa;function Ct(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){ua(e,a,t[a])})}return e}function ua(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var lt=function(n,t){var i=Ct({},n,t.attrs);return A(se,Ct({},i,{icon:ca}),null)};lt.displayName="HeartOutlined";lt.inheritAttrs=!1;const da=lt;var fa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"};const va=fa;function It(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){pa(e,a,t[a])})}return e}function pa(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var st=function(n,t){var i=It({},n,t.attrs);return A(se,It({},i,{icon:va}),null)};st.displayName="PlayCircleFilled";st.inheritAttrs=!1;const ha=st;var ma={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const ga=ma;function Et(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){ya(e,a,t[a])})}return e}function ya(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var ot=function(n,t){var i=Et({},n,t.attrs);return A(se,Et({},i,{icon:ga}),null)};ot.displayName="StarOutlined";ot.inheritAttrs=!1;const Xt=ot;var en={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(e,n){(function(t,i){e.exports=i})(xn,function(){var t={};t.version="0.3.5";var i=t.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};t.configure=function(l){var s,o;for(s in l)o=l[s],o!==void 0&&l.hasOwnProperty(s)&&(i[s]=o);return this},t.status=null,t.set=function(l){var s=t.isStarted();l=a(l,i.minimum,1),t.status=l===1?null:l;var o=t.render(!s),f=o.querySelector(i.barSelector),w=i.speed,b=i.easing;return o.offsetWidth,c(function(u){i.positionUsing===""&&(i.positionUsing=t.getPositioningCSS()),h(f,v(l,w,b)),l===1?(h(o,{transition:"none",opacity:1}),o.offsetWidth,setTimeout(function(){h(o,{transition:"all "+w+"ms linear",opacity:0}),setTimeout(function(){t.remove(),u()},w)},w)):setTimeout(u,w)}),this},t.isStarted=function(){return typeof t.status=="number"},t.start=function(){t.status||t.set(0);var l=function(){setTimeout(function(){t.status&&(t.trickle(),l())},i.trickleSpeed)};return i.trickle&&l(),this},t.done=function(l){return!l&&!t.status?this:t.inc(.3+.5*Math.random()).set(1)},t.inc=function(l){var s=t.status;return s?s>1?void 0:(typeof l!="number"&&(s>=0&&s<.2?l=.1:s>=.2&&s<.5?l=.04:s>=.5&&s<.8?l=.02:s>=.8&&s<.99?l=.005:l=0),s=a(s+l,0,.994),t.set(s)):t.start()},t.trickle=function(){return t.inc()},function(){var l=0,s=0;t.promise=function(o){return!o||o.state()==="resolved"?this:(s===0&&t.start(),l++,s++,o.always(function(){s--,s===0?(l=0,t.done()):t.set((l-s)/l)}),this)}}(),t.getElement=function(){var l=t.getParent();if(l){var s=Array.prototype.slice.call(l.querySelectorAll(".nprogress")).filter(function(o){return o.parentElement===l});if(s.length>0)return s[0]}return null},t.getParent=function(){if(i.parent instanceof HTMLElement)return i.parent;if(typeof i.parent=="string")return document.querySelector(i.parent)},t.render=function(l){if(t.isRendered())return t.getElement();d(document.documentElement,"nprogress-busy");var s=document.createElement("div");s.id="nprogress",s.className="nprogress",s.innerHTML=i.template;var o=s.querySelector(i.barSelector),f=l?"-100":r(t.status||0),w=t.getParent(),b;return h(o,{transition:"all 0 linear",transform:"translate3d("+f+"%,0,0)"}),i.showSpinner||(b=s.querySelector(i.spinnerSelector),b&&p(b)),w!=document.body&&d(w,"nprogress-custom-parent"),w.appendChild(s),s},t.remove=function(){t.status=null,m(document.documentElement,"nprogress-busy"),m(t.getParent(),"nprogress-custom-parent");var l=t.getElement();l&&p(l)},t.isRendered=function(){return!!t.getElement()},t.getPositioningCSS=function(){var l=document.body.style,s="WebkitTransform"in l?"Webkit":"MozTransform"in l?"Moz":"msTransform"in l?"ms":"OTransform"in l?"O":"";return s+"Perspective"in l?"translate3d":s+"Transform"in l?"translate":"margin"};function a(l,s,o){return l<s?s:l>o?o:l}function r(l){return(-1+l)*100}function v(l,s,o){var f;return i.positionUsing==="translate3d"?f={transform:"translate3d("+r(l)+"%,0,0)"}:i.positionUsing==="translate"?f={transform:"translate("+r(l)+"%,0)"}:f={"margin-left":r(l)+"%"},f.transition="all "+s+"ms "+o,f}var c=function(){var l=[];function s(){var o=l.shift();o&&o(s)}return function(o){l.push(o),l.length==1&&s()}}(),h=function(){var l=["Webkit","O","Moz","ms"],s={};function o(u){return u.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(C,_){return _.toUpperCase()})}function f(u){var C=document.body.style;if(u in C)return u;for(var _=l.length,I=u.charAt(0).toUpperCase()+u.slice(1),E;_--;)if(E=l[_]+I,E in C)return E;return u}function w(u){return u=o(u),s[u]||(s[u]=f(u))}function b(u,C,_){C=w(C),u.style[C]=_}return function(u,C){var _=arguments,I,E;if(_.length==2)for(I in C)E=C[I],E!==void 0&&C.hasOwnProperty(I)&&b(u,I,E);else b(u,_[1],_[2])}}();function y(l,s){var o=typeof l=="string"?l:k(l);return o.indexOf(" "+s+" ")>=0}function d(l,s){var o=k(l),f=o+s;y(o,s)||(l.className=f.substring(1))}function m(l,s){var o=k(l),f;y(l,s)&&(f=o.replace(" "+s+" "," "),l.className=f.substring(1,f.length-1))}function k(l){return(" "+(l&&l.className||"")+" ").replace(/\s+/gi," ")}function p(l){l&&l.parentNode&&l.parentNode.removeChild(l)}return t})})(en);var ba=en.exports;const wa=Tn(ba);function Aa(){const e=[];for(let a=0;a<72;a++){const v=`hsl(${a*7.2}, 90%, 35%)`;e.push(v)}return e}const _t=Aa(),tn=zt("useTagStore",()=>{const e=Ze(new Map),n=async r=>{if(r=r.filter(v=>!e.has(v)),!!r.length)try{r.forEach(c=>e.set(c,[]));const v=await wi(r);for(const c in v)e.set(c,v[c])}catch{r.forEach(v=>e.delete(v))}},t=new Map;return{tagMap:e,getColor:r=>{let v=t.get(r);if(!v){const c=ft.hash.sha256.hash(r),h=parseInt(ft.codec.hex.fromBits(c),16)%_t.length;v=_t[h],t.set(r,v)}return v},fetchImageTags:n,refreshTags:async r=>{r.forEach(v=>e.delete(v)),await n(r)}}}),ka=zt("useBatchDownloadStore",()=>{const e=V([]);return{selectdFiles:e,addFiles:t=>{e.value=Mn([...e.value,...t])}}});class Ot{constructor(n,t=$n.CREATED_TIME_DESC){Qe(this,"root");Qe(this,"execQueue",[]);this.sortMethod=t,this.root={children:[],info:{name:n,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:n}},this.fetchChildren(this.root)}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const n=t=>t.children.map(i=>{if(i.info.type==="dir")return n(i);if(Dt(i.info.name))return i.info}).filter(i=>i).flat(1);return n(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(n){const{files:t}=await we(n.info.fullpath);return n.children=Qt(t,this.sortMethod).map(i=>({info:i,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...n.children.filter(i=>i.info.type==="dir").map(i=>({fn:()=>this.fetchChildren(i),...i}))),n}async next(){const n=Wi(this.execQueue);if(!n)return null;const t=await n.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},t}}function Re(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Wn(e)}const Oe=new Map,N=Xe(),Sa=ka(),We=tn(),Pt=Bn(),Ee=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:Pe,useEventListen:Je}=Lt(),{useHookShareState:le}=Xi((e,{images:n})=>{const t=V({tabIdx:-1,paneIdx:-1}),i=U(()=>pe(a.value)),a=V([]),r=U(()=>{var w;return a.value.map(b=>b.curr).slice((w=N.conf)!=null&&w.is_win?1:0)}),v=U(()=>jt(...r.value)),c=V(N.defaultSortingMethod),h=V(t.value.walkModePath?new Ot(t.value.walkModePath,c.value):void 0);me([()=>t.value.walkModePath,c],()=>{h.value=t.value.walkModePath?new Ot(t.value.walkModePath,c.value):void 0});const y=Ze(new Set);me(i,()=>y.clear());const d=U(()=>{var C;if(n.value)return n.value;if(h.value)return h.value.images.filter(_=>!y.has(_.fullpath));if(!i.value)return[];const w=((C=i.value)==null?void 0:C.files)??[],b=c.value;return Qt((_=>N.onlyFoldersAndImages?_.filter(I=>I.type==="dir"||Dt(I.name)):_)(w),b).filter(_=>!y.has(_.fullpath))}),m=V([]),k=V(-1),p=U(()=>h.value?!h.value.isCompleted:!1),l=V(!1),s=V(!1),o=()=>{var w,b,u;return(u=(b=(w=N.tabList)==null?void 0:w[t.value.tabIdx])==null?void 0:b.panes)==null?void 0:u[t.value.paneIdx]},f=Lt();return f.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${d.value.length}`),m.value=Zt(0,d.value.length)}),{previewing:s,spinning:l,canLoadNext:p,multiSelectedIdxs:m,previewIdx:k,basePath:r,currLocation:v,currPage:i,stack:a,sortMethod:c,sortedFiles:d,scroller:V(),stackViewEl:V(),props:t,getPane:o,walker:h,deletedFiles:y,...f}},()=>({images:V()}));function dr(){const{previewIdx:e,eventEmitter:n,canLoadNext:t,previewing:i,sortedFiles:a,scroller:r,props:v}=le().toRefs(),{state:c}=le();let h=null;const y=(p,l)=>{var s;i.value=p,h!=null&&!p&&l&&((s=r.value)==null||s.scrollToItem(h),h=null)},d=()=>{v.value.walkModePath&&!k("next")&&t&&(te.info(j("loadingNextFolder")),n.value.emit("loadNextDir",!0))};Se("keydown",p=>{var l;if(i.value){let s=e.value;if(["ArrowDown","ArrowRight"].includes(p.key))for(s++;a.value[s]&&!X(a.value[s].name);)s++;else if(["ArrowUp","ArrowLeft"].includes(p.key))for(s--;a.value[s]&&!X(a.value[s].name);)s--;if(X((l=a.value[s])==null?void 0:l.name)??""){e.value=s;const o=r.value;o&&!(s>=o.$_startIndex&&s<=o.$_endIndex)&&(h=s)}d()}});const m=p=>{var s;let l=e.value;if(p==="next")for(l++;a.value[l]&&!X(a.value[l].name);)l++;else if(p==="prev")for(l--;a.value[l]&&!X(a.value[l].name);)l--;if(X((s=a.value[l])==null?void 0:s.name)??""){e.value=l;const o=r.value;o&&!(l>=o.$_startIndex&&l<=o.$_endIndex)&&(h=l)}d()},k=p=>{var s;let l=e.value;if(p==="next")for(l++;a.value[l]&&!X(a.value[l].name);)l++;else if(p==="prev")for(l--;a.value[l]&&!X(a.value[l].name);)l--;return X((s=a.value[l])==null?void 0:s.name)??""};return Je("removeFiles",async()=>{var p;i.value&&!c.sortedFiles[e.value]&&(te.info(j("manualExitFullScreen"),5),await et(500),(p=document.querySelector(".ant-image-preview-operations-operation .anticon-close"))==null||p.click(),e.value=-1)}),{previewIdx:e,onPreviewVisibleChange:y,previewing:i,previewImgMove:m,canPreview:k}}function fr(){const e=V(),{scroller:n,stackViewEl:t,stack:i,currPage:a,currLocation:r,useEventListen:v,eventEmitter:c,getPane:h,props:y,deletedFiles:d,walker:m,sortedFiles:k}=le().toRefs();me(()=>i.value.length,Be((g,T)=>{var F;g!==T&&((F=n.value)==null||F.scrollToItem(0))},300));const p=async g=>{var T;await w(g),y.value.walkModePath&&(await et(),await((T=m.value)==null?void 0:T.reset()),c.value.emit("loadNextDir"))};Fn(async()=>{var g;if(!i.value.length){const T=await we("/");i.value.push({files:T.files,curr:"/"})}e.value=new wa,e.value.configure({parent:t.value}),y.value.path&&y.value.path!=="/"?await p(y.value.walkModePath??y.value.path):(g=N.conf)!=null&&g.home&&w(N.conf.home)}),me(r,Be(g=>{const T=h.value();if(!T)return;T.path=g;const F=T.path.split("/").pop(),K=(()=>{var ne;if(!y.value.walkModePath){const q=_e(g);for(const[oe,ye]of Object.entries(N.pathAliasMap))if(q.startsWith(ye))return q.replace(ye,oe);return F}return"Walk: "+(((ne=N.quickMovePaths.find(q=>q.dir===T.walkModePath))==null?void 0:ne.zh)??F)})();T.name=De("div",{style:"display:flex;align-items:center"},[De(ia),De("span",{class:"line-clamp-1",style:"max-width: 256px"},K)]),T.nameFallbackStr=K,N.recent=N.recent.filter(ne=>ne.key!==T.key),N.recent.unshift({path:g,key:T.key}),N.recent.length>20&&(N.recent=N.recent.slice(0,20))},300));const l=()=>Ve(r.value),s=async g=>{var T,F;if(g.type==="dir")try{(T=e.value)==null||T.start();const{files:Y}=await we(g.fullpath);i.value.push({files:Y,curr:g.name})}finally{(F=e.value)==null||F.done()}},o=g=>{for(;g<i.value.length-1;)i.value.pop()},f=(g,T)=>($e(N.conf,"global.conf load failed"),N.conf.is_win?g.toLowerCase()==T.toLowerCase():g==T),w=async g=>{var F,Y;const T=i.value.slice();try{Nn(g)||(g=jt(((F=N.conf)==null?void 0:F.sd_cwd)??"/",g));const K=vt(g),ne=i.value.map(q=>q.curr);for(ne.shift();ne[0]&&K[0]&&f(ne[0],K[0]);)ne.shift(),K.shift();for(let q=0;q<ne.length;q++)i.value.pop();if(!K.length)return b();for(const q of K){const oe=(Y=a.value)==null?void 0:Y.files.find(ye=>f(ye.name,q));if(!oe)throw console.error({frags:K,frag:q,stack:Rt(i.value)}),new Error(`${q} not found`);await s(oe)}}catch(K){throw te.error(j("moveFailedCheckPath")+(K instanceof Error?K.message:"")),console.error(g,vt(g),a.value),i.value=T,K}},b=pt(async()=>{var g,T,F;try{if((g=e.value)==null||g.start(),m.value)await m.value.reset(),c.value.emit("loadNextDir");else{const{files:Y}=await we(i.value.length===1?"/":r.value);pe(i.value).files=Y}d.value.clear(),(T=n.value)==null||T.scrollToItem(0),te.success(j("refreshCompleted"))}finally{(F=e.value)==null||F.done()}});zn("returnToIIB",pt(async()=>{var g,T;if(!y.value.walkModePath)try{(g=e.value)==null||g.start();const{files:F}=await we(i.value.length===1?"/":r.value);pe(i.value).files.map(K=>K.date).join()!==F.map(K=>K.date).join()&&(pe(i.value).files=F,te.success(j("autoUpdate")))}finally{(T=e.value)==null||T.done()}})),v.value("refresh",b);const u=g=>{y.value.walkModePath&&(h.value().walkModePath=g),p(g)},C=U(()=>N.quickMovePaths.map(g=>({...g,path:_e(g.dir)}))),_=U(()=>{const g=_e(r.value);return C.value.find(F=>F.path===g)}),I=async()=>{const g=_.value;if(g){if(!g.can_delete)return;await Ai({path:r.value,type:"scanned"}),te.success(j("removeCompleted"))}else await ki({path:r.value,type:"scanned"}),te.success(j("addCompleted"));ht.emit("searchIndexExpired"),ht.emit("updateGlobalSetting")},E=V(!1),P=V(r.value),S=()=>{E.value=!0,P.value=r.value},$=async()=>{await w(P.value),E.value=!1};Se("click",g=>{var T,F,Y;(Y=(F=(T=g.target)==null?void 0:T.className)==null?void 0:F.includes)!=null&&Y.call(F,"ant-input")||(E.value=!1)});const z=()=>{const g=parent.location,T=g.href.substring(0,g.href.length-g.search.length),F=new URLSearchParams(g.search);F.set("action","open"),m.value&&F.set("walk","1"),F.set("path",r.value);const Y=`${T}?${F.toString()}`;Ve(Y,j("copyLocationUrlSuccessMsg"))},Q=(g="tag-search")=>{const T=N.tabList[y.value.tabIdx],F={type:g,key:de(),searchScope:r.value,name:j(g==="tag-search"?"imgSearch":"fuzzy-search")};T.panes.push(F),T.key=F.key},G=()=>c.value.emit("selectAll"),M=async()=>{await pi(r.value),await b()},x=()=>{const g=r.value;Oe.set(g,i.value);const T=N.tabList[y.value.tabIdx],F={type:"local",key:de(),path:g,name:j("local"),stackKey:g,walkModePath:g};T.panes.push(F),T.key=F.key},W=U(()=>!m.value&&k.value.some(g=>g.type==="dir"));return{locInputValue:P,isLocationEditing:E,onLocEditEnter:$,onEditBtnClick:S,addToSearchScanPathAndQuickMove:I,searchPathInfo:_,refresh:b,copyLocation:l,back:o,openNext:s,currPage:a,currLocation:r,to:w,stack:i,scroller:n,share:z,selectAll:G,quickMoveTo:u,onCreateFloderBtnClick:M,onWalkBtnClick:x,showWalkButton:W,searchInCurrentDir:Q}}function vr({fetchNext:e}={}){const{scroller:n,sortedFiles:t,sortMethod:i,currLocation:a,stackViewEl:r,canLoadNext:v,previewIdx:c,props:h,walker:y}=le().toRefs(),{state:d}=le(),m=V(!1),k=V(N.defaultGridCellWidth),p=U(()=>k.value+16),l=44,{width:s}=Qn(r),o=U(()=>~~(s.value/p.value)),f=U(()=>{const I=p.value;return{first:I+(k.value<=160?0:l),second:I}}),w=V(!1),b=async()=>{var I;if(!(w.value||!h.value.walkModePath||!v.value))try{w.value=!0,await((I=y.value)==null?void 0:I.next())}finally{w.value=!1}},u=async(I=!1)=>{const E=n.value,P=()=>I?c.value:(E==null?void 0:E.$_endIndex)??0,S=()=>{const $=t.value.length,z=50;return $?e?P()>$-z:P()>$-z&&v.value:!0};for(;S();){await et(30);const $=await(e??b)();if(typeof $=="boolean"&&!$)return}};d.useEventListen("loadNextDir",u);const C=()=>{const I=n.value;if(I){const E=t.value.slice(Math.max(I.$_startIndex-10,0),I.$_endIndex+10).filter(P=>P.is_under_scanned_path&&X(P.name)).map(P=>P.fullpath);We.fetchImageTags(E)}};me(a,Be(C,150));const _=Be(async()=>{await u(),C()},150);return{gridItems:o,sortedFiles:t,sortMethodConv:Dn,moreActionsDropdownShow:m,gridSize:p,sortMethod:i,onScroll:_,loadNextDir:b,loadNextDirLoading:w,canLoadNext:v,itemSize:f,cellWidth:k}}function pr(){const{currLocation:e,sortedFiles:n,currPage:t,multiSelectedIdxs:i,eventEmitter:a,walker:r}=le().toRefs(),v=()=>{i.value=[]};return Se("click",v),Se("blur",v),me(t,v),{onFileDragStart:(d,m)=>{const k=Rt(n.value[m]);Pt.fileDragging=!0,console.log("onFileDragStart set drag file ",d,m,k);const p=[k];let l=k.type==="dir";if(i.value.includes(m)){const o=i.value.map(f=>n.value[f]);p.push(...o),l=o.some(f=>f.type==="dir")}const s={includeDir:l,loc:e.value||"search-result",path:mt(p,"fullpath").map(o=>o.fullpath),nodes:mt(p,"fullpath"),__id:"FileTransferData"};d.dataTransfer.setData("text/plain",JSON.stringify(s))},onDrop:async d=>{if(r.value)return;const m=Rn(d);if(!m)return;const k=e.value;if(m.loc===k)return;const p=Ht(),l=async()=>p.pushAction(async()=>{await gi(m.path,k),a.value.emit("refresh"),be.destroyAll()}),s=()=>p.pushAction(async()=>{await Kt(m.path,k),Pe.emit("removeFiles",{paths:m.path,loc:m.loc}),a.value.emit("refresh"),be.destroyAll()});be.confirm({title:j("confirm")+"?",width:"60vw",content:()=>{let o,f,w;return A("div",null,[A("div",null,[`${j("moveSelectedFilesTo")} ${k}`,A("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[m.path.map(b=>A("li",null,[b.split(/[/\\]/).pop()]))])]),A(Jt,null,null),A("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},class:"actions"},[A(ve,{onClick:be.destroyAll},Re(o=j("cancel"))?o:{default:()=>[o]}),A(ve,{type:"primary",loading:!p.isIdle,onClick:l},Re(f=j("copy"))?f:{default:()=>[f]}),A(ve,{type:"primary",loading:!p.isIdle,onClick:s},Re(w=j("move"))?w:{default:()=>[w]})])])},maskClosable:!0,wrapClassName:"hidden-antd-btns-modal"})},multiSelectedIdxs:i,onFileDragEnd:()=>{Pt.fileDragging=!1}}}function hr({openNext:e}){const n=V(!1),t=V(""),{sortedFiles:i,previewIdx:a,multiSelectedIdxs:r,stack:v,currLocation:c,spinning:h,previewing:y,stackViewEl:d,eventEmitter:m,props:k,deletedFiles:p}=le().toRefs(),l=_e;Je("removeFiles",({paths:b,loc:u})=>{l(u)!==l(c.value)||!pe(v.value)||(b.forEach(_=>p.value.add(_)),b.filter(X).forEach(_=>p.value.add(_.replace(/\.\w+$/,".txt"))))}),Je("addFiles",({files:b,loc:u})=>{if(l(u)!==l(c.value))return;const C=pe(v.value);C&&C.files.unshift(...b)});const s=Ht(),o=async(b,u,C)=>{a.value=C,N.fullscreenPreviewInitialUrl=ce(u);const _=r.value.indexOf(C);if(b.shiftKey){if(_!==-1)r.value.splice(_,1);else{r.value.push(C),r.value.sort((P,S)=>P-S);const I=r.value[0],E=r.value[r.value.length-1];r.value=Zt(I,E+1)}b.stopPropagation()}else b.ctrlKey||b.metaKey?(_!==-1?r.value.splice(_,1):r.value.push(C),b.stopPropagation()):await e(u)},f=async(b,u,C)=>{var z,Q,G;const _=ce(u),I=c.value,E={IIB_container_id:parent.IIB_container_id},P=()=>{let M=[];return r.value.includes(C)?M=r.value.map(x=>i.value[x]):M.push(u),M},S=async M=>{if(!h.value)try{h.value=!0,await Jn(u.fullpath),Ee.postMessage({...E,event:"click_hidden_button",btnEleId:"iib_hidden_img_update_trigger"}),await Kn(),Ee.postMessage({...E,event:"click_hidden_button",btnEleId:`iib_hidden_tab_${M}`})}catch(x){console.error(x),te.error("发送图像失败，请携带console的错误消息找开发者")}finally{h.value=!1}},$=`${b.key}`;if($.startsWith("toggle-tag-")){const M=+$.split("toggle-tag-")[1],{is_remove:x}=await Si({tag_id:M,img_path:u.fullpath}),W=(Q=(z=N.conf)==null?void 0:z.all_custom_tags.find(g=>g.id===M))==null?void 0:Q.name;await We.refreshTags([u.fullpath]),te.success(j(x?"removedTagFromImage":"addedTagToImage",{tag:W}));return}else if($.startsWith("batch-add-tag-")||$.startsWith("batch-remove-tag-")){const M=+$.split("-tag-")[1],x=$.includes("add")?"add":"remove",W=P().map(g=>g.fullpath);await Ci({tag_id:M,img_paths:W,action:x}),await We.refreshTags(W),te.success(j(x==="add"?"addCompleted":"removeCompleted"));return}switch(b.key){case"previewInNewWindow":return window.open(_);case"download":{const M=P();Un(M.map(x=>ce(x,!0)));break}case"copyPreviewUrl":return Ve(parent.document.location.origin+_);case"send2txt2img":return S("txt2img");case"send2img2img":return S("img2img");case"send2inpaint":return S("inpaint");case"send2extras":return S("extras");case"send2savedDir":{const M=N.quickMovePaths.find(g=>g.key==="outdir_save");if(!M)return te.error(j("unknownSavedDir"));const x=Vn(M.dir,(G=N.conf)==null?void 0:G.sd_cwd),W=P();await Kt(W.map(g=>g.fullpath),x,!0),Pe.emit("removeFiles",{paths:W.map(g=>g.fullpath),loc:c.value}),Pe.emit("addFiles",{files:W,loc:x});break}case"send2controlnet-img2img":case"send2controlnet-txt2img":{const M=b.key.split("-")[1];Ee.postMessage({...E,event:"send_to_control_net",type:M,url:ce(u)});break}case"send2outpaint":{t.value=await s.pushAction(()=>gt(u.fullpath)).res;const[M,x]=(t.value||"").split(`
`);Ee.postMessage({...E,event:"send_to_outpaint",url:ce(u),prompt:M,negPrompt:x.slice(17)});break}case"openWithWalkMode":{Oe.set(I,v.value);const M=N.tabList[k.value.tabIdx],x={type:"local",key:de(),path:u.fullpath,name:j("local"),stackKey:I,walkModePath:u.fullpath};M.panes.push(x),M.key=x.key;break}case"openInNewTab":{Oe.set(I,v.value);const M=N.tabList[k.value.tabIdx],x={type:"local",key:de(),path:u.fullpath,name:j("local"),stackKey:I};M.panes.push(x),M.key=x.key;break}case"openOnTheRight":{Oe.set(I,v.value);let M=N.tabList[k.value.tabIdx+1];M||(M={panes:[],key:"",id:de()},N.tabList[k.value.tabIdx+1]=M);const x={type:"local",key:de(),path:u.fullpath,name:j("local"),stackKey:I};M.panes.push(x),M.key=x.key;break}case"send2BatchDownload":{Sa.addFiles(P());break}case"viewGenInfo":{n.value=!0,t.value=await s.pushAction(()=>gt(u.fullpath)).res;break}case"openWithLocalFileBrowser":{await Hn(u.fullpath);break}case"deleteFiles":{const M=P(),x=async()=>{const W=M.map(g=>g.fullpath);await yi(W),te.success(j("deleteSuccess")),Pe.emit("removeFiles",{paths:W,loc:c.value})};if(M.length===1&&N.ignoredConfirmActions.deleteOneOnly)return x();await new Promise(W=>{be.confirm({title:j("confirmDelete"),maskClosable:!0,width:"60vw",content:()=>A("div",null,[A("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[M.map(g=>A("li",null,[g.fullpath.split(/[/\\]/).pop()]))]),A(Jt,null,null),A(hi,{checked:N.ignoredConfirmActions.deleteOneOnly,"onUpdate:checked":g=>N.ignoredConfirmActions.deleteOneOnly=g},{default:()=>[j("deleteOneOnlySkipConfirm"),D(" ("),j("resetOnGlobalSettingsPage"),D(")")]})]),async onOk(){await x(),W()}})});break}}return{}},{isOutside:w}=Ln(d);return Se("keydown",b=>{var C,_,I;const u=mi(b);if(y.value){const E=(C=Object.entries(N.shortcut).find(P=>P[1]===u&&P[1]))==null?void 0:C[0];if(E){b.stopPropagation(),b.preventDefault();const P=a.value,S=i.value[P];switch(E){case"delete":return ce(S)===N.fullscreenPreviewInitialUrl?te.warn(j("fullscreenRestriction")):f({key:"deleteFiles"},S,P);case"download":return f({key:"download"},S,P);default:{const $=(_=/^toggle_tag_(.*)$/.exec(E))==null?void 0:_[1],z=(I=N.conf)==null?void 0:I.all_custom_tags.find(Q=>Q.name===$);return z?f({key:`toggle-tag-${z.id}`},S,P):void 0}}}}else!w.value&&["Ctrl + KeyA","Cmd + KeyA"].includes(u)&&(b.preventDefault(),b.stopPropagation(),m.value.emit("selectAll"))}),{onFileItemClick:o,onContextMenuClick:f,showGenInfo:n,imageGenInfo:t,q:s}}const mr=()=>{const{stackViewEl:e}=le().toRefs(),n=V(-1);return jn(e,t=>{var a;let i=t.target;for(;i.parentElement;)if(i=i.parentElement,i.tagName.toLowerCase()==="li"&&i.classList.contains("file-item-trigger")){const r=(a=i.dataset)==null?void 0:a.idx;r&&Number.isSafeInteger(+r)&&(n.value=+r);return}}),{showMenuIdx:n}};function Ca(){var e=window.navigator.userAgent,n=e.indexOf("MSIE ");if(n>0)return parseInt(e.substring(n+5,e.indexOf(".",n)),10);var t=e.indexOf("Trident/");if(t>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var a=e.indexOf("Edge/");return a>0?parseInt(e.substring(a+5,e.indexOf(".",a)),10):-1}let xe;function Ke(){Ke.init||(Ke.init=!0,xe=Ca()!==-1)}var ze={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Ke(),Vt(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",xe&&this.$el.appendChild(e),e.data="about:blank",xe||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!xe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Ia=Yn();qn("data-v-b329ee4c");const Ea={class:"resize-observer",tabindex:"-1"};Gn();const _a=Ia((e,n,t,i,a,r)=>(O(),H("div",Ea)));ze.render=_a;ze.__scopeId="data-v-b329ee4c";ze.__file="src/components/ResizeObserver.vue";function Te(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Te=function(n){return typeof n}:Te=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Te(e)}function Oa(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function xt(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pa(e,n,t){return n&&xt(e.prototype,n),t&&xt(e,t),e}function Tt(e){return xa(e)||Ta(e)||Ma(e)||$a()}function xa(e){if(Array.isArray(e))return qe(e)}function Ta(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Ma(e,n){if(e){if(typeof e=="string")return qe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return qe(e,n)}}function qe(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function $a(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ba(e){var n;return typeof e=="function"?n={callback:e}:n=e,n}function Fa(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,r,v=function(h){for(var y=arguments.length,d=new Array(y>1?y-1:0),m=1;m<y;m++)d[m-1]=arguments[m];if(r=d,!(i&&h===a)){var k=t.leading;typeof k=="function"&&(k=k(h,a)),(!i||h!==a)&&k&&e.apply(void 0,[h].concat(Tt(r))),a=h,clearTimeout(i),i=setTimeout(function(){e.apply(void 0,[h].concat(Tt(r))),i=0},n)}};return v._clear=function(){clearTimeout(i),i=null},v}function nn(e,n){if(e===n)return!0;if(Te(e)==="object"){for(var t in e)if(!nn(e[t],n[t]))return!1;return!0}return!1}var Na=function(){function e(n,t,i){Oa(this,e),this.el=n,this.observer=null,this.frozen=!1,this.createObserver(t,i)}return Pa(e,[{key:"createObserver",value:function(t,i){var a=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Ba(t),this.callback=function(c,h){a.options.callback(c,h),c&&a.options.once&&(a.frozen=!0,a.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},v=r.leading;this.callback=Fa(this.callback,this.options.throttle,{leading:function(h){return v==="both"||v==="visible"&&h||v==="hidden"&&!h}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(c){var h=c[0];if(c.length>1){var y=c.find(function(m){return m.isIntersecting});y&&(h=y)}if(a.callback){var d=h.isIntersecting&&h.intersectionRatio>=a.threshold;if(d===a.oldResult)return;a.oldResult=d,a.callback(d,h)}},this.options.intersection),Vt(function(){a.observer&&a.observer.observe(a.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function an(e,n,t){var i=n.value;if(i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var a=new Na(e,i,t);e._vue_visibilityState=a}}function za(e,n,t){var i=n.value,a=n.oldValue;if(!nn(i,a)){var r=e._vue_visibilityState;if(!i){rn(e);return}r?r.createObserver(i,t):an(e,{value:i},t)}}function rn(e){var n=e._vue_visibilityState;n&&(n.destroyObserver(),delete e._vue_visibilityState)}var Qa={beforeMount:an,updated:za,unmounted:rn},Da={itemsLimit:1e3},La=/(auto|scroll)/;function ln(e,n){return e.parentNode===null?n:ln(e.parentNode,n.concat([e]))}var He=function(n,t){return getComputedStyle(n,null).getPropertyValue(t)},ja=function(n){return He(n,"overflow")+He(n,"overflow-y")+He(n,"overflow-x")},Ra=function(n){return La.test(ja(n))};function Mt(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var n=ln(e.parentNode,[]),t=0;t<n.length;t+=1)if(Ra(n[t]))return n[t];return document.scrollingElement||document.documentElement}}function Ge(e){"@babel/helpers - typeof";return Ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ge(e)}var Ha={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(n){return["vertical","horizontal"].includes(n)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Va(){return this.items.length&&Ge(this.items[0])!=="object"}var Ye=!1;if(typeof window<"u"){Ye=!1;try{var Ua=Object.defineProperty({},"passive",{get:function(){Ye=!0}});window.addEventListener("test",null,Ua)}catch{}}let Wa=0;var sn={name:"RecycleScroller",components:{ResizeObserver:ze},directives:{ObserveVisibility:Qa},props:{...Ha,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},n=this.items,t=this.sizeField,i=this.minItemSize;let a=1e4,r=0,v;for(let c=0,h=n.length;c<h;c++)v=n[c][t]||i,v<a&&(a=v),r+=v,e[c]={accumulator:r,size:v};return this.$_computedMinItemSize=a,e}return[]},simpleArray:Va,itemIndexByKey(){const{keyField:e,items:n}=this,t={};for(let i=0,a=n.length;i<a;i++)t[n[i][e]]=i;return t}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,n,t,i,a){const r=Zn({id:Wa++,index:n,used:!0,key:i,type:a}),v=Xn({item:t,position:0,nr:r});return e.push(v),v},unuseView(e,n=!1){const t=this.$_unusedViews,i=e.nr.type;let a=t.get(i);a||(a=[],t.set(i,a)),a.push(e),n||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const n=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});n(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&n()},this.updateInterval))}},handleVisibilityChange(e,n){this.ready&&(e||n.boundingClientRect.width!==0||n.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,n=!1){const t=this.itemSize,i=this.gridItems||1,a=this.itemSecondarySize||t,r=this.$_computedMinItemSize,v=this.typeField,c=this.simpleArray?null:this.keyField,h=this.items,y=h.length,d=this.sizes,m=this.$_views,k=this.$_unusedViews,p=this.pool,l=this.itemIndexByKey;let s,o,f,w,b;if(!y)s=o=w=b=f=0;else if(this.$_prerender)s=w=0,o=b=Math.min(this.prerender,h.length),f=null;else{const S=this.getScroll();if(n){let Q=S.start-this.$_lastUpdateScrollPosition;if(Q<0&&(Q=-Q),t===null&&Q<r||Q<t)return{continuous:!0}}this.$_lastUpdateScrollPosition=S.start;const $=this.buffer;S.start-=$,S.end+=$;let z=0;if(this.$refs.before&&(z=this.$refs.before.scrollHeight,S.start-=z),this.$refs.after){const Q=this.$refs.after.scrollHeight;S.end+=Q}if(t===null){let Q,G=0,M=y-1,x=~~(y/2),W;do W=x,Q=d[x].accumulator,Q<S.start?G=x:x<y-1&&d[x+1].accumulator>S.start&&(M=x),x=~~((G+M)/2);while(x!==W);for(x<0&&(x=0),s=x,f=d[y-1].accumulator,o=x;o<y&&d[o].accumulator<S.end;o++);for(o===-1?o=h.length-1:(o++,o>y&&(o=y)),w=s;w<y&&z+d[w].accumulator<S.start;w++);for(b=w;b<y&&z+d[b].accumulator<S.end;b++);}else{s=~~(S.start/t*i);const Q=s%i;s-=Q,o=Math.ceil(S.end/t*i),w=Math.max(0,Math.floor((S.start-z)/t*i)),b=Math.floor((S.end-z)/t*i),s<0&&(s=0),o>y&&(o=y),w<0&&(w=0),b>y&&(b=y),f=Math.ceil(y/i)*t}}o-s>Da.itemsLimit&&this.itemsLimitError(),this.totalSize=f;let u;const C=s<=this.$_endIndex&&o>=this.$_startIndex;if(C)for(let S=0,$=p.length;S<$;S++)u=p[S],u.nr.used&&(e&&(u.nr.index=l[u.item[c]]),(u.nr.index==null||u.nr.index<s||u.nr.index>=o)&&this.unuseView(u));const _=C?null:new Map;let I,E,P;for(let S=s;S<o;S++){I=h[S];const $=c?I[c]:I;if($==null)throw new Error(`Key is ${$} on item (keyField is '${c}')`);if(u=m.get($),!t&&!d[S].size){u&&this.unuseView(u);continue}E=I[v];let z=k.get(E),Q=!1;if(!u)C?z&&z.length?u=z.pop():u=this.addView(p,S,I,$,E):(P=_.get(E)||0,(!z||P>=z.length)&&(u=this.addView(p,S,I,$,E),this.unuseView(u,!0),z=k.get(E)),u=z[P],_.set(E,P+1)),m.delete(u.nr.key),u.nr.used=!0,u.nr.index=S,u.nr.key=$,u.nr.type=E,m.set($,u),Q=!0;else if(!u.nr.used&&(u.nr.used=!0,u.nr.index=S,Q=!0,z)){const G=z.indexOf(u);G!==-1&&z.splice(G,1)}u.item=I,Q&&(S===h.length-1&&this.$emit("scroll-end"),S===0&&this.$emit("scroll-start")),t===null?(u.position=d[S-1].accumulator,u.offset=0):(u.position=Math.floor(S/i)*t,u.offset=S%i*a)}return this.$_startIndex=s,this.$_endIndex=o,this.emitUpdate&&this.$emit("update",s,o,w,b),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:C}},getListenerTarget(){let e=Mt(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:n}=this,t=n==="vertical";let i;if(this.pageMode){const a=e.getBoundingClientRect(),r=t?a.height:a.width;let v=-(t?a.top:a.left),c=t?window.innerHeight:window.innerWidth;v<0&&(c+=v,v=0),v+c>r&&(c=r-v),i={start:v,end:v+c}}else t?i={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:i={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return i},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Ye?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let n;const t=this.gridItems||1;this.itemSize===null?n=e>0?this.sizes[e-1].accumulator:0:n=Math.floor(e/t)*this.itemSize,this.scrollToPosition(n)},scrollToPosition(e){const n=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let t,i,a;if(this.pageMode){const r=Mt(this.$el),v=r.tagName==="HTML"?0:r[n.scroll],c=r.getBoundingClientRect(),y=this.$el.getBoundingClientRect()[n.start]-c[n.start];t=r,i=n.scroll,a=e+v+y}else t=this.$el,i=n.scroll,a=e;t[i]=a},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,n)=>e.nr.index-n.nr.index)}}};const Ja={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Ka={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function qa(e,n,t,i,a,r){const v=ei("ResizeObserver"),c=ti("observe-visibility");return ni((O(),R("div",{class:fe(["vue-recycle-scroller",{ready:a.ready,"page-mode":t.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:n[0]||(n[0]=(...h)=>r.handleScroll&&r.handleScroll(...h))},[e.$slots.before?(O(),R("div",Ja,[Ce(e.$slots,"before")],512)):Z("v-if",!0),(O(),H(yt(t.listTag),{ref:"wrapper",style:ri({[e.direction==="vertical"?"minHeight":"minWidth"]:a.totalSize+"px"}),class:fe(["vue-recycle-scroller__item-wrapper",t.listClass])},{default:B(()=>[(O(!0),R(ee,null,ue(a.pool,h=>(O(),H(yt(t.itemTag),ii({key:h.nr.id,style:a.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${h.position}px) translate${e.direction==="vertical"?"X":"Y"}(${h.offset}px)`,width:t.gridItems?`${e.direction==="vertical"&&t.itemSecondarySize||t.itemSize}px`:void 0,height:t.gridItems?`${e.direction==="horizontal"&&t.itemSecondarySize||t.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[t.itemClass,{hover:!t.skipHover&&a.hoverKey===h.nr.key}]]},ai(t.skipHover?{}:{mouseenter:()=>{a.hoverKey=h.nr.key},mouseleave:()=>{a.hoverKey=null}})),{default:B(()=>[Ce(e.$slots,"default",{item:h.item,index:h.nr.index,active:h.nr.used})]),_:2},1040,["style","class"]))),128)),Ce(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(O(),R("div",Ka,[Ce(e.$slots,"after")],512)):Z("v-if",!0),A(v,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[c,r.handleVisibilityChange]])}sn.render=qa;sn.__file="src/components/RecycleScroller.vue";const $t=ge({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},disableDelete:{type:Boolean},isSelectedMutilFiles:{type:Boolean}},emits:["contextMenuClick"],setup(e,{emit:n}){const t=e,i=Xe(),a=U(()=>{var r;return(((r=i.conf)==null?void 0:r.all_custom_tags)??[]).reduce((v,c)=>[...v,{...c,selected:!!t.selectedTag.find(h=>h.id===c.id)}],[])});return(r,v)=>{const c=Ut,h=li,y=si,d=Wt;return O(),H(d,{onClick:v[0]||(v[0]=m=>n("contextMenuClick",m,r.file,r.idx))},{default:B(()=>{var m;return[A(c,{key:"deleteFiles",disabled:r.disableDelete},{default:B(()=>[D(L(r.$t("deleteSelected")),1)]),_:1},8,["disabled"]),r.file.type==="dir"?(O(),R(ee,{key:0},[A(c,{key:"openInNewTab"},{default:B(()=>[D(L(r.$t("openInNewTab")),1)]),_:1}),A(c,{key:"openOnTheRight"},{default:B(()=>[D(L(r.$t("openOnTheRight")),1)]),_:1}),A(c,{key:"openWithWalkMode"},{default:B(()=>[D(L(r.$t("openWithWalkMode")),1)]),_:1})],64)):Z("",!0),r.file.type==="file"?(O(),R(ee,{key:1},[J(X)(r.file.name)?(O(),R(ee,{key:0},[A(c,{key:"viewGenInfo"},{default:B(()=>[D(L(r.$t("viewGenerationInfo")),1)]),_:1}),A(h),((m=J(i).conf)==null?void 0:m.launch_mode)!=="server"?(O(),R(ee,{key:0},[A(c,{key:"send2txt2img"},{default:B(()=>[D(L(r.$t("sendToTxt2img")),1)]),_:1}),A(c,{key:"send2img2img"},{default:B(()=>[D(L(r.$t("sendToImg2img")),1)]),_:1}),A(c,{key:"send2inpaint"},{default:B(()=>[D(L(r.$t("sendToInpaint")),1)]),_:1}),A(c,{key:"send2extras"},{default:B(()=>[D(L(r.$t("sendToExtraFeatures")),1)]),_:1}),A(y,{key:"sendToThirdPartyExtension",title:r.$t("sendToThirdPartyExtension")},{default:B(()=>[A(c,{key:"send2controlnet-txt2img"},{default:B(()=>[D("ControlNet - "+L(r.$t("t2i")),1)]),_:1}),A(c,{key:"send2controlnet-img2img"},{default:B(()=>[D("ControlNet - "+L(r.$t("i2i")),1)]),_:1}),A(c,{key:"send2outpaint"},{default:B(()=>[D("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):Z("",!0),A(c,{key:"send2BatchDownload"},{default:B(()=>[D(L(r.$t("sendToBatchDownload")),1)]),_:1}),A(c,{key:"send2savedDir"},{default:B(()=>[D(L(r.$t("send2savedDir")),1)]),_:1}),A(h),r.isSelectedMutilFiles?(O(),R(ee,{key:1},[A(y,{key:"batch-add-tag",title:r.$t("batchAddTag")},{default:B(()=>[(O(!0),R(ee,null,ue(a.value,k=>(O(),H(c,{key:`batch-add-tag-${k.id}`},{default:B(()=>[D(L(k.name),1)]),_:2},1024))),128))]),_:1},8,["title"]),A(y,{key:"batch-remove-tag",title:r.$t("batchRemoveTag")},{default:B(()=>[(O(!0),R(ee,null,ue(a.value,k=>(O(),H(c,{key:`batch-remove-tag-${k.id}`},{default:B(()=>[D(L(k.name),1)]),_:2},1024))),128))]),_:1},8,["title"])],64)):(O(),H(y,{key:"toggle-tag",title:r.$t("toggleTag")},{default:B(()=>[(O(!0),R(ee,null,ue(a.value,k=>(O(),H(c,{key:`toggle-tag-${k.id}`},{default:B(()=>[D(L(k.name)+" ",1),k.selected?(O(),H(J(Yt),{key:0})):(O(),H(J(Xt),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"])),A(c,{key:"openWithLocalFileBrowser"},{default:B(()=>[D(L(r.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):Z("",!0),A(c,{key:"previewInNewWindow"},{default:B(()=>[D(L(r.$t("previewInNewWindow")),1)]),_:1}),A(c,{key:"download"},{default:B(()=>[D(L(r.$t("download")),1)]),_:1}),A(c,{key:"copyPreviewUrl"},{default:B(()=>[D(L(r.$t("copySourceFilePreviewLink")),1)]),_:1})],64)):Z("",!0)]}),_:1})}}}),Ga=["data-idx"],Ya={key:1,class:"more"},Za={class:"float-btn-wrap"},Xa={key:0,class:"tags-container"},er={class:"play-icon"},tr={key:0,class:"tags-container"},nr={key:4,class:"preview-icon-wrap"},ir={key:5,class:"profile"},ar={class:"name line-clamp-1"},rr={class:"basic-info"},lr=ge({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1},isSelectedMutilFiles:{type:Boolean}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click"],setup(e,{emit:n}){const t=e;oi(d=>({"6b5a16d0":d.$props.cellWidth+"px"}));const i=Xe(),a=tn(),r=U(()=>a.tagMap.get(t.file.fullpath)??[]),v=U(()=>{const d=i.gridThumbnailResolution;return i.enableThumbnail?ci(t.file,[d,d].join("x")):ce(t.file)}),c=U(()=>{var d;return(((d=i.conf)==null?void 0:d.all_custom_tags)??[]).reduce((m,k)=>[...m,{...k,selected:!!r.value.find(p=>p.id===k.id)}],[])}),h=U(()=>c.value.find(d=>d.type==="custom"&&d.name==="like")),y=()=>{$e(h.value),n("contextMenuClick",{key:`toggle-tag-${h.value.id}`},t.file,t.idx)};return(d,m)=>{const k=he,p=Ut,l=Wt,s=fi,o=$i;return O(),H(k,{trigger:["contextmenu"],visible:J(i).longPressOpenContextMenu?typeof d.idx=="number"&&d.showMenuIdx===d.idx:void 0,"onUpdate:visible":m[8]||(m[8]=f=>typeof d.idx=="number"&&n("update:showMenuIdx",f?d.idx:-1))},{overlay:B(()=>[d.enableRightClickMenu?(O(),H($t,{key:0,file:d.file,idx:d.idx,"selected-tag":r.value,onContextMenuClick:m[7]||(m[7]=(f,w,b)=>n("contextMenuClick",f,w,b)),"is-selected-mutil-files":d.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])):Z("",!0)]),default:B(()=>[(O(),R("li",{class:fe(["file file-item-trigger grid",{clickable:d.file.type==="dir",selected:d.selected}]),"data-idx":d.idx,key:d.file.name,draggable:"true",onDragstart:m[4]||(m[4]=f=>n("dragstart",f,d.idx)),onDragend:m[5]||(m[5]=f=>n("dragend",f,d.idx)),onClickCapture:m[6]||(m[6]=f=>n("fileItemClick",f,d.file,d.idx))},[ae("div",null,[d.enableCloseIcon?(O(),R("div",{key:0,class:"close-icon",onClick:m[0]||(m[0]=f=>n("close-icon-click"))},[A(J(ui))])):Z("",!0),d.enableRightClickMenu?(O(),R("div",Ya,[A(k,null,{overlay:B(()=>[A($t,{file:d.file,idx:d.idx,"selected-tag":r.value,onContextMenuClick:m[1]||(m[1]=(f,w,b)=>n("contextMenuClick",f,w,b)),"is-selected-mutil-files":d.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])]),default:B(()=>[ae("div",Za,[A(J(Ft))])]),_:1}),d.file.type==="file"?(O(),H(k,{key:0},{overlay:B(()=>[c.value.length>1?(O(),H(l,{key:0,onClick:m[2]||(m[2]=f=>n("contextMenuClick",f,d.file,d.idx))},{default:B(()=>[(O(!0),R(ee,null,ue(c.value,f=>(O(),H(p,{key:`toggle-tag-${f.id}`},{default:B(()=>[D(L(f.name)+" ",1),f.selected?(O(),H(J(Yt),{key:0})):(O(),H(J(Xt),{key:1}))]),_:2},1024))),128))]),_:1})):Z("",!0)]),default:B(()=>{var f,w;return[ae("div",{class:fe(["float-btn-wrap",{"like-selected":(f=h.value)==null?void 0:f.selected}]),onClick:y},[(w=h.value)!=null&&w.selected?(O(),H(J(sa),{key:0})):(O(),H(J(da),{key:1}))],2)]}),_:1})):Z("",!0)])):Z("",!0),J(X)(d.file.name)?(O(),R("div",{key:d.file.fullpath,class:fe(`idx-${d.idx} item-content`)},[A(s,{src:v.value,fallback:J(Zi),preview:{src:d.fullScreenPreviewImageUrl,onVisibleChange:(f,w)=>n("previewVisibleChange",f,w)}},null,8,["src","fallback","preview"]),r.value&&d.cellWidth>128?(O(),R("div",Xa,[(O(!0),R(ee,null,ue(r.value,f=>(O(),H(o,{key:f.id,color:J(a).getColor(f.name)},{default:B(()=>[D(L(f.name),1)]),_:2},1032,["color"]))),128))])):Z("",!0)],2)):J(di)(d.file.name)?(O(),R("div",{key:3,class:fe(`idx-${d.idx} item-content video`),onClick:m[3]||(m[3]=f=>J(bi)(d.file))},[ae("div",er,[A(J(ha))]),r.value&&d.cellWidth>128?(O(),R("div",tr,[(O(!0),R(ee,null,ue(r.value,f=>(O(),H(o,{key:f.id,color:J(a).getColor(f.name)},{default:B(()=>[D(L(f.name),1)]),_:2},1032,["color"]))),128))])):Z("",!0)],2)):(O(),R("div",nr,[d.file.type==="file"?(O(),H(J(Li),{key:0,class:"icon center"})):(O(),H(J(Vi),{key:1,class:"icon center"}))])),d.cellWidth>128?(O(),R("div",ir,[ae("div",ar,L(d.file.name),1),ae("div",rr,[ae("div",null,L(d.file.size),1),ae("div",null,L(d.file.date),1)])])):Z("",!0)])],42,Ga))]),_:1},8,["visible"])}}});const gr=vi(lr,[["__scopeId","data-v-8b135d68"]]);export{he as D,gr as F,$t as _,fr as a,vr as b,pr as c,hr as d,dr as e,mr as f,sn as g,Je as h,tn as i,Se as j,ka as k,Oe as s,le as u};
